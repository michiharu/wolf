{"version":3,"sources":["components/konva/icon-with-badge.tsx","resource/svg-icon/check.ts","settings/layout.ts","resource/svg-icon/more/more-vert.ts","redux/actions/rsAction.ts","func/k-arrow.ts","func/tree.ts","components/view-settings/view-settings-component.tsx","components/view-settings/view-settings-container.tsx","components/konva/k-start.tsx","func/tree-node.ts","settings/phrase.ts","pages/manual/node/node-frame-component.tsx","pages/manual/node/node-container.tsx","pages/manual/node/node-component.tsx","components/konva/k-node.tsx","components/konva/k-shadow.tsx","pages/manual/node/info-content-component.tsx","pages/manual/text/text/text-component.tsx","pages/manual/text/text/text-line-with-icon.tsx","func/util.ts","redux/actions/ksAction.ts","api/definitions.ts","redux/actions/main/loginUserAction.ts","redux/states/main/loginUserState.ts","redux/actions/main/manualsAction.ts","redux/states/main/manualsState.ts","redux/actions/main/memoAction.ts","redux/states/main/memoState.ts","settings/storage-keys.ts","redux/states/ksState.ts","settings/reading.ts","redux/states/rsState.ts","api/mock-data/common-data/users.ts","api/mock-data/common-data/manuals.ts","api/mock-data/common-data/categories.ts","api/mock-data/common-data/userGroups.ts","api/mock-data/login.ts","api/mock-data/manual.ts","api/mock-data/favorite.ts","api/mock-data/like.ts","api/mock-data/tree.ts","api/mock-data/login-user.ts","api/mock-data/password.ts","api/mock-data/title-checker.ts","api/mock-data/generate-title.ts","api/mock-data/manuals.ts","api/mock-data/session-check.ts","api/axios.ts","api/axios-func.ts","redux/actions/loginAction.ts","redux/actions/main/usersAction.ts","redux/actions/main/categoriesAction.ts","redux/actions/notificationsAction.ts","redux/actions/loadingAction.ts","redux/actions/main/userGroupsAction.ts","redux/selectors/index.ts","redux/actions/titileCheckAction.ts","redux/saga.ts","redux/states/main/categoriesState.ts","redux/states/main/usersState.ts","redux/states/notificationsState.ts","redux/states/loadingState.ts","redux/states/main/userGroupsState.ts","redux/states/titleCheckState.ts","redux/store.ts","settings/links.ts","pages/login/login-component.tsx","pages/login/login-container.tsx","components/title-checker/title-checker.tsx","components/auto-single-select/auto-single-select.tsx","pages/layout/create-manual/create-manual-component.tsx","pages/layout/create-manual/create-manual-container.tsx","pages/dashboard/text-labels.tsx","pages/dashboard/dashboard-component.tsx","pages/manual/settings/base-settings/base-settings-component.tsx","pages/manual/settings/base-settings/base-settings-container.tsx","pages/manual/settings/collaborators/collaborators-component.tsx","pages/manual/settings/collaborators/collaborators-container.tsx","pages/manual/settings/publishing-settings/publishing-settings-component.tsx","pages/manual/settings/publishing-settings/publishing-settings-container.tsx","pages/manual/settings/copy/copy-component.tsx","pages/manual/settings/copy/copy-container.ts","pages/manual/settings/delete/delete-component.tsx","pages/manual/settings/delete/delete-container.ts","pages/manual/settings/change-owner/change-owner-component.tsx","pages/manual/settings/change-owner/change-owner-container.tsx","pages/manual/settings/settings.tsx","pages/manual/node/node-frame-container.tsx","pages/manual/text/text/text-container.tsx","components/custom-mui/adapter-link.tsx","resource/svg-icon/expand/more.ts","resource/svg-icon/expand/less.ts","components/konva/k-view-node.tsx","pages/manual/node/node-print/node-print-component.tsx","pages/manual/node/node-print/node-print-container.tsx","pages/manual/text/text-print/text-print-component.tsx","pages/manual/text/text-print/text-print-dialog-component.tsx","pages/manual/text/text-print/text-print-dialog-container.tsx","pages/manual/layout/layout-component.tsx","components/now-loading.tsx","pages/manual/layout/layout-container.tsx","pages/page-router.tsx","pages/layout/drawer-content/drawer-content-component.tsx","pages/layout/drawer-content/drawer-content-container.tsx","pages/layout/profile/profile-component.tsx","pages/layout/profile/profile-container.tsx","pages/layout/layout-component.tsx","pages/layout/layout-container.tsx","pages/login-router.tsx","components/notistack/index.tsx","notifier.tsx","index.tsx","components/konva/svg-to-path.tsx","components/konva/icon.tsx","resource/svg-icon/check-box/check-blank.ts","resource/svg-icon/flag/flag.ts","resource/svg-icon/switch-svg.ts","resource/svg-icon/task.ts","func/k-tree.ts","data-types/tree.ts"],"names":["IconWithBadge","props","ks","x","y","badgeContent","onClick","onTap","onMouseEnter","onMouseLeave","iconProps","badgeLength","String","length","bl","badgeFontHeight","rectProps","rect","h","unit","width","badgeFontSize","height","fill","theme","palette","primary","main","cornerRadius","textProps","text","fontSize","check","d","defaultKS","w","margin","spr","indent","fontHeight","textline","icon","hasArrow","pointerSpace","pointerLength","pointerWidth","moreVert","actionCreator","actionCreatorFactory","rsActions","change","reset","KArrowUtil","setArrow","node","kArrow","_resetArrow","_setInArrowOfNotSwitch","_setInArrowOfSwitch","_setNextArrow","_setReturnArrow","children","map","c","arrows","isSwitch","type","open","anchor","i","points","self","isCase","openMargin","before","exit","_children","getArrowPoints","_hasUnderNode","target","point","reduce","a","b","id","dv","isTask","exitCenter","beforeSelfX","secondPointX","TreeUtil","_get","base","getAsArray","n","getGenealogy","nodeList","genealogy","getGeneOrFalse","Error","findResult","find","childResult","concat","_replaceArray","_replace","_findArray","targetId","undefined","_find","_toArray","search","nodes","searchWords","splitSearchWords","filter","label","match","RegExp","output","split","s","replace","_setId","Math","random","slice","_clearId","getNewNode","parentType","Type","case","task","words","_searchAndFilter","_hasDifference","input","preConditions","postConditions","workerInCharge","remarks","necessaryTools","exceptions","imageBlob","_","t","e","te","_hasDifferenceWithAppearance","_isAllSwitchHasCase","_isAllCaseHasItem","_deleteById","moveBrother","from","to","childrenIds","_getPrent","isNext","indexOf","deletedTree","_insert","index","splice","moveInOut","child","parentNode","moveIn","_push","_unshift","useStyles","makeStyles","root","position","top","left","maxHeight","transform","padding","spacing","paddingBottom","outline","overflow","speechLabel","marginTop","cardSettingLabel","paddingTop","longSetter","shortSetter","slider","ViewSettingsComponent","rs","changeKS","changeRS","resetKS","resetRS","classes","Paper","className","Grid","container","item","xs","md","FormControl","FormLabel","RadioGroup","value","onChange","newKS","FormControlLabel","control","Radio","FormGroup","Switch","checked","playOnClick","labelPlacement","Typography","rate","min","max","step","pitch","justify","Button","variant","connect","appState","dispatch","ksActions","KStart","memo","stageRef","baseRef","useRef","draggableRef","rectRef","handleFocus","cancelBubble","focus","teal","A100","baseRectProps","stroke","strokeWidth","shadowColor","shadowBlur","shadowOffsetY","shadowOpacity","nowDragging","isEditing","stage","current","style","cursor","labelProps","typeProps","svg","flag","color","rectGroupProps","ref","baseEl","draggableEl","willAnimation","isDragging","easing","Konva","Easings","EaseInOut","moreProps","arrowBaseProps","grey","next","p","key","prev","TreeNodeUtil","_init","toArrayWithoutClose","_open","_changeDraft","isDraft","_drag","_getDragNode","_dragEnd","_focus","_getFocusNode","_deleteFocus","addDetails","parent","newNode","baseTreeNode","pushedNode","addNextBrother","tree","addFromCommon","common","commonAsTreeNode","phrase","empty","switch","placeholder","EditorFrameComponent","updateStream","state","stream","streamPointer","location","pathname","newStream","console","log","setState","updateStreamThrottle","throttle","handleKeydown","event","ctrlKey","metaKey","shiftKey","undo","redo","edit","editNode","KTreeUtil","setCalcProps","nextPointer","save","manual","putTree","history","cannotSaveReason","manualId","rootTree","saved","process","nextTick","push","handleCancel","propNode","baseKWithArrow","goBack","handleShowVS","showVS","kWith","window","addEventListener","this","removeEventListener","buttonRef","nodeProps","hasDifference","display","flexDirection","mt","when","message","toolArea","disabled","onClose","BackdropProps","viewSettingModal","disableAutoFocus","autoFocus","React","withRouter","withStyles","createStyles","right","convergent","close","editFinishButton","marginLeft","backgroundColor","viewSettingPaper","NodeEditorComponent","mainRef","labelRef","actionMenuRef","nextBrotherButtonRef","kTree","rows","dropRow","addScrollEventListener","scrollContainer","scroll","resize","mref","offsetWidth","offsetHeight","draw","didRender","dx","scrollLeft","dy","scrollTop","scrollToNew","result","baseKTreeNode","focusNode","setTimeout","labelFocus","maxScroll","duration","onFinish","expand","changeDraft","openInfo","infoNode","ssu","SpeechSynthesisUtterance","Util","isEmpty","lang","speechSynthesis","cancel","speak","depth","deleteFocus","dragStart","dragParent","dragMove","pointX","round","pointY","row","closeTarget","action","out","getCurrentTree","dragEnd","changeFocusNode","changeType","typeAnchorEl","newCase","addNextBrotherResult","deleteSelf","deleteFlag","getInitialState","flatNodes","makeDragMap","nodeActionProps","ActionButtonBox","ImageBox","TypeButton","Label","isRoot","menu","boxStyle","createMuiTheme","src","img","alt","imageName","buttonStyle","currentTarget","disableRipple","anchorEl","Boolean","inset","labelStyle","inputRef","InputProps","InputLabelProps","shrink","onKeyDown","keyCode","blur","largeContainerStyle","infoContentProps","changeNode","maxWidth","fullWidth","toolbarHeight","breakpoints","down","toolbar","mixins","saveButton","minWidth","extendedIcon","objectFit","verticalAlign","KNode","handleDragStart","scaleX","scaleY","handleDragMove","dragPoint","handleDragEnd","currentTree","ct","lightBlue","amber","yellow","isFocus","switchSvg","scale","draggable","onDragStart","onTouchStart","onDragMove","onTouchMove","onDragEnd","onTouchEnd","KShadow","groupRef","handleDeleteFocus","destroy","dragEl","containerRectProps","endIconProps","secondary","select","marginRight","selectType","switchIcon","title","imageButton","imageIcon","imageFormContainer","marginBottom","paddingLeft","imageContainer","deleteButton","InfoContentComponent","fileReader","fileName","useState","setOpen","selectIsCommonRef","setSelectIsCommonWidth","selectTypeRef","setSelectTypeWidth","commonEl","ReactDOM","findDOMNode","typeEl","handleFileRead","content","InputIcon","OutputIcon","PreConditionsIcon","PostConditionsIcon","WorkerInChargeIcon","RemarksIcon","NecessaryToolsIcon","ExceptionsIcon","InputField","startAdornment","multiline","OutputField","PreConditionsField","PostConditionsField","WorkerInChargeField","RemarksField","NecessaryToolsField","ExceptionsField","classnames","flexGrow","justifyContent","handleDeleteImage","in","component","file","files","FileReader","onload","readAsDataURL","filePath","TextEditor","textLineWithIconProps","itemNumber","showChildren","TextLineWithIcon","focusType","pl","pr","py","alignItems","IconComponent","str","getID","validPassword","password","test","ACTIONS_KSIZE_CHANGE","ACTIONS_KSIZE_ZOOM_IN","ACTIONS_KSIZE_ZOOM_OUT","zoomIn","zoomOut","Show","loginUserAction","set","startSessionCheck","sessionChecked","put","putSuccess","putError","loginUserReducer","reducerWithInitialState","user","userBeforeSaving","manualAction","get","getSuccess","update","clear","post","delete","checkFavorite","uncheckFavorite","checkLike","uncheckLike","copy","postForCopy","treeActions","manualReducer","requestGet","cloneManual","cloneDeep","userId","favoriteIds","fid","likeIds","lid","memosActions","changeSuccess","changeError","memoReducer","memos","keys","ft","tes","commonList","memoList","ksString","localStorage","getItem","initialState","JSON","parse","ksReducer","defaultRS","rsReducer","loginURL","baseManualQueryParams","filters","favorite","ALL","like","categoryId","searchText","sortColumn","sortDirection","page","rowsPerPage","manualURL","user1","lastName","firstName","mail","user2","user3","user4","manual1","baseManual","description","ownerId","collaboratorIds","updateAt","createAt","manual2","manual3","isPublic","manual4","visible","baseTree","category1","name","category2","category3","userGroup1","memberIds","userGroup2","postLogin","config","method","url","requestJson","data","req","users","userGroups","manuals","categories","Array","data1","data2","data3","data4","deleteLogin","reversedURL","reduceRight","_delete","putLoginUser","putPassword","postTitleCheck","valid","postGenerateTitle","ceil","postManualsQuery","queryParams","count","postSessionCheck","rand","floor","error","axios","mock","MockAdapter","axiosbase","delayResponse","onPost","reply","onDelete","regexUsersURL","onPut","regexPasswordURL","regexManualsURL","onGet","Manual","regexFavoriteURL","Favorite","regexLikeURL","Like","regexTreeURL","mockAdapter","login","loginInfo","then","res","catch","logout","sessionCheck","loginUserPut","manualGet","manualPost","manualPut","manualDelete","titleCheckPost","checkRequest","generateTitlePost","original","favoritePost","params","favoriteDelete","likePost","likeDelete","treePut","loginActions","usersAction","categoriesAction","filterSet","filterReset","notificationsAction","enqueue","dequeue","dismiss","remove","loadingActions","beginLogin","endLogin","beginManualQuery","endManualQuery","beginManual","endManual","userGroupsAction","getTitleForCheck","titleCheck","getKSize","getLoginUser","loginUser","getUsers","titleCheckAction","generate","done","handleRequestLogin","handleRequestLogout","handleSessionCheck","handleRequestPutLoginUser","handleUpdateLoginUser","handleRequestGetManual","handleRequestPostManual","handleRequestPutManual","handleRequestDeleteManual","handleTitleCheck","handleRequestGenerateTitle","handleManualCopy","handleRequestPostFavorite","handleRequestDeleteFavorite","handleRequestPostLike","handleRequestDeleteLike","handleRequestPutTree","saveByChangeKS","saveByZoomInKS","saveByZoomOutKS","rootSaga","getKey","Date","getTime","take","call","API","payload","notification","u","ManualAction","preTitle","titleCheckState","requestBody","seed","manualPostRes","setItem","stringify","fork","categoriesReducer","usersReducer","notificationsReducer","displayed","loadingReducer","loginLoading","manualsLoading","manualLoading","userGroupsReducer","titleCheckReducer","willGenerate","titleSet","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","combineReducers","loading","notifications","applyMiddleware","run","links","dashboard","follows","up","paper","avatar","textField","wrapper","buttonProgress","LoginComponent","setId","setPassword","showPassword","setShowPassword","Avatar","TextField","endAdornment","InputAdornment","IconButton","aria-label","VisibilityOff","Visibility","size","CircularProgress","defaultTitle","isFirstRender","setIsFirstRender","currentTitle","setCurrentTitle","debounced","debounce","useEffect","renderAdornment","Check","green","red","helperText","zIndex","chip","inputRoot","flexWrap","inputInput","divider","AutoSingleSelect","inputLabel","suggestions","labelProp","initialSelectedItem","willReset","setWillReset","renderSuggestionList","listProps","inputValue","getItemProps","highlightedIndex","selectedItem","showEmpty","deburr","trim","toLowerCase","inputLength","suggestion","keep","getSuggestions","suggestionProps","itemProps","isHighlighted","isSelected","MenuItem","selected","fontWeight","renderSuggestion","getInputProps","getLabelProps","getMenuProps","isOpen","openMenu","clearSelection","onFocus","onBlur","inputProps","other","renderInput","square","CreateManualComponent","setCategoryId","setIsPublic","DialogTitle","DialogContent","minHeight","Box","DialogActions","add","getTextLabels","isFirstLoad","body","noMatch","toolTip","pagination","previous","displayRows","downloadCsv","print","viewColumns","filterTable","all","titleAria","selectedRows","deleteAria","head","background","drawerWidth","date","category","clearSelectManual","isLoading","setLoading","baseFavorite","baseLike","baseSearchText","baseSortColumn","baseSortDirection","basePage","baseRowsPerPage","setFavorite","setLike","setSearchText","setSortColumn","setSortDirection","setPage","setRowsPerPage","setManuals","setCount","isFirstRendering","setIsFirstRendering","setIsFirstLoad","currentSearchText","setCurrentSearchText","txt","columns","options","filterOptions","names","logic","sort","customHeadRender","o","TableCell","TableSortLabel","active","direction","StarBorder","customBodyRender","Badge","sum","bool","Star","ThumbUpAltOutlined","ThumbUpAlt","noWrap","m","owner","isFavorite","f","isLike","l","download","selectableRows","sortFilterList","elevation","rowHover","responsive","serverSide","rowsPerPageOptions","onTableChange","tableState","filterList","favoriteFilterList","newFavoriteFilter","CHECK","UNCHECK","likeFilterList","newLikeFilter","categoryFilterList","newCategory","changeFilter","changeSearchText","onColumnSortChange","colName","dirStr","dir","textLabels","handleClose","mr","Hidden","lgUp","implementation","Fab","Add","blue","pink","typography","button","textTransform","overrides","MuiTableCell","paddingRight","MuiTableSortLabel","Dialog","BaseSettings","propManual","titleReset","setManual","isOwner","hasChange","isValid","rowsMax","BaseSettingsComponent","Collaborators","difference","createUserIdentityName","selectCollaboratorId","setCollaboratorId","collaborators","cid","others","Chip","ml","CollaboratorsComponent","PublishingSettingsComponent","groups","viewerIdsOfUser","viewerIdsOfGroup","selectViewerOfUser","setViewerOfUser","userViewers","uid","otherUsers","selectViewerOfGroup","setViewerOfGroup","groupViewers","gid","g","otherGroups","pt","px","Copy","CopyComponent","setTitle","miss","setMiss","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Close","DeleteComponent","ChangeOwnerComponent","usersAsItem","ManualSettings","setSelected","handleSelect","sm","lg","List","ListItem","ListItemText","TextEditorComponent","AdapterLink","innerRef","more","less","KViewNode","expandProps","NodePrintComponent","useCallback","kTreeNode","contentRef","trigger","TextPrint","Select","TextPrintDialogComponent","header","info","opacity","progressContainer","progress","selectNode","tabIndex","manualUser","setShowVS","showPrintNode","setShowPrintNode","showPrintText","setShowPrintText","isCommiter","ShowTree","path","render","LoadingTree","mx","Info","deleteFavorite","postFavorite","ThumbUp","deleteLike","postLike","Tabs","tabType","Tab","Print","ZoomIn","ZoomOut","Divider","Modal","keepMounted","box","boxWithoutDrawer","NowLoading","hasDrawer","componentProps","PageRouter","exact","Dashboard","ViewContainer","listContainer","notSelected","setHeight","listContainerEl","setListContainerEl","getListContainerRef","el","itemCount","itemSize","DrawerContentComponent","ProfileComponent","setUser","setIsEditing","setTabIndex","setLastName","setFirstName","setMail","isEqual","beforeFirstPasswordSubmit","setBeforeFirstPasswordSubmit","oldPassword","setOldPassword","showOld","setShowOld","oldValidMsg","newPassword","setNewPassword","showNew","setShowNew","newValidMsg","confirmation","setConfirmation","showConfirmation","setShowConfirmation","mailValidation","renderBase","pb","renderPassword","Collapse","mb","newUser","now","drawer","flexShrink","appBar","borderBottom","logoContainer","menuButton","borderRadius","shape","default","searchIcon","pointerEvents","transition","transitions","create","grow","accountCircle","drawerPaper","mobileOpen","setMobileOpen","handleDrawerToggle","setAnchorEl","isMenuOpen","showProfile","setShowProfile","handleHideProfile","renderMenu","transformOrigin","renderProfile","AppBar","Toolbar","edge","aria-controls","aria-haspopup","AccountCircle","Drawer","ModalProps","mdDown","AppFrameComponent","LoginContainer","LayoutContainer","closeSnackbarButton","closeSnackbar","useSnackbar","enqueueSnackbar","onExited","MuiCheckbox","MuiList","dense","MuiRadio","MuiSwitch","MuiTextField","Providers","Store","CssBaseline","maxSnack","document","querySelector","SvgToPath","rotation","basePathProps","Icon","rotate","transRate","svgProps","calcSelfLength","which","childrenLength","_setSize","showDraft","_setPoint","_setIndexAndDepth","bottom","kNode","makeBaseDragMap","sorted","beforeRow","r","makeBaseDropMap","makeDropMap","selfBase","beforeMarginHalf","beforeRectHalf","isEqualRow"],"mappings":"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","file":"static/js/main.e75d8b5b.chunk.js","sourcesContent":["import * as React from 'react';\r\n\r\nimport { Group, Rect, Text } from 'react-konva';\r\nimport { SvgPath } from '../../data-types/svg-path';\r\n\r\nimport Icon, { IconProps } from './icon';\r\nimport { theme } from '../..';\r\nimport KSize from '../../data-types/k-size';\r\n\r\nexport interface IconWithBadgeProps {\r\n  ks: KSize;\r\n  x: number;\r\n  y: number;\r\n  svg: SvgPath[];\r\n  color?: string;\r\n  backgroundColor?: string;\r\n  badgeContent: number;\r\n  rotate?: number;\r\n  scale?: {x: number, y: number};\r\n  onClick?: (e: any) => void;\r\n  onTap?: (e: any) => void;\r\n  onMouseEnter?: (e:any) => void;\r\n  onMouseLeave?: (e:any) => void;\r\n}\r\n\r\nconst IconWithBadge: React.FC<IconWithBadgeProps> = (props: IconWithBadgeProps) => {\r\n  const {ks, x, y, badgeContent, onClick, onTap, onMouseEnter, onMouseLeave} = props;\r\n  const iconProps: IconProps = {\r\n    ...props, ks, x: 0, y: 0\r\n  };\r\n  if (badgeContent < 1) { return <Group x={x} y={y}><Icon {...iconProps}/></Group>; }\r\n  const badgeLength = String(badgeContent).length;\r\n\r\n  const bl = ks.badgeFontHeight * 2;\r\n  const rectProps = {\r\n    x: (ks.rect.h / 2) * ks.unit,\r\n    y: (ks.rect.h * 9 / 20 - bl) * ks.unit,\r\n    width: (bl + (badgeLength - 1) * ks.badgeFontSize / 3) * ks.unit,\r\n    height: bl * ks.unit,\r\n    fill: theme.palette.primary.main,\r\n    cornerRadius: bl / 2 * ks.unit,\r\n    onClick,\r\n    onTap: onClick,\r\n    onMouseEnter,\r\n    onMouseLeave,\r\n  };\r\n\r\n  const textProps = {\r\n    x: (ks.rect.h / 2 + bl / 2.2 - (badgeLength) * ks.badgeFontSize / 5.5) * ks.unit,\r\n    y: (ks.rect.h * 9 / 20 - bl * 0.75) * ks.unit,\r\n    text: String(badgeContent),\r\n    fontSize: ks.badgeFontSize * ks.unit,\r\n    fill: '#fff',\r\n    onClick,\r\n    onTap,\r\n    onMouseEnter,\r\n    onMouseLeave,\r\n  };\r\n\r\n  return (\r\n    <Group x={x} y={y}>\r\n      <Icon {...iconProps}/>\r\n      <Rect {...rectProps}/>\r\n      <Text {...textProps}/>\r\n    </Group>\r\n  );\r\n};\r\n\r\nexport default IconWithBadge;","import { SvgPath } from \"../../data-types/svg-path\";\r\n\r\nexport const check: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z', fill: true}\r\n];\r\nexport default check;","import KSize from '../data-types/k-size';\r\nimport TextEditSettings from '../data-types/text-edit-settings';\r\n\r\nexport { default as Task } from '@material-ui/icons/Assignment';\r\nexport { default as Switch } from '@material-ui/icons/CallSplit';\r\nexport { default as Case } from '@material-ui/icons/Check';\r\nexport { default as Input } from '@material-ui/icons/GetApp';\r\nexport { default as Output } from '@material-ui/icons/Publish';\r\nexport { default as PreConditions } from '@material-ui/icons/AssignmentLate';\r\nexport { default as PostConditions } from '@material-ui/icons/AssignmentTurnedIn';\r\nexport { default as WorkerInCharge } from '@material-ui/icons/People';\r\nexport { default as Remarks } from '@material-ui/icons/InfoOutlined';\r\nexport { default as NecessaryTools } from '@material-ui/icons/Build';\r\nexport { default as Exceptions } from '@material-ui/icons/Error';\r\nexport { default as Image } from '@material-ui/icons/Photo';\r\nexport { default as Delete } from '@material-ui/icons/Delete';\r\nexport { default as Close } from '@material-ui/icons/Close';\r\nexport { default as More } from '@material-ui/icons/ExpandMore';\r\nexport { default as Less } from '@material-ui/icons/ExpandLess';\r\nexport { default as Divergent } from '@material-ui/icons/BlurOn';    // divergent  thinking（発散思考）、\r\nexport { default as Convergent } from '@material-ui/icons/ClearAll'; // convergent thinking（収束思考）\r\n\r\n\r\n\r\nexport const defaultKS: KSize = {\r\n  unit: 16,\r\n  rect: {w: 40, h: 2},\r\n  margin: {w: 1, h: 1},\r\n  spr: {w: 1, h: 1},\r\n  indent: 4,\r\n  fontSize: 0.9,\r\n  fontHeight: 0.75,\r\n  textline: 1,\r\n  icon: 1,\r\n  badgeFontSize: 0.7,\r\n  badgeFontHeight: 0.6,\r\n  cornerRadius: 0.5,\r\n  hasArrow: true,\r\n  pointerSpace: 0.2,\r\n  pointerLength: 0.4,\r\n  pointerWidth: 0.4\r\n};\r\n\r\nexport const tes: TextEditSettings = {\r\n  showAll: true,\r\n};","import { SvgPath } from \"../../../data-types/svg-path\";\r\n\r\nexport const moreVert: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z', fill: true}\r\n];\r\nexport default moreVert;","import actionCreatorFactory from 'typescript-fsa';\r\nimport ReadingSetting from '../../data-types/reading-settings';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const rsActions = {\r\n  change: actionCreator<ReadingSetting>('ACTIONS_RS_CHANGE'),\r\n  reset: actionCreator<void>('ACTIONS_RS_RESET'),\r\n};","import { KWithArrow, Point, isSwitch, isCase, isTask } from \"../data-types/tree\";\r\nimport KSize from \"../data-types/k-size\";\r\n\r\nexport default class KArrowUtil {\r\n\r\n  static setArrow = <T extends KWithArrow>(node: T, ks: KSize): T => {\r\n    var kArrow = KArrowUtil._resetArrow(node);\r\n    kArrow = KArrowUtil._setInArrowOfNotSwitch(kArrow, ks);\r\n    kArrow = KArrowUtil._setInArrowOfSwitch(kArrow, ks);\r\n    kArrow = KArrowUtil._setNextArrow(kArrow, ks);\r\n    kArrow = KArrowUtil._setReturnArrow(kArrow, null, null, ks);\r\n    return kArrow;\r\n  }\r\n\r\n  static _resetArrow = <T extends KWithArrow>(node: T): T => {\r\n    const children = node.children.map(c => KArrowUtil._resetArrow(c));\r\n    return {...node, children, arrows: []};\r\n  }\r\n\r\n  // InArrow は親要素から子要素への矢印\r\n  // NotSwitchのとき矢印は「↓」\r\n  static _setInArrowOfNotSwitch = <T extends KWithArrow>(node: T, ks: KSize): T => {\r\n    const children = node.children.map(c => KArrowUtil._setInArrowOfNotSwitch(c, ks));\r\n    if (!isSwitch(node.type) && (node.open && children.length !== 0)) {\r\n      const arrows: Point[][] = [[\r\n        {x: ks.rect.w / 2 - ks.spr.w * 4 + ks.indent, y: ks.rect.h},\r\n        {x: ks.rect.w / 2 - ks.spr.w * 4 + ks.indent, y: ks.rect.h + ks.margin.h - ks.pointerSpace}\r\n      ]];\r\n      return {...node, children, arrows};\r\n    }\r\n    return {...node, children};\r\n  }\r\n\r\n  // InArrow は親要素から子要素への矢印\r\n  // Switchのとき矢印は、各Caseに対して「↓→」\r\n  static _setInArrowOfSwitch = <T extends KWithArrow>(node: T, ks: KSize): T => {\r\n    const children = node.children.map(c => KArrowUtil._setInArrowOfSwitch(c, ks));\r\n    if (node.open && isSwitch(node.type) && children.length !== 0) {\r\n      var anchor = ks.rect.h + ks.margin.h + ks.rect.h * 0.5;\r\n      const arrows: Point[][] = children.map((c, i) => {\r\n        const points = [\r\n          {x: (ks.indent - ks.pointerSpace) / 2, y: ks.rect.h},\r\n          {x: (ks.indent - ks.pointerSpace) / 2, y: anchor},\r\n          {x: (ks.indent - ks.pointerSpace),     y: anchor},\r\n        ];\r\n        anchor += c.self.h + ks.margin.h;\r\n        return points;\r\n      });\r\n      return {...node, children, arrows};\r\n    }\r\n    return {...node, children};\r\n  }\r\n\r\n  // 並列関係の下に向かう矢印「↓」\r\n  static _setNextArrow = <T extends KWithArrow>(node: T, ks: KSize): T => {\r\n    const children = node.children.map((c, i) => {\r\n      if (c.open && c.children.length !== 0) {\r\n        return KArrowUtil._setNextArrow(c, ks);\r\n      } else {\r\n        if (!isCase(c.type) && node.children.length - 1 !== i) {\r\n          const openMargin = c.open ? ks.margin.h : 0;\r\n          const arrows: Point[][] = [[\r\n            {x: ks.rect.w / 2 - ks.spr.w * 4, y: ks.rect.h},\r\n            {x: ks.rect.w / 2 - ks.spr.w * 4, y: ks.rect.h + ks.margin.h + openMargin - ks.pointerSpace}\r\n          ]];\r\n          return {...c, arrows};\r\n        } else {\r\n          return c;\r\n        }\r\n      }\r\n    });\r\n    return {...node, children};\r\n  }\r\n  // 子要素から先祖要素に戻る矢印には３種類ある\r\n  // 子要素がCaseでなければ\r\n  //   ネストが深くない場合は「↓」\r\n  //   ネストが深い場合は「↓←↓」\r\n  // 子要素がCaseなら\r\n  static _setReturnArrow = <T extends KWithArrow>(node: T, before: T | null, exit: T | null, ks: KSize): T => {\r\n    if (node.open && node.children.length !== 0) {\r\n      const children = node.children.map((c, i, _children) => {\r\n        const isLastChildren = _children.length - 1 === i;\r\n        if (!isLastChildren) {\r\n          if (c.children.length !== 0) {\r\n            return !isSwitch(node.type)\r\n              ? KArrowUtil._setReturnArrow(c, c, _children[i + 1], ks)\r\n              : KArrowUtil._setReturnArrow(c, before, exit, ks);\r\n          } else {\r\n            return  c;\r\n          }\r\n        } else {\r\n          if (c.open && c.children.length !== 0) {\r\n            return KArrowUtil._setReturnArrow(c, before, exit, ks)\r\n          } else {\r\n            if (exit !== null) {\r\n              return {...c, arrows: KArrowUtil.getArrowPoints(c, before!, exit, ks)};\r\n            } else {\r\n              return c;\r\n            }\r\n          }\r\n        }\r\n      });\r\n      return {...node, children};\r\n    }\r\n    if (!node.open && isCase(node.type) && exit !== null) {\r\n      return {...node, arrows: KArrowUtil.getArrowPoints(node, before!, exit, ks)};\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  static _hasUnderNode = <T extends KWithArrow>(node: T, target: T): boolean => {\r\n    if (node.children.length === 0) { return false; }\r\n    const hasUnder = node.children.map(c => target.point.y < c.point.y).reduce((a, b) => a || b);\r\n    if (hasUnder) { return true; }\r\n    if (node.children[node.children.length - 1].id === target.id && !target.open) { return false; }\r\n    return node.children.map(c => KArrowUtil._hasUnderNode(c, target)).reduce((a, b) => a || b);;\r\n  } \r\n\r\n  static getArrowPoints = <T extends KWithArrow>(node: T, before: T, exit: T, ks: KSize): Point[][] => {\r\n    const dv: Point = {x: exit.point.x - node.point.x, y: exit.point.y - node.point.y};\r\n    if (isTask(before.type) && !KArrowUtil._hasUnderNode(before, node)) {\r\n      const exitCenter = ks.rect.w / 2  - ks.spr.w * 4 - (node.point.x - before.point.x);\r\n      if (exitCenter < ks.spr.w) {\r\n        return [[\r\n          {x: ks.rect.w / 2 - ks.spr.w * 4, y: ks.rect.h},\r\n          {x: ks.rect.w / 2 - ks.spr.w * 4, y: ks.rect.h + ks.spr.h},\r\n          {x: exitCenter,    y: ks.rect.h + ks.spr.h},\r\n          {x: exitCenter,    y: dv.y - ks.pointerSpace},\r\n        ]];\r\n      } else {\r\n        return [[\r\n          {x: exitCenter, y: ks.rect.h},\r\n          {x: exitCenter, y: dv.y - ks.pointerSpace}\r\n        ]];\r\n      }\r\n    } else {\r\n      \r\n      const beforeSelfX = before.self.w - (node.point.x - before.point.x) - ks.spr.w; \r\n      const secondPointX = beforeSelfX < ks.rect.w + ks.spr.w ? ks.rect.w + ks.spr.w : beforeSelfX;\r\n      const margin = ks.margin.h === 1 ? 1 : 2;\r\n      return [[\r\n        {x: ks.rect.w, y: ks.rect.h / 2},\r\n        {x: secondPointX, y: ks.rect.h / 2},\r\n        {x: secondPointX, y: dv.y - ks.spr.h * margin},\r\n        {x: ks.rect.w / 2 - ks.spr.w * 4 + dv.x, y: dv.y - ks.spr.h * margin},\r\n        {x: ks.rect.w / 2 - ks.spr.w * 4 + dv.x, y: dv.y - ks.pointerSpace}\r\n      ]];\r\n    }\r\n  }\r\n}\r\n\r\nexport type which = 'width' | 'height';","import {Tree, Type, isSwitch, isCase, TreeNode } from \"../data-types/tree\";\r\n\r\nexport default class TreeUtil {\r\n\r\n  static _get = <T1 extends Tree, T2 extends T1>(node: T1, base: T2): T2 => {\r\n    const children = node.children.map(c => TreeUtil._get(c, base));\r\n    return {...base, ...node, children};\r\n  }\r\n\r\n  static getAsArray = <T1 extends Tree, T2 extends T1>(node: T1[], base: T2): T2[] => {\r\n    return node.map(n => ({...base, ...n}));\r\n  }\r\n\r\n  // genealogy = 系譜：先祖〜targetのNodeリストを返す\r\n  static getGenealogy = (nodeList: Tree[], target: Tree): Tree[] => {\r\n\r\n    const genealogy = TreeUtil.getGeneOrFalse(nodeList, target);\r\n    if (genealogy === false) { throw new Error('Target is not found.'); }\r\n\r\n    return genealogy;\r\n  }\r\n\r\n  private static getGeneOrFalse = <T extends Tree>(nodeList: T[], target: T): T[] | false => {\r\n    if (nodeList.length === 0) { return false; }\r\n    \r\n    const findResult = nodeList.find(n => target.id === n.id);\r\n    if (findResult) { return [findResult]; }\r\n\r\n    return nodeList.map(n => {\r\n      const childResult = TreeUtil.getGeneOrFalse(n.children as T[], target);\r\n      return childResult !== false ? [n].concat(childResult) : false;\r\n    }).reduce((a, b) => a || b || false);\r\n  }\r\n\r\n  static _replaceArray = <T extends Tree>(nodeList: T[], target: T): T[] => {\r\n    if (nodeList.length === 0) { return []; }\r\n    return nodeList.map(n => target.id === n.id\r\n      ? target\r\n      : {...n, children: TreeUtil._replaceArray(n.children, target)});\r\n  }\r\n\r\n  static _replace = <T extends Tree>(node: T, target: T): T => {\r\n    if (node.id === target.id) { return target; }\r\n    const children = node.children.map(c => TreeUtil._replace(c, target));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _findArray = <T extends Tree>(nodeList: T[], targetId: string): T | undefined => {\r\n    if (nodeList.length === 0) { return undefined; }\r\n    const findResult = nodeList.find(n => n.id === targetId);\r\n    if (findResult !== undefined) { return findResult; }\r\n    return nodeList\r\n    .map(n => TreeUtil._findArray(n.children as T[], targetId))\r\n    .reduce((a, b) => a || b || undefined);\r\n  }\r\n\r\n  static _find = <T extends Tree>(node: T, targetId: string): T | undefined => {\r\n    if (node.id === targetId) { return node; }\r\n    if (node.children.length === 0) { return undefined; }\r\n    return node.children.map(c => TreeUtil._find(c as T, targetId)).reduce((a, b) => a || b || undefined);\r\n  }\r\n\r\n  static _toArray = <T extends Tree & { children: T[] }>(nodeList: T[]): T[] => {\r\n    return nodeList\r\n    .map(n => n.children.length === 0 ? [n] : [n].concat(TreeUtil._toArray(n.children)))\r\n    .reduce((a, b) => a.concat(b));\r\n  }\r\n\r\n  // toArray化済みのTree配列に対して使用する\r\n  static search = <T extends Tree>(text: string, nodes: T[]): T[] => {\r\n    const searchWords = TreeUtil.splitSearchWords(text);\r\n\r\n    return nodes.filter(n => searchWords.length === 0\r\n      ? true\r\n      : searchWords\r\n        .map(w => (\r\n          n.label.match(new RegExp(`${w}`)) !== null ||\r\n          n.output.match(new RegExp(`${w}`)) !== null\r\n        ))\r\n        .reduce((a, b) => a === true && b === true));\r\n  }\r\n\r\n  static splitSearchWords = (text: string) => text.split(/\\s|　/).map(s => s.replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&'));\r\n\r\n  static _setId = (node: Tree): Tree => {\r\n    const id = 'rand:' + String(Math.random()).slice(2);\r\n    const children = node.children.map(c => TreeUtil._setId(c));\r\n    return {...node, id, children};\r\n  }\r\n\r\n  static _clearId = (node: Tree): Tree => {\r\n    const children = node.children.map(c => TreeUtil._clearId(c));\r\n    return {...node, id: '', children};\r\n  }\r\n\r\n  static getNewNode = <T extends Tree>(parentType: Type, base: T): T => ({\r\n    ...base, \r\n    id: 'rand:' + String(Math.random()).slice(2),\r\n    type: !isSwitch(parentType) ? Type.task : Type.case,\r\n    open: isSwitch(parentType),\r\n    children: !isSwitch(parentType) ? [] :\r\n      [{...base, id: 'rand:' + String(Math.random()).slice(2)}]\r\n  });\r\n\r\n  static match = (node: Tree, words: string[]): boolean => {\r\n    if (words.length === 0) { return true; }\r\n    return words\r\n    .map(w => (\r\n      node.label.match(new RegExp(`${w}`)) !== null ||\r\n      node.output.match(new RegExp(`${w}`)) !== null\r\n    ))\r\n    .reduce((a, b) => a === true && b === true);\r\n  }\r\n\r\n  // ある子孫要素が検索に該当している場合に、そこに至る親要素も含めたTreeを返す。\r\n  static _searchAndFilter = <T extends Tree>(words: string[], nodes: T[]): T[] => {\r\n    return nodes\r\n    // nodeには未加工のデータを格納、childrenは子要素を絞り込んだ要素配列を作成する\r\n    .map(n => ({...n, children: TreeUtil._searchAndFilter(words, n.children)}))\r\n    // 自分自身が検索にヒットしているか、または子孫要素が検索にヒットしているか\r\n    .filter(n => TreeUtil.match(n, words) || n.children.length !== 0)\r\n  }\r\n\r\n  static _hasDifference = <T extends Tree>(a: T, b: T): boolean => {\r\n    if (a.id     !== b.id)     { return true; }\r\n    if (a.type   !== b.type)   { return true; }\r\n    if (a.label  !== b.label)  { return true; }\r\n    if (a.input  !== b.input)  { return true; }\r\n    if (a.output !== b.output) { return true; }\r\n    if (a.preConditions  !== b.preConditions)  { return true; }\r\n    if (a.postConditions !== b.postConditions) { return true; }\r\n    if (a.workerInCharge !== b.workerInCharge) { return true; }\r\n    if (a.remarks        !== b.remarks)        { return true; }\r\n    if (a.necessaryTools !== b.necessaryTools) { return true; }\r\n    if (a.exceptions     !== b.exceptions)     { return true; }\r\n    if (a.imageBlob      !== b.imageBlob)      { return true; }\r\n\r\n    if (a.children.length !== b.children.length) { return true; }\r\n    if (a.children.length === 0) { return false; }\r\n\r\n    return a.children\r\n    .map((_, i) => ({t: a.children[i], e: b.children[i]}))\r\n    .map(te => TreeUtil._hasDifference(te.t, te.e))\r\n    .reduce((a, b) => a || b);\r\n  }\r\n\r\n  static _hasDifferenceWithAppearance = <T extends TreeNode>(a: T, b: T): boolean => {\r\n    if (a.open   !== b.open)   { return true; }\r\n\r\n    if (a.id     !== b.id)     { return true; }\r\n    if (a.type   !== b.type)   { return true; }\r\n    if (a.label  !== b.label)  { return true; }\r\n    if (a.input  !== b.input)  { return true; }\r\n    if (a.output !== b.output) { return true; }\r\n    if (a.preConditions  !== b.preConditions)  { return true; }\r\n    if (a.postConditions !== b.postConditions) { return true; }\r\n    if (a.workerInCharge !== b.workerInCharge) { return true; }\r\n    if (a.remarks        !== b.remarks)        { return true; }\r\n    if (a.necessaryTools !== b.necessaryTools) { return true; }\r\n    if (a.exceptions     !== b.exceptions)     { return true; }\r\n    if (a.imageBlob      !== b.imageBlob)      { return true; }\r\n\r\n    if (a.children.length !== b.children.length) { return true; }\r\n    if (a.children.length === 0) { return false; }\r\n\r\n    return a.children\r\n    .map((_, i) => ({t: a.children[i], e: b.children[i]}))\r\n    .map(te => TreeUtil._hasDifferenceWithAppearance(te.t, te.e))\r\n    .reduce((a, b) => a || b);\r\n  }\r\n\r\n  static _isAllSwitchHasCase = <T extends Tree>(node: T): boolean => {\r\n    if (node.children.length === 0) { return !isSwitch(node.type); }\r\n    return node.children.map(c => TreeUtil._isAllSwitchHasCase(c)).reduce((a, b) => a && b);\r\n  }\r\n\r\n  static _isAllCaseHasItem = <T extends Tree>(node: T): boolean => {\r\n    if (node.children.length === 0) { return !isCase(node.type); }\r\n    return node.children.map(c => TreeUtil._isAllCaseHasItem(c)).reduce((a, b) => a && b);\r\n  }\r\n\r\n  static _deleteById = <T extends Tree>(node: T, id: string): T => {\r\n    const findResult = node.children.find(c => c.id === id);\r\n    if (findResult !== undefined) {\r\n      return {...node, children: node.children.filter(c => c.id !== id)};\r\n    }\r\n\r\n    const children = node.children.map(c => TreeUtil._deleteById(c, id));\r\n    return {...node, children};\r\n  }\r\n\r\n  static moveBrother = <T extends Tree>(node: T, from: T, to: T): T => {\r\n    const parentNode = TreeUtil._getPrent(node, from);\r\n    const childrenIds = parentNode!.children.map(c => c.id);\r\n    const isNext = childrenIds.indexOf(from.id) + 1 === childrenIds.indexOf(to.id);\r\n    const deletedTree = TreeUtil._deleteById(node, from.id);\r\n    return TreeUtil._insert(deletedTree, from, to, isNext);\r\n  }\r\n\r\n  static _insert = <T extends Tree>(node: T, target: T, to: T, isNext: boolean): T => {\r\n    const index = node.children.map(c => c.id).indexOf(to.id);\r\n\r\n    if (index !== -1) {\r\n      node.children.splice(index + (isNext ? 1 : 0), 0, target);\r\n      return node;\r\n    } else {\r\n      const children = node.children.map(c => TreeUtil._insert(c, target, to, isNext));\r\n      return {...node, children};\r\n    }\r\n  }\r\n\r\n  static moveInOut = <T extends Tree>(node: T, child: T, parentNode: T): T => {\r\n    const moveIn = parentNode.children.find(c => c.id === child.id) === undefined;\r\n    const deletedTree = TreeUtil._deleteById(node, child.id);\r\n    if (moveIn) {\r\n      return TreeUtil._push(deletedTree, child, parentNode);\r\n    } else {\r\n      return TreeUtil._insert(deletedTree, child, parentNode, true);\r\n    }\r\n  }\r\n\r\n  static _push = <T extends Tree>(node: T, child: T, parentNode: T): T => {\r\n    const children = node.id === parentNode.id\r\n    ? node.children.concat([child])\r\n    : node.children.map(c => TreeUtil._push(c, child, parentNode));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _unshift = <T extends Tree>(node: T, child: T, parentNode: T): T => {\r\n    const children = node.id === parentNode.id\r\n    ? [child].concat(node.children as T[])\r\n    : node.children.map(c => TreeUtil._unshift(c, child, parentNode));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _getPrent = <T extends Tree>(node: T, target: T): T | null => {\r\n    if (node.children.length === 0) { return null; }\r\n    if (node.children.find(c => c.id === target.id) !== undefined) { return node; }\r\n    return node.children\r\n      .map(c => TreeUtil._getPrent(c, target) as (T | null))\r\n      .reduce((a, b) => a || b || null);\r\n  }\r\n}","import * as React from 'react';\r\nimport {\r\n  makeStyles, Theme, Grid, Paper, Typography, FormControl, FormLabel, RadioGroup, FormControlLabel, Radio, Button, FormGroup, Switch,\r\n} from '@material-ui/core';\r\nimport Slider from '@material-ui/lab/Slider';\r\nimport KSize from '../../data-types/k-size';\r\nimport { KSState } from '../../redux/states/ksState';\r\nimport { RSState } from '../../redux/states/rsState';\r\nimport { ViewSettingsActions } from './view-settings-container';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    position: 'absolute',\r\n    top: '75vh',\r\n    left: '50vw',\r\n    width: '90vw',\r\n    maxHeight: '45vh',\r\n    transform: 'translate(-50%, -50%)',\r\n    padding: theme.spacing(4),\r\n    paddingBottom: theme.spacing(2),\r\n    outline: 'none',\r\n    overflow: 'scroll',\r\n  },\r\n  speechLabel: {\r\n    marginTop: theme.spacing(3.8),\r\n  },\r\n  cardSettingLabel: {\r\n    paddingTop: theme.spacing(3),\r\n    paddingBottom: theme.spacing(3),\r\n  },\r\n  longSetter: {\r\n    width: 200,\r\n  },\r\n  shortSetter: {\r\n    width: 100,\r\n  },\r\n  slider: {\r\n    paddingTop: theme.spacing(3),\r\n    paddingBottom: theme.spacing(3),\r\n  },\r\n}));\r\n\r\ninterface Props extends KSState, RSState, ViewSettingsActions {}\r\n\r\nconst ViewSettingsComponent: React.FC<Props> = (props: Props) => {\r\n  const { ks, rs, changeKS, changeRS, resetKS, resetRS } = props;\r\n  const reset = () => {\r\n    resetKS();\r\n    resetRS();\r\n  };\r\n  const classes = useStyles();\r\n  return (\r\n    <Paper className={classes.root}>\r\n      <Grid container spacing={4}>\r\n        <Grid item xs={12} md={4}>\r\n          <FormControl>\r\n            <FormLabel>フローの表現</FormLabel>\r\n            <RadioGroup\r\n              value={ks.hasArrow ? 'arrow' : 'rect'}\r\n              onChange={(e: any) => {\r\n                const newKS: KSize = {...ks, hasArrow: e.target.value === 'arrow'};\r\n                changeKS(newKS);\r\n              }}\r\n            >\r\n              <FormControlLabel value=\"arrow\" control={<Radio />} label=\"フローチャート\" />\r\n              <FormControlLabel value=\"rect\"  control={<Radio />} label=\"包含関係図（オイラー図）\" />\r\n            </RadioGroup>\r\n          </FormControl>\r\n        </Grid>\r\n        <Grid item xs={12} md>\r\n          <Grid container spacing={5}>\r\n            <Grid item>\r\n              <FormControl>\r\n                <FormLabel>音声読み上げ</FormLabel>\r\n                <FormGroup>\r\n                  <FormControlLabel\r\n                    control={\r\n                      <Switch checked={rs.playOnClick} onChange={(e: any) => changeRS({...rs, playOnClick: e.target.checked})}/>\r\n                    }\r\n                    label=\"カード選択時に読み上げ\"\r\n                    labelPlacement=\"start\"\r\n                  />\r\n                </FormGroup>\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item>\r\n              <Typography className={classes.speechLabel}>再生スピード</Typography>\r\n              <div className={classes.shortSetter}>\r\n                <Slider\r\n                  classes={{ container: classes.slider }}\r\n                  value={rs.rate}\r\n                  min={0.1}\r\n                  max={1.5}\r\n                  step={0.1}\r\n                  onChange={(_, value) => changeRS({...rs, rate: value})}\r\n                />\r\n              </div>\r\n            </Grid>\r\n            <Grid item>\r\n              <Typography className={classes.speechLabel}>再生ピッチ</Typography>\r\n              <div className={classes.shortSetter}>\r\n                <Slider\r\n                  classes={{ container: classes.slider }}\r\n                  value={rs.pitch}\r\n                  min={0.1}\r\n                  max={2}\r\n                  step={0.1}\r\n                  onChange={(_, value) => changeRS({...rs, pitch: value})}\r\n                />\r\n              </div>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <FormLabel className={classes.cardSettingLabel}>カード表示設定</FormLabel>\r\n      <Grid container justify=\"space-between\" spacing={4}>\r\n        <Grid item xs={12} md={4}>\r\n          <div className={classes.longSetter}>\r\n            <Typography>表示の大きさ</Typography>\r\n            <Slider\r\n              classes={{ container: classes.slider }}\r\n              value={ks.unit}\r\n              min={8}\r\n              max={30}\r\n              step={2}\r\n              onChange={(_, value) => {\r\n                const newKS = {...ks, unit: value};\r\n                changeKS(newKS);\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={6} md={4}>\r\n          <div className={classes.longSetter}>\r\n            <Typography>長方形の横幅</Typography>\r\n            <Slider\r\n              classes={{ container: classes.slider }}\r\n              value={ks.rect.w}\r\n              min={20}\r\n              max={80}\r\n              step={1}\r\n              onChange={(_, value) => {\r\n                const newKS = {...ks, rect: {...ks.rect, w: value}};\r\n                changeKS(newKS);\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={6} md={4}>\r\n          <div className={classes.shortSetter}>\r\n            <Typography>長方形の縦幅</Typography>\r\n            <Slider\r\n              classes={{ container: classes.slider }}\r\n              value={ks.rect.h}\r\n              min={2}\r\n              max={4}\r\n              step={1}\r\n              onChange={(_, value) => {\r\n                const newKS = {...ks, rect: {...ks.rect, h: value}};\r\n                changeKS(newKS);\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={6} md={4}>\r\n          <div className={classes.shortSetter}>\r\n            <Typography>インデント</Typography>\r\n            <Slider\r\n              classes={{ container: classes.slider }}\r\n              value={ks.indent}\r\n              min={2}\r\n              max={6}\r\n              step={2}\r\n              onChange={(_, value) => {\r\n                const newKS = {...ks, indent: value};\r\n                changeKS(newKS);\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={6} md={4}>\r\n          <div className={classes.shortSetter}>\r\n            <Typography>縦の余白</Typography>\r\n            <Slider\r\n              classes={{ container: classes.slider }}\r\n              value={ks.margin.h}\r\n              min={1}\r\n              max={3}\r\n              step={1}\r\n              onChange={(_, value) => {\r\n                const newKS = {...ks, margin: {...ks.margin, h: value}};\r\n                changeKS(newKS);\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={12} md={4}>\r\n          <Button variant=\"contained\" onClick={reset}>\r\n            既定値へ戻す\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Paper>\r\n  );\r\n}\r\n\r\nexport default ViewSettingsComponent;","import { Dispatch, Action } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../redux/store';\r\nimport KSize from '../../data-types/k-size';\r\nimport { ksActions } from '../../redux/actions/ksAction';\r\nimport ReadingSetting from '../../data-types/reading-settings';\r\nimport { rsActions } from '../../redux/actions/rsAction';\r\nimport ViewSettingsComponent from './view-settings-component';\r\n\r\n\r\nexport interface ViewSettingsActions {\r\n  changeKS: (ks: KSize) => Action<KSize>;\r\n  resetKS:  () => Action<KSize>;\r\n  changeRS: (rs: ReadingSetting) => Action<ReadingSetting>,\r\n  resetRS:  () => Action<ReadingSetting>,\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {...appState.ks, ...appState.rs};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    changeKS:  (ks: KSize) => dispatch<Action>(ksActions.change(ks)),\r\n    resetKS:   () => dispatch<Action>(ksActions.reset()),\r\n    changeRS:  (rs: ReadingSetting) => dispatch<Action>(rsActions.change(rs)),\r\n    resetRS:   () => dispatch<Action>(rsActions.reset()),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ViewSettingsComponent);","import React, { useRef, memo } from 'react';\r\nimport { teal, grey } from '@material-ui/core/colors';\r\nimport Konva from 'konva';\r\nimport { Rect, Group, Text, Arrow } from 'react-konva';\r\nimport { flag } from '../../resource/svg-icon';\r\n\r\nimport { KWithArrow } from '../../data-types/tree';\r\n\r\nimport KSize from '../../data-types/k-size';\r\nimport Icon, { IconProps } from './icon';\r\nimport { theme } from '../..';\r\nimport IconWithBadge, { IconWithBadgeProps } from './icon-with-badge';\r\nimport moreVert from '../../resource/svg-icon/more/more-vert';\r\n\r\nexport interface KStartProps {\r\n  node: KWithArrow;\r\n  isEditing: boolean;\r\n  nowDragging: boolean;\r\n  ks: KSize;\r\n  focus: (node: KWithArrow) => void;\r\n  openInfo: (node: KWithArrow) => void;\r\n  stageRef: React.RefObject<any>;\r\n}\r\n\r\nconst KStart: React.FC<KStartProps> = memo(props => {\r\n\r\n  const { node, ks, stageRef } = props;\r\n\r\n  const baseRef = useRef<any>(null);\r\n  const draggableRef = useRef<any>(null);\r\n  const rectRef = useRef<any>(null);\r\n\r\n  const onMouseEnterBaseRect = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'grab';\r\n    }\r\n  }\r\n\r\n  const onMouseLeaveBaseRect = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'default';\r\n    }\r\n  }\r\n\r\n  const handleFocus = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (node.focus) { return; }\r\n    props.focus(node);\r\n  }\r\n\r\n  const onMouseEnterButton = (e: any) => {\r\n    e.cancelBubble = true;\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'pointer';\r\n    }\r\n  }\r\n\r\n  const onMouseLeaveButton = (e: any) => {\r\n    e.cancelBubble = true;\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'default';\r\n    }\r\n  }\r\n\r\n  const fill = teal.A100;\r\n\r\n  const baseRectProps = {\r\n    x: 0, y: 0,\r\n    width: node.rect.w * ks.unit,\r\n    height: node.rect.h * ks.unit,\r\n    cornerRadius: 4,\r\n    fill,\r\n    stroke: node.focus ? '#80bdff' : '#0000',\r\n    strokeWidth: 6,\r\n    shadowColor: node.focus ? '#80bdff' : 'black',\r\n    shadowBlur: 6,\r\n    shadowOffsetY: node.focus ? 0 : 3,\r\n    shadowOpacity: node.focus ? 1 : props.nowDragging ? 0.2 : 0.1,\r\n    onMouseEnter: onMouseEnterBaseRect,\r\n    onMouseLeave: onMouseLeaveBaseRect,\r\n  };\r\n\r\n  const rectProps = node.focus ? {\r\n    ...baseRectProps,\r\n    stroke: '#80bdff',\r\n    shadowColor: '#80bdff',\r\n    strokeWidth: 6,\r\n    shadowBlur: 6,\r\n    shadowOffsetY: 0,\r\n    shadowOpacity: 1,\r\n  } : baseRectProps;\r\n\r\n  const labelProps = {\r\n    text: \"スタート\",\r\n    fontSize: ks.fontSize * ks.unit,\r\n    x: (ks.rect.h + ks.fontSize / 2) * ks.unit,\r\n    y: (ks.rect.h - ks.fontHeight) / 2 * ks.unit,\r\n  };\r\n\r\n  const typeProps: IconProps = {\r\n    ks,\r\n    x: 0, y: 0,\r\n    svg: flag,\r\n    color: theme.palette.primary.main\r\n  };\r\n\r\n  // onTouchStart?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n  // onTouchMove?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n  // onTouchEnd?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n\r\n  const rectGroupProps = {\r\n    x: 0, y: 0,\r\n    ref: draggableRef,\r\n    onClick: handleFocus,\r\n    onTap: handleFocus,\r\n  };\r\n\r\n  const baseEl = baseRef.current;\r\n  const draggableEl = draggableRef.current;\r\n  // dragElが要素の参照を持っていてもなぜか座標を持っていない場合があるため x の値をチェック\r\n  const willAnimation = baseEl !== null && draggableEl !== null &&\r\n    (baseEl.x() !== 0 && !draggableEl.isDragging());\r\n  if (willAnimation) {\r\n    baseEl.to({\r\n      x: node.point.x * ks.unit,\r\n      y: node.point.y * ks.unit,\r\n      easing: Konva.Easings.EaseInOut\r\n    });\r\n  }\r\n\r\n  const x = !willAnimation ? node.point.x * ks.unit : undefined;\r\n  const y = !willAnimation ? node.point.y * ks.unit : undefined;\r\n  \r\n  const moreProps: IconWithBadgeProps = {\r\n    ks,\r\n    x: (ks.rect.w - ks.rect.h) * ks.unit, y: 0,\r\n    svg: moreVert,\r\n    badgeContent: node.children.length,\r\n    onClick: handleFocus,\r\n    onMouseEnter: onMouseEnterButton,\r\n    onMouseLeave: onMouseLeaveButton,\r\n  };\r\n\r\n  const arrowBaseProps = {\r\n    stroke: grey[700],\r\n    fill: grey[700],\r\n    pointerLength: ks.pointerLength * ks.unit,\r\n    pointerWidth: ks.pointerWidth * ks.unit,\r\n  }\r\n\r\n  return (\r\n    <Group ref={baseRef} x={x} y={y} >\r\n      <Group {...rectGroupProps}>\r\n        <Rect ref={rectRef} {...rectProps} />\r\n        <Icon {...typeProps} />\r\n        <Text {...labelProps} />\r\n        <IconWithBadge {...moreProps} />\r\n        {ks.hasArrow && node.arrows.map((a, i) => {\r\n          const points = a.map(point => [point.x, point.y]).reduce((before, next) => before.concat(next)).map(p => p * ks.unit);\r\n          return <Arrow key={`${node.id}-arrow-${i}`} {...arrowBaseProps} points={points} />;\r\n        })}\r\n      </Group>\r\n    </Group>\r\n  );\r\n}, (prev, next) => {\r\n  return !prev.node.isDragging && next.node.isDragging;\r\n});\r\n\r\nexport default KStart;","import {TreeNode, Tree, baseTreeNode } from \"../data-types/tree\";\r\nimport TreeUtil from \"./tree\";\r\n\r\nexport default class TreeNodeUtil {\r\n\r\n  static _init = <T extends TreeNode>(node: T): T => {\r\n    const children = node.children.map(c => TreeNodeUtil._init(c));\r\n    return {...node, open: children.length !== 0, focus: false, children};\r\n  }\r\n\r\n  static toArrayWithoutClose = <T extends TreeNode>(node: T): T[] => {\r\n    if (node.children.length === 0 || !node.open) { return [node]; }\r\n    return [node].concat((node.children as T[]).map(c => TreeNodeUtil.toArrayWithoutClose(c)).reduce((a, b) => a.concat(b)));\r\n  }\r\n\r\n  static _open = <T extends TreeNode>(node: T, id: string, open: boolean): T => {\r\n    if (node.id === id) { return {...node, open}; }\r\n    const children = node.children.map(c => (TreeNodeUtil._open(c, id, open)));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _changeDraft = <T extends TreeNode>(node: T, id: string, isDraft: boolean): T => {\r\n    if (node.id === id) { return {...node, isDraft}; }\r\n    const children = node.children.map(c => (TreeNodeUtil._changeDraft(c, id, isDraft)));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _drag = <T extends TreeNode>(node: T, id: string, isDragging: boolean): T => {\r\n    if (node.id === id) { return {...node, isDragging}; }\r\n    const children = node.children.map(c => (TreeNodeUtil._drag(c, id, isDragging)));\r\n    return {...node, children};\r\n  }\r\n\r\n  static _getDragNode = <T extends TreeNode>(node: T): T | undefined => {\r\n    if (node.isDragging) { return node; }\r\n    if (node.children.length === 0) { return undefined; }\r\n    return node.children.map(c => TreeNodeUtil._getDragNode(c) as T)\r\n    .reduce((a, b) => a || b || undefined);\r\n  }\r\n\r\n  static _dragEnd = <T extends TreeNode>(node: T): T => {\r\n    const children = node.children.map(c => (TreeNodeUtil._dragEnd(c)));\r\n    return {...node, children, isDragging: false};\r\n  }\r\n\r\n  static _focus = <T extends TreeNode>(node: T, id: string): T => {\r\n    const children = node.children.map(c => (TreeNodeUtil._focus(c, id)));\r\n    return {...node, children, focus: node.id === id};\r\n  }\r\n\r\n  static _getFocusNode = <T extends TreeNode>(node: T): T | undefined => {\r\n    if (node.focus) { return node; }\r\n    if (node.children.length === 0) { return undefined; }\r\n    return node.children.map(c => TreeNodeUtil._getFocusNode(c) as T)\r\n    .reduce((a, b) => a || b || undefined);\r\n  }\r\n\r\n  static _deleteFocus = <T extends TreeNode>(node: T): T => {\r\n    if (node.focus === true) { return {...node, focus: false}; }\r\n    const children = node.children.map(c => (TreeNodeUtil._deleteFocus(c)));\r\n    return {...node, children};\r\n  }\r\n\r\n  static addDetails = <T extends TreeNode>(node: T, parent: T): T => {\r\n    const newNode = TreeUtil.getNewNode(parent.type, baseTreeNode);\r\n    const pushedNode = TreeUtil._unshift(node, newNode, parent);\r\n    return TreeNodeUtil._open(pushedNode, parent.id, true) as T;\r\n  }\r\n\r\n  static addNextBrother = <T extends TreeNode>(tree: T, to: T): {node: T, newNode: T} => {\r\n    const parentNode = TreeUtil._getPrent(tree, to);\r\n    if (parentNode === null) { throw new Error('cannot find a parent.'); }\r\n    const newNode = TreeUtil.getNewNode(parentNode.type, baseTreeNode) as T;\r\n    var node = TreeNodeUtil._deleteFocus(tree);\r\n    node = TreeUtil._insert(node, newNode, to, true);\r\n    return {node, newNode};\r\n  }\r\n\r\n  static addFromCommon = (node: TreeNode, parent: TreeNode, common: Tree, base: TreeNode): TreeNode => {\r\n    const commonAsTreeNode = TreeUtil._get(common, base);\r\n    const pushedNode = TreeUtil._push(node, commonAsTreeNode, parent);\r\n    return TreeNodeUtil._open(pushedNode, parent.id, true);\r\n  }\r\n}","\r\nexport const phrase = {\r\n  empty: {\r\n    task:   '新しい作業',\r\n    switch: '新しい分岐',\r\n    case:   '新しい条件',\r\n  },\r\n  placeholder: {\r\n    task:   '〜をする',\r\n    switch: '〜を確認する',\r\n    case:   '〜である',\r\n  }\r\n};","import * as React from 'react';\r\nimport {\r\n  Theme, createStyles, WithStyles,\r\n  Dialog, DialogTitle, DialogContent, DialogContentText, DialogActions, Button, Modal, withStyles, Portal, Box, Paper, ButtonGroup,\r\n} from '@material-ui/core';\r\n\r\nimport { TreeNode, Manual, KTreeNode, baseKWithArrow } from '../../../data-types/tree';\r\nimport TreeUtil from '../../../func/tree';\r\nimport NodeContainer from './node-container';\r\nimport { EditorFrameActions } from './node-frame-container';\r\nimport ViewSettingsContainer from '../../../components/view-settings/view-settings-container';\r\nimport { NodeEditorProps } from './node-component';\r\nimport { TreePutRequest } from '../../../api/definitions';\r\nimport { RouteComponentProps, withRouter, Prompt } from 'react-router';\r\nimport KTreeUtil from '../../../func/k-tree';\r\nimport { KSState } from '../../../redux/states/ksState';\r\nimport { Undo, Redo } from '@material-ui/icons';\r\nimport TreeNodeUtil from '../../../func/tree-node';\r\nimport { throttle } from 'lodash-es';\r\n\r\nexport const styles = (theme: Theme) => createStyles({\r\n  root: {\r\n    position: 'relative',\r\n  },\r\n  toolArea: {\r\n    position: 'absolute',\r\n    top: theme.spacing(1),\r\n    right: theme.spacing(1),\r\n  },\r\n  convergent: {\r\n    transform: 'scale(1, -1)',\r\n  },\r\n  close: {\r\n    padding: theme.spacing(0.5),\r\n  },\r\n  editFinishButton: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  viewSettingModal: {\r\n    backgroundColor: '#0002',\r\n  },\r\n  viewSettingPaper: {\r\n    position: 'absolute',\r\n    top: '75vh',\r\n    left: '50vw',\r\n    width: '90vw',\r\n    maxHeight: '45vh',\r\n    transform: 'translate(-50%, -50%)',\r\n    padding: theme.spacing(2),\r\n    outline: 'none',\r\n  },\r\n});\r\n\r\ninterface Props extends KSState, EditorFrameActions, RouteComponentProps, WithStyles<typeof styles> {\r\n  manual: Manual;\r\n  node: TreeNode;\r\n  buttonRef: React.RefObject<HTMLDivElement>;\r\n}\r\n\r\ninterface State {\r\n  node: KTreeNode;\r\n  stream: KTreeNode[];\r\n  streamPointer: number;\r\n  cannotSaveReason: CannotSaveReason;\r\n  showVS: boolean;\r\n  saved: boolean;\r\n}\r\n\r\nexport type CannotSaveReason = 'switch' | 'case' | null;\r\n\r\nclass EditorFrameComponent extends React.Component<Props, State> {\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    const { node, ks, location } = props;\r\n    const isEditing = location.pathname.slice(-4) === 'edit';\r\n    const kWith = KTreeUtil.setCalcProps(TreeUtil._get(node, baseKWithArrow), ks, isEditing);\r\n\r\n    this.state = {\r\n      node: kWith,\r\n      stream: [kWith],\r\n      streamPointer: 0,\r\n      cannotSaveReason: null,\r\n      showVS: false,\r\n      saved: false,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.addEventListener('keydown', this.handleKeydown);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('keydown', this.handleKeydown);\r\n  }\r\n\r\n  updateStream = () => {\r\n    const {node, stream, streamPointer} = this.state;\r\n    const isEditing = this.props.location.pathname.slice(-4) === 'edit';\r\n    if (!isEditing) { return; }\r\n\r\n    const dragNode = TreeNodeUtil._getDragNode(node);\r\n    if (dragNode !== undefined) { return; }\r\n\r\n    const current = stream[streamPointer];\r\n    const hasDifference = TreeUtil._hasDifferenceWithAppearance(current, node);\r\n    if (!hasDifference) { return; }\r\n\r\n    const slicedStream = stream.slice(0, streamPointer + 1);\r\n\r\n    const newStream = slicedStream.concat([TreeNodeUtil._deleteFocus(node)])\r\n    console.log('stream.length: ' + newStream.length);\r\n    this.setState({stream: newStream, streamPointer: streamPointer + 1});\r\n  }\r\n\r\n  updateStreamThrottle = throttle(this.updateStream, 3000);\r\n\r\n  handleKeydown = (event: KeyboardEvent) => {\r\n    const {stream, streamPointer} = this.state;\r\n    if (event.ctrlKey || event.metaKey) {\r\n      if (event.key === 'z' && !event.shiftKey && streamPointer !== 0) {\r\n        this.undo();\r\n      }\r\n      if ((event.key === 'y' || (event.key === 'z' && event.shiftKey)) && streamPointer !== (stream.length - 1)) {\r\n        this.redo();\r\n      }\r\n    }\r\n  }\r\n\r\n  edit = (editNode: KTreeNode) => {\r\n    const { ks, location } = this.props;\r\n    const isEditing = location.pathname.slice(-4) === 'edit';\r\n    this.setState({ node: KTreeUtil.setCalcProps(editNode, ks, isEditing) });\r\n    if (this.state.streamPointer === 0) { this.updateStream(); }\r\n    this.updateStreamThrottle();\r\n  }\r\n\r\n  undo = () => {\r\n    const { stream, streamPointer } = this.state;\r\n    const nextPointer = streamPointer - 1;\r\n    this.setState({node: stream[nextPointer], streamPointer: nextPointer});\r\n  }\r\n\r\n  redo = () => {\r\n    const { stream, streamPointer } = this.state;\r\n    const nextPointer = streamPointer + 1;\r\n    this.setState({node: stream[nextPointer], streamPointer: nextPointer});\r\n  }\r\n\r\n  save = () => {\r\n    const { manual, putTree, history } = this.props;\r\n    const { node } = this.state;\r\n    const isAllSwitchHasCase = TreeUtil._isAllSwitchHasCase(node);\r\n    // const isAllCaseHasItem = TreeUtil._isAllCaseHasItem(node);\r\n    const cannotSaveReason: CannotSaveReason = !isAllSwitchHasCase ? 'switch' : null;\r\n    this.setState({ cannotSaveReason });\r\n    if (cannotSaveReason === null) {\r\n      const hasDifference = TreeUtil._hasDifference(this.props.node, this.state.node);\r\n      if (hasDifference) {\r\n        const params: TreePutRequest = { manualId: manual.id, rootTree: node };\r\n        putTree(params);\r\n      }\r\n      this.setState({ saved: true })\r\n      process.nextTick(() => history.push(`/manual/${manual.id}/tree`));\r\n    }\r\n  }\r\n\r\n  handleCancel = () => {\r\n    const { node: propNode, ks, location, history } = this.props;\r\n    const isEditing = location.pathname.slice(-4) === 'edit';\r\n    const node = KTreeUtil.setCalcProps(TreeUtil._get(propNode, baseKWithArrow), ks, isEditing);\r\n    this.setState({node, stream: [node], streamPointer: 0});\r\n    history.goBack();\r\n  }\r\n\r\n  handleShowVS = (showVS: boolean) => () => this.setState({ showVS });\r\n\r\n  render() {\r\n    const { buttonRef, classes, location } = this.props;\r\n    const { node, cannotSaveReason, showVS, saved, stream, streamPointer } = this.state;\r\n    const isEditing = location.pathname.slice(-4) === 'edit';\r\n    const nodeProps: NodeEditorProps = {\r\n      node,\r\n      isEditing,\r\n      edit: this.edit,\r\n    };\r\n\r\n    const hasDifference = TreeUtil._hasDifference(this.props.node, this.state.node);\r\n    return (\r\n      <div className={classes.root}>\r\n        {isEditing && (\r\n          <Portal container={buttonRef.current}>\r\n            <Box display=\"flex\" flexDirection=\"row\" mt={0.7}>\r\n              <Button onClick={this.handleCancel}>キャンセル</Button>\r\n              <Button color=\"primary\" onClick={this.save}>編集完了</Button>\r\n            </Box>\r\n          </Portal>)}\r\n        <Prompt\r\n          when={hasDifference && !saved}\r\n          message=\"編集内容を保存していません。編集を終了して良いですか？\"\r\n        />\r\n\r\n        <NodeContainer {...nodeProps} />\r\n\r\n        {isEditing &&\r\n        <Paper className={classes.toolArea}>\r\n          <ButtonGroup color=\"primary\">\r\n            <Button onClick={this.undo} disabled={streamPointer === 0}><Undo/></Button>\r\n            <Button onClick={this.redo} disabled={streamPointer === (stream.length - 1)}><Redo/></Button>\r\n          </ButtonGroup>\r\n        </Paper>}\r\n\r\n        <Modal\r\n          open={showVS}\r\n          onClose={this.handleShowVS(false)}\r\n          BackdropProps={{ className: classes.viewSettingModal }}\r\n          disableAutoFocus\r\n        >\r\n          <ViewSettingsContainer />\r\n        </Modal>\r\n\r\n        <Dialog open={cannotSaveReason !== null} onClose={() => this.setState({ cannotSaveReason: null })}>\r\n          <DialogTitle>このデータは保存できません</DialogTitle>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              {cannotSaveReason === 'switch' && 'すべての分岐には、１つ以上の条件を設定して下さい。'}\r\n              {cannotSaveReason === 'case' && 'すべての条件には、１つ以上の詳細項目を設定して下さい。'}\r\n            </DialogContentText>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={() => this.setState({ cannotSaveReason: null })} color=\"primary\" autoFocus>OK</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(withStyles(styles)(EditorFrameComponent));","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../redux/store';\r\nimport NodeEditorComponent from './node-component';\r\n\r\nexport interface NodeEditorActions {\r\n  \r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {...appState.ks, ...appState.rs};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {};\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeEditorComponent);","import * as React from 'react';\r\nimport {\r\n  Theme, createStyles, WithStyles,\r\n  Button, IconButton, Menu, MenuItem, ListItemIcon, ListItemText,\r\n  Dialog, DialogTitle, DialogContent, DialogContentText, DialogActions, TextField, Paper, createMuiTheme, MenuList, Typography,\r\n} from '@material-ui/core';\r\nimport { MuiThemeProvider, withStyles } from '@material-ui/core/styles'\r\nimport Add from '@material-ui/icons/Add';\r\nimport AddNext from '@material-ui/icons/Forward';\r\n\r\nimport { Stage, Layer } from 'react-konva';\r\n\r\nimport { Type, KTreeNode, DragRow, Point, baseKTreeNode, baseKWithArrow, KWithArrow, isSwitch, isTask, isCase } from '../../../data-types/tree';\r\nimport { Task, Switch, Case, Delete, More, Less } from '../../../settings/layout';\r\n\r\nimport TreeUtil from '../../../func/tree';\r\nimport TreeNodeUtil from '../../../func/tree-node';\r\nimport KTreeUtil from '../../../func/k-tree';\r\nimport { phrase } from '../../../settings/phrase';\r\nimport KNode from '../../../components/konva/k-node';\r\nimport Util from '../../../func/util';\r\nimport KArrowUtil from '../../../func/k-arrow';\r\nimport { theme, toolbarHeight } from '../../..';\r\nimport KShadow from '../../../components/konva/k-shadow';\r\nimport { KSState } from '../../../redux/states/ksState';\r\nimport { RSState } from '../../../redux/states/rsState';\r\nimport { CheckBox, CheckBoxOutlineBlank, Info } from '@material-ui/icons';\r\nimport InfoContentComponent, { InfoContentProps } from './info-content-component';\r\nimport KStart from '../../../components/konva/k-start';\r\n\r\nconst headerHeight = 96;\r\n\r\nexport const styles = (theme: Theme) => createStyles({\r\n  main: {\r\n    overflow: 'scroll',\r\n    height: `calc(100vh - ${toolbarHeight + headerHeight + theme.spacing(2)}px)`,\r\n    [theme.breakpoints.down('xs')]: {\r\n      height: `calc(100vh - ${toolbarHeight + headerHeight + theme.spacing(4)}px)`,\r\n    },\r\n  },\r\n  toolbar: theme.mixins.toolbar,\r\n\r\n  saveButton: {\r\n    minWidth: 100,\r\n  },\r\n  extendedIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  viewSettingModal: {\r\n    backgroundColor: '#0002',\r\n  },\r\n  img: {\r\n    width: '100%',\r\n    height: 400,\r\n    objectFit: 'contain',\r\n    verticalAlign: 'bottom',\r\n  },\r\n});\r\n\r\nexport interface NodeEditorProps {\r\n  node: KTreeNode;\r\n  isEditing: boolean;\r\n  edit: (node: KTreeNode) => void;\r\n}\r\n\r\ninterface Props extends KSState, RSState, NodeEditorProps, WithStyles<typeof styles> { }\r\n\r\ninterface State {\r\n  didRender: boolean;\r\n  dragParent: KTreeNode | null;\r\n  labelFocus: boolean;\r\n  infoNode: KTreeNode | null;\r\n  typeAnchorEl: any;\r\n  deleteFlag: boolean;\r\n  hasDifference: boolean;\r\n}\r\n\r\nexport const marginBottom = 40;\r\n\r\nclass NodeEditorComponent extends React.Component<Props, State> {\r\n\r\n  mainRef = React.createRef<HTMLDivElement>();\r\n  stageRef = React.createRef<any>();\r\n\r\n  labelRef = React.createRef<any>();\r\n  actionMenuRef = React.createRef<any>();\r\n  nextBrotherButtonRef = React.createRef<any>();\r\n\r\n\r\n  kTree: KTreeNode;\r\n  rows: DragRow[] | null = null;\r\n  dropRow: number = 0;\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    const state = NodeEditorComponent.getInitialState();\r\n    this.state = state;\r\n    const kTree = TreeUtil._get(props.node, baseKTreeNode);\r\n    this.kTree = KTreeUtil.setCalcProps(kTree, props.ks, props.isEditing);\r\n  }\r\n\r\n  static getInitialState = (): State => {\r\n    return {\r\n      didRender: false,\r\n      dragParent: null,\r\n      labelFocus: false,\r\n      infoNode: null,\r\n      typeAnchorEl: null,\r\n      deleteFlag: false,\r\n      hasDifference: false,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    process.nextTick(() => {\r\n      this.resize();\r\n      this.addScrollEventListener();\r\n      this.setState({ didRender: true });\r\n    });\r\n    window.addEventListener('resize', this.resize);\r\n  }\r\n\r\n  addScrollEventListener = () => {\r\n    const scrollContainer = this.mainRef.current;\r\n    if (scrollContainer === null) { throw new Error('Cannot find elements.'); }\r\n    scrollContainer.addEventListener('scroll', this.scroll);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.resize);\r\n    const scrollContainer = this.mainRef.current;\r\n    if (scrollContainer === null) { throw new Error('Cannot find elements.'); }\r\n    scrollContainer.removeEventListener('scroll', this.scroll);\r\n  }\r\n\r\n  resize = () => {\r\n    const mref = this.mainRef.current;\r\n    const stage = this.stageRef.current;\r\n    if (mref === null || stage === null) { throw new Error('Cannot find elements.'); }\r\n    stage.width(mref.offsetWidth - theme.spacing(2));\r\n    stage.height(mref.offsetHeight - theme.spacing(2));\r\n    stage.draw();\r\n    this.setState({ didRender: true });\r\n  }\r\n\r\n  scroll = () => {\r\n    const scrollContainer = this.mainRef.current;\r\n    const stage = this.stageRef.current;\r\n    if (scrollContainer === null || stage === null) { throw new Error('Cannot find elements.'); }\r\n    const dx = scrollContainer.scrollLeft;\r\n    const dy = scrollContainer.scrollTop;\r\n    stage.container().style.transform = 'translate(' + dx + 'px, ' + dy + 'px)';\r\n    stage.x(-dx);\r\n    stage.y(-dy);\r\n    stage.draw();\r\n  }\r\n\r\n  scrollToNew = (result: { node: KTreeNode, newNode: KTreeNode }) => {\r\n    const main = this.mainRef.current;\r\n    const stage = this.stageRef.current;\r\n    if (main === null || stage === null) { throw new Error('Cannot find elements.'); }\r\n\r\n    const { isEditing, ks, edit } = this.props;\r\n    var kTree = TreeUtil._get(result.node, baseKTreeNode);\r\n    kTree = KTreeUtil.setCalcProps(kTree, ks, isEditing);\r\n    const focusNode = TreeUtil._find(kTree, result.newNode.id)!;\r\n    setTimeout(() => {\r\n      edit(TreeNodeUtil._focus(kTree, result.newNode.id));\r\n      this.setState({ labelFocus: true });\r\n      process.nextTick(() => this.labelRef.current!.focus());\r\n    }, 300);\r\n\r\n    if (main.scrollTop + main.offsetHeight < (focusNode.point.y + ks.rect.h) * ks.unit) {\r\n      const largeContainerHeight = (kTree.self.h + ks.spr.h * 2) * ks.unit + marginBottom;\r\n      const maxScroll = largeContainerHeight - main.offsetHeight;\r\n\r\n      const dx = main.scrollLeft;\r\n      const dy = Math.min((focusNode.point.y + ks.rect.h * 2 + ks.margin.h) * ks.unit - main.offsetHeight, maxScroll);\r\n\r\n      const onFinish = () => {\r\n        main.scrollTop = dy;\r\n        stage.container().style.transform = 'translate(' + dx + 'px, ' + dy + 'px)';\r\n        edit(TreeNodeUtil._focus(kTree, result.newNode.id));\r\n      };\r\n\r\n      stage.to({ x: -dx, y: -dy, duration: 0.5, onFinish });\r\n    }\r\n  }\r\n\r\n  expand = (target: KWithArrow) => {\r\n    const { node, edit } = this.props;\r\n    var newNode = TreeNodeUtil._open(node, target.id, !target.open);\r\n    edit(newNode);\r\n    process.nextTick(() => this.resize());\r\n  }\r\n\r\n  changeDraft = () => {\r\n    const { node, edit } = this.props;\r\n    const focusNode = TreeNodeUtil._getFocusNode(node)!;\r\n    var newNode = TreeNodeUtil._changeDraft(node, focusNode.id, !focusNode.isDraft);\r\n    edit(newNode);\r\n    process.nextTick(() => this.resize());\r\n  }\r\n\r\n  openInfo = (target: KWithArrow) => {\r\n    this.setState({ infoNode: target });\r\n  }\r\n\r\n  focus = (target: KTreeNode) => {\r\n    const { node, rs, edit, isEditing } = this.props;\r\n    if (!target.focus && rs.playOnClick) {\r\n      const ssu = new SpeechSynthesisUtterance();\r\n      ssu.text = !Util.isEmpty(target.label) ? target.label :\r\n        isTask(target.type) ? phrase.empty.task :\r\n          isSwitch(target.type) ? phrase.empty.switch : phrase.empty.case;\r\n      ssu.lang = 'ja-JP';\r\n      ssu.rate = rs.rate;\r\n      ssu.pitch = rs.pitch;\r\n      speechSynthesis.cancel();\r\n      speechSynthesis.speak(ssu);\r\n    }\r\n\r\n    if (!target.focus || !isEditing) {\r\n      const newNode = TreeNodeUtil._focus(node, target.id);\r\n      edit(newNode);\r\n      this.setState({ labelFocus: false });\r\n      process.nextTick(() => this.resize());\r\n    } else {\r\n      if (target.depth.top !== 0) {\r\n        this.setState({ labelFocus: true });\r\n        process.nextTick(() => this.labelRef.current!.focus());\r\n      }\r\n    }\r\n  }\r\n\r\n  deleteFocus = () => {\r\n    const { node, edit } = this.props;\r\n    edit(TreeNodeUtil._deleteFocus(node));\r\n    this.setState({ labelFocus: false });\r\n    process.nextTick(this.resize);\r\n  }\r\n\r\n  dragStart = (target: KTreeNode) => {\r\n    const { node, edit } = this.props;\r\n    const dragParent = TreeUtil._getPrent(node, target);\r\n    var newNode = TreeNodeUtil._open(node, target.id, false);\r\n    newNode = TreeNodeUtil._drag(newNode, target.id, true);\r\n    newNode = TreeNodeUtil._deleteFocus(newNode);\r\n    edit(newNode);\r\n    this.setState({ dragParent, labelFocus: false });\r\n  }\r\n\r\n  dragMove = (target: KTreeNode, p: Point) => {\r\n    const { node: tree, isEditing, ks, edit } = this.props;\r\n    const { dragParent } = this.state;\r\n    const pointX = Math.round(p.x / ks.unit + ks.rect.w / 2);\r\n    const pointY = Math.round(p.y / ks.unit + ks.rect.h / 2);\r\n\r\n    const rows = this.rows;\r\n    const node = KTreeUtil.setCalcProps(TreeUtil._get(tree, baseKWithArrow), ks, isEditing);\r\n\r\n    if (rows !== null && 0 <= pointX && pointX < node.self.w) {\r\n      const row = rows[pointY];\r\n      if (row === undefined || row.node.id === target.id) { return; }\r\n      const closeTarget: KTreeNode = { ...target, open: false };\r\n      if (isCase(target.type)) {\r\n        if (row.action === 'moveToBrother' && dragParent!.children.find(c => c.id === row.node.id) !== undefined) {\r\n          const newNode = TreeUtil.moveBrother(node, closeTarget, row.node);\r\n          edit(TreeNodeUtil._drag(newNode, target.id, true));\r\n          process.nextTick(this.resize);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (row.action === 'moveToBrother' && !isCase(row.node.type)) {\r\n        const newNode = TreeUtil.moveBrother(node, closeTarget, row.node);\r\n        edit(TreeNodeUtil._drag(newNode, target.id, true));\r\n        process.nextTick(this.resize);\r\n      }\r\n\r\n      if (row.action === 'moveInOut') {\r\n        const out = TreeUtil._find(row.node, target.id) === undefined;\r\n        if (isTask(row.node.type) || (out && isCase(row.node.type)) || (!out && isSwitch(row.node.type))) {\r\n          const newNode = TreeUtil.moveInOut(node, closeTarget, row.node);\r\n          edit(TreeNodeUtil._drag(newNode, target.id, true));\r\n        }\r\n        process.nextTick(this.resize);\r\n      }\r\n    }\r\n  }\r\n\r\n  getCurrentTree = (): KTreeNode => {\r\n    return this.kTree;\r\n  }\r\n\r\n  dragEnd = () => {\r\n    const { node, edit } = this.props;\r\n    var newNode = TreeNodeUtil._dragEnd(node);\r\n    edit(newNode);\r\n    this.setState({ dragParent: null });\r\n  }\r\n\r\n  changeFocusNode = (target: KTreeNode) => {\r\n    const { node, edit } = this.props;\r\n    const { infoNode } = this.state;\r\n    edit(TreeUtil._replace(node, target));\r\n    if (infoNode !== null) { this.setState({ infoNode: target }); }\r\n  }\r\n\r\n  changeType = (type: Type) => {\r\n    const { node: tree } = this.props;\r\n    this.setState({ typeAnchorEl: null });\r\n\r\n    const node = TreeNodeUtil._getFocusNode(tree)!;\r\n    if (node.type === type) { return; }\r\n\r\n    if (node.children.length === 0) {\r\n      const newNode = { ...node, type };\r\n      this.changeFocusNode(newNode);\r\n    }\r\n\r\n    if (isTask(type)) {\r\n      const children = node.children.map(c => c.children).reduce((a, b) => a.concat(b));\r\n      const newNode = { ...node, type, children, open: true };\r\n      this.changeFocusNode(newNode);\r\n    } else {\r\n      const newCase = TreeUtil.getNewNode(Type.switch, baseKWithArrow);\r\n      const children = [\r\n        {\r\n          ...newCase,\r\n          open: true,\r\n          children: node.children.length === 0\r\n            ? [{ ...baseKWithArrow, id: 'rand:' + String(Math.random()).slice(2) }]\r\n            : node.children\r\n        }\r\n      ];\r\n      const newNode = { ...node, type, children, open: true };\r\n      this.changeFocusNode(newNode);\r\n    }\r\n  };\r\n\r\n  addDetails = () => {\r\n    const { node, edit } = this.props;\r\n    const focusNode = TreeNodeUtil._getFocusNode(node)!;\r\n    const addDetailsNode = TreeNodeUtil.addDetails(node, focusNode);\r\n    edit(addDetailsNode);\r\n    process.nextTick(this.resize);\r\n  }\r\n\r\n  addNextBrother = () => {\r\n    const { node, edit } = this.props;\r\n    const focusNode = TreeNodeUtil._getFocusNode(node)!;\r\n    const addNextBrotherResult = TreeNodeUtil.addNextBrother(node, focusNode);\r\n    edit(addNextBrotherResult.node);\r\n    process.nextTick(() => { this.resize(); this.scrollToNew(addNextBrotherResult) });\r\n  }\r\n\r\n  deleteSelf = () => {\r\n    const { node, edit } = this.props;\r\n    const focusNode = TreeNodeUtil._getFocusNode(node)!;\r\n    edit(TreeUtil._deleteById(node, focusNode.id));\r\n    this.setState({ deleteFlag: false });\r\n    process.nextTick(this.resize);\r\n  }\r\n\r\n  render() {\r\n    const { node: tree, isEditing, ks, classes } = this.props;\r\n    const {\r\n      labelFocus, typeAnchorEl, infoNode, deleteFlag, dragParent,\r\n    } = this.state;\r\n    const node = KArrowUtil.setArrow(TreeUtil._get(tree, baseKWithArrow), ks);\r\n    this.kTree = node;\r\n    const flatNodes = TreeNodeUtil.toArrayWithoutClose(node);\r\n    const rows = KTreeUtil.makeDragMap(flatNodes, ks);\r\n    this.rows = rows;\r\n\r\n    const stage = this.stageRef.current;\r\n    const nodeActionProps = {\r\n      isEditing,\r\n      ks,\r\n      focus: this.focus,\r\n      expand: this.expand,\r\n      dragStart: this.dragStart,\r\n      dragMove: this.dragMove,\r\n      getCurrentTree: this.getCurrentTree,\r\n      dragEnd: this.dragEnd,\r\n      openInfo: this.openInfo,\r\n      deleteFocus: this.deleteFocus,\r\n      stageRef: this.stageRef,\r\n    };\r\n\r\n    var ActionButtonBox: JSX.Element | undefined = undefined;\r\n    var ImageBox: JSX.Element | undefined = undefined;\r\n    var TypeButton: JSX.Element | undefined = undefined;\r\n    var Label: JSX.Element | undefined = undefined;\r\n\r\n    const focusNode = TreeNodeUtil._getFocusNode(node);\r\n    if (focusNode) {\r\n\r\n      if (!labelFocus && typeAnchorEl === null) {\r\n        const isRoot = focusNode.depth.top === 0;\r\n        const menu = this.actionMenuRef.current;\r\n        const boxStyle: React.CSSProperties = {\r\n          position: 'absolute',\r\n          left: (focusNode!.point.x + ks!.rect.w) * ks.unit - 6 - (menu !== null ? menu.offsetWidth : 0),\r\n          top: (focusNode!.point.y + ks.rect.h) * ks.unit - 4,\r\n          backgroundColor: theme.palette.grey[800],\r\n        };\r\n        ActionButtonBox = (\r\n          <MuiThemeProvider theme={createMuiTheme({ palette: { type: 'dark' } })}>\r\n            <Paper ref={this.actionMenuRef} style={boxStyle}>\r\n              <MenuList>\r\n                <MenuItem onClick={() => this.openInfo(focusNode)}>\r\n                  <ListItemIcon>\r\n                    <Info />\r\n                  </ListItemIcon>\r\n                  <Typography color=\"textPrimary\">詳細表示</Typography>\r\n                </MenuItem>\r\n\r\n                {(isEditing || focusNode.children.length !== 0) && focusNode.depth.top !== 0 &&\r\n                  <MenuItem onClick={() => this.expand(focusNode)}>\r\n                    <ListItemIcon>\r\n                      {!focusNode.open ? <More /> : <Less />}\r\n                    </ListItemIcon>\r\n                    <Typography color=\"textPrimary\">{!focusNode.open ? '詳細項目を開く' : '詳細項目を閉じる'}</Typography>\r\n                  </MenuItem>}\r\n\r\n                {isEditing && <>\r\n                  {!isRoot &&\r\n                    <MenuItem ref={this.nextBrotherButtonRef} onClick={this.addNextBrother}>\r\n                      <ListItemIcon>\r\n                        <>\r\n                          <AddNext style={{ transform: 'rotate(90deg)' }} />\r\n                          <Add />\r\n                        </>\r\n                      </ListItemIcon>\r\n                      <Typography color=\"textPrimary\">次の項目を追加</Typography>\r\n                    </MenuItem>}\r\n\r\n                  <MenuItem onClick={this.addDetails}>\r\n                    <ListItemIcon>\r\n                      <>\r\n                        <AddNext />\r\n                        <Add />\r\n                      </>\r\n                    </ListItemIcon>\r\n                    <Typography color=\"textPrimary\">詳細項目を追加</Typography>\r\n                  </MenuItem>\r\n\r\n                  {false &&\r\n                    <MenuItem onClick={this.changeDraft}>\r\n                      <ListItemIcon>\r\n                        {focusNode!.isDraft ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n                      </ListItemIcon>\r\n                      <Typography color=\"textPrimary\">下書き</Typography>\r\n                    </MenuItem>}\r\n\r\n                  {!isRoot &&\r\n                    <MenuItem onClick={() => this.setState({ deleteFlag: true })}>\r\n                      <ListItemIcon>\r\n                        <Delete />\r\n                      </ListItemIcon>\r\n                      <Typography color=\"textPrimary\">削除</Typography>\r\n                    </MenuItem>}\r\n                </>}\r\n              </MenuList>\r\n            </Paper>\r\n          </MuiThemeProvider>\r\n        );\r\n      }\r\n\r\n      if (!labelFocus && typeAnchorEl === null && focusNode.imageBlob.length !== 0) {\r\n        const boxStyle: React.CSSProperties = {\r\n          position: 'absolute',\r\n          left: (focusNode!.point.x + ks.rect.w) * ks.unit,\r\n          top: (focusNode!.point.y) * ks.unit,\r\n          width: '400px',\r\n          height: '400px',\r\n        };\r\n        ImageBox = (\r\n          <div style={boxStyle}>\r\n            <img src={focusNode.imageBlob} className={classes.img} alt={focusNode.imageName} />\r\n          </div>\r\n        );\r\n      }\r\n\r\n      if (focusNode.depth.top !== 0 && isEditing) {\r\n        const buttonStyle: React.CSSProperties = {\r\n          position: 'absolute',\r\n          left: (focusNode!.point.x + ks.rect.h / 2) * ks.unit,\r\n          top: (focusNode!.point.y + ks.rect.h / 2) * ks.unit,\r\n          transform: `translate(-50%, -50%) scale(${ks.unit / 24})`,\r\n          color: '#000',\r\n        };\r\n        TypeButton = (\r\n          <div>\r\n            <IconButton\r\n              style={buttonStyle}\r\n              onClick={e => this.setState({ typeAnchorEl: e.currentTarget })}\r\n              disableRipple\r\n              disabled={focusNode.depth.top === 0}\r\n            >\r\n              {isTask(focusNode.type) ? <Task /> : isSwitch(focusNode.type) ? <Switch style={{ transform: 'scale(1, -1)' }} /> : <Case />}\r\n            </IconButton>\r\n            <Menu\r\n              anchorEl={typeAnchorEl}\r\n              open={Boolean(typeAnchorEl)}\r\n              onClose={() => {\r\n                this.deleteFocus();\r\n                this.setState({ typeAnchorEl: null });\r\n              }}\r\n            >\r\n              {!isCase(focusNode.type) &&\r\n                <MenuItem onClick={() => this.changeType(Type.task)}>\r\n                  <ListItemIcon><Task /></ListItemIcon>\r\n                  <ListItemText inset primary=\"作業\" />\r\n                </MenuItem>}\r\n              {!isCase(focusNode.type) &&\r\n                <MenuItem onClick={() => this.changeType(Type.switch)}>\r\n                  <ListItemIcon><Switch style={{ transform: 'scale(1, -1)' }} /></ListItemIcon>\r\n                  <ListItemText inset primary=\"分岐\" />\r\n                </MenuItem>}\r\n              {isCase(focusNode.type) &&\r\n                <MenuItem onClick={() => this.changeType(Type.case)}>\r\n                  <ListItemIcon><Case /></ListItemIcon>\r\n                  <ListItemText inset primary=\"条件\" />\r\n                </MenuItem>}\r\n            </Menu>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      (() => {\r\n        const labelStyle: React.CSSProperties = {\r\n          position: 'absolute',\r\n          left: (focusNode!.point.x + ks.rect.h + ks.spr.w / 2) * ks.unit,\r\n          top: (focusNode!.point.y + ks.rect.h / 2) * ks.unit,\r\n          width: (ks.rect.w - (ks.rect.h * 3 + ks.spr.w)) * ks.unit,\r\n          transform: `translateY(-50%)`,\r\n          display: labelFocus ? undefined : 'none',\r\n        };\r\n        const fontSize: React.CSSProperties = {\r\n          fontSize: 18.2 / 20 * ks.unit\r\n        };\r\n        Label = (\r\n          <TextField\r\n            inputRef={this.labelRef}\r\n            style={labelStyle}\r\n            variant=\"standard\"\r\n            InputProps={{ style: fontSize }}\r\n            placeholder={\r\n              isTask(focusNode.type) ? phrase.placeholder.task :\r\n                isSwitch(focusNode.type) ? phrase.placeholder.switch : phrase.placeholder.case\r\n            }\r\n            InputLabelProps={{ shrink: true }}\r\n            value={focusNode.label}\r\n            onChange={(e: any) => this.changeFocusNode({ ...focusNode!, label: e.target.value })}\r\n            onKeyDown={e => {\r\n              if (e.keyCode === 13) {\r\n                this.labelRef.current!.blur();\r\n                this.setState({ labelFocus: false });\r\n                process.nextTick(() => this.nextBrotherButtonRef.current!.focus());\r\n              }\r\n            }}\r\n          />\r\n        );\r\n      })();\r\n    }\r\n\r\n    const main = this.mainRef.current;\r\n    const largeContainerStyle: React.CSSProperties | undefined = main !== null ?\r\n      {\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n        width: Math.max((node.self.w + ks.spr.w * 2) * ks.unit, main.offsetWidth),\r\n        height: Math.max((node.self.h + ks.spr.h * 2) * ks.unit + marginBottom, main.offsetHeight),\r\n      } : undefined;\r\n\r\n    const infoContentProps: InfoContentProps = {\r\n      node: infoNode!,\r\n      isEditing,\r\n      changeNode: this.changeFocusNode,\r\n    };\r\n\r\n    return (\r\n      <div className={classes.main} ref={this.mainRef}>\r\n        <div style={largeContainerStyle}>\r\n          <Stage ref={this.stageRef} onClick={this.deleteFocus}>\r\n            <Layer>\r\n              {stage !== null &&\r\n                flatNodes\r\n                  .filter(n => isEditing || !n.isDraft)\r\n                  .map(n => {\r\n                    return n.depth.top === 0\r\n                      ? <KStart key={n.id} node={n} nowDragging={dragParent !== null} {...nodeActionProps} />\r\n                      : <KShadow key={n.id + 'shadow'} node={n} labelFocus={labelFocus} {...nodeActionProps} />\r\n                  })}\r\n\r\n              {stage !== null &&\r\n                flatNodes\r\n                  .filter(n => isEditing ? (dragParent === null ? true : n.isDragging) : !n.isDraft)\r\n                  .map(n => {\r\n                    return n.depth.top === 0\r\n                      ? <KStart key={n.id} node={n} nowDragging={dragParent !== null} {...nodeActionProps} />\r\n                      : <KNode key={n.id} node={n} labelFocus={labelFocus} {...nodeActionProps} />\r\n                  })}\r\n              {/* <DragMap node={node} rows={rows} ks={ks} /> */}\r\n              {/* <DropMap node={node} flatNodes={flatNodes} ks={ks}/> */}\r\n\r\n            </Layer>\r\n          </Stage>\r\n          {ActionButtonBox}\r\n          {ImageBox}\r\n          {Label}\r\n          {TypeButton}\r\n        </div>\r\n\r\n        <Dialog open={deleteFlag} onClose={() => this.setState({ deleteFlag: false })}>\r\n          <DialogTitle>この項目を削除してもよろしいですか？</DialogTitle>\r\n          {focusNode !== undefined && focusNode.children.length !== 0 &&\r\n            <DialogContent>\r\n              <DialogContentText>この項目には詳細項目が含まれています。削除してもよろしいですか？</DialogContentText>\r\n            </DialogContent>}\r\n\r\n          <DialogActions>\r\n            <Button onClick={() => this.setState({ deleteFlag: false })}>キャンセル</Button>\r\n            <Button onClick={this.deleteSelf} color=\"primary\" autoFocus>削除</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n        <Dialog open={infoNode !== null} onClose={() => this.setState({ infoNode: null })} maxWidth=\"sm\" fullWidth>\r\n          {infoNode !== null && (\r\n            <>\r\n              <DialogTitle>{infoNode!.label}</DialogTitle>\r\n\r\n              <DialogContent>\r\n                <InfoContentComponent {...infoContentProps} />\r\n              </DialogContent>\r\n\r\n              <DialogActions>\r\n                <Button color=\"primary\" onClick={() => this.setState({ infoNode: null })}>OK</Button>\r\n              </DialogActions>\r\n            </>)}\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(NodeEditorComponent);","import React, { useRef, memo } from 'react';\r\nimport { lightBlue, amber, yellow, grey } from '@material-ui/core/colors';\r\nimport Konva from 'konva';\r\nimport { Rect, Group, Text } from 'react-konva';\r\nimport { task, switchSvg } from '../../resource/svg-icon';\r\n\r\nimport { KWithArrow, KTreeNode, Point, isTask, isSwitch } from '../../data-types/tree';\r\n\r\nimport Util from '../../func/util';\r\nimport { phrase } from '../../settings/phrase';\r\nimport IconWithBadge, { IconWithBadgeProps } from './icon-with-badge';\r\nimport KSize from '../../data-types/k-size';\r\nimport check from '../../resource/svg-icon/check';\r\nimport Icon, { IconProps } from './icon';\r\nimport TreeUtil from '../../func/tree';\r\nimport moreVert from '../../resource/svg-icon/more/more-vert';\r\n\r\nexport interface KNodeProps {\r\n  node: KWithArrow;\r\n  isEditing: boolean;\r\n  labelFocus: boolean;\r\n  ks: KSize;\r\n  focus: (node: KWithArrow) => void;\r\n  expand: (node: KWithArrow) => void;\r\n  dragStart: (node: KTreeNode) => void;\r\n  dragMove: (node: KTreeNode, point: Point) => void;\r\n  getCurrentTree: () => KTreeNode;\r\n  dragEnd: () => void;\r\n  openInfo: (node: KWithArrow) => void;\r\n  stageRef: React.RefObject<any>;\r\n}\r\n\r\nconst KNode: React.FC<KNodeProps> = memo(props => {\r\n\r\n  const { node, ks, stageRef } = props;\r\n\r\n  const baseRef = useRef<any>(null);\r\n  const draggableRef = useRef<any>(null);\r\n  const rectRef = useRef<any>(null);\r\n\r\n  const onMouseEnterBaseRect = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'grab';\r\n    }\r\n  }\r\n\r\n  const onMouseLeaveBaseRect = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'default';\r\n    }\r\n  }\r\n\r\n  const handleFocus = (e: any) => {\r\n    e.cancelBubble = true;\r\n    props.focus(node);\r\n  }\r\n\r\n  const onMouseEnterText = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      const isFocus = node.focus;\r\n      stage.container().style.cursor = isFocus ? 'text' : 'grab';\r\n    }\r\n  }\r\n\r\n  const onMouseLeaveText = (e: any) => {\r\n    e.cancelBubble = true;\r\n    if (!props.isEditing) { return; }\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'default';\r\n    }\r\n  }\r\n\r\n  // const handleInfoOpen= (e: any) => {\r\n  //   e.cancelBubble = true;\r\n  //   props.openInfo(node);\r\n  // }\r\n\r\n  // const handleExpand = (e: any) => {\r\n  //   e.cancelBubble = true;\r\n  //   props.expand(node);\r\n  // }\r\n\r\n  const onMouseEnterButton = (e: any) => {\r\n    e.cancelBubble = true;\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'pointer';\r\n    }\r\n  }\r\n\r\n  const onMouseLeaveButton = (e: any) => {\r\n    e.cancelBubble = true;\r\n    const stage = stageRef.current;\r\n    if (stage !== null) {\r\n      stage.container().style.cursor = 'default';\r\n    }\r\n  }\r\n\r\n  const handleDragStart = () => {\r\n    if (!props.isEditing) { return; }\r\n    rectRef.current!.to({\r\n      strokeWidth: 0,\r\n      shadowColor: 'black',\r\n      shadowBlur: 10,\r\n      shadowOffsetY: 6,\r\n      shadowOpacity: 0.3,\r\n      duration: 0.1\r\n    });\r\n    draggableRef.current.to({\r\n      scaleX: 1.1,\r\n      scaleY: 1.1,\r\n      x: -node.rect.w * ks.unit * 0.05,\r\n      duration: 0.1\r\n    });\r\n    stageRef.current!.container().style.cursor = 'grabbing';\r\n    props.dragStart(node);\r\n  }\r\n\r\n  const handleDragMove = (e: any) => {\r\n    if (!props.isEditing) { return; }\r\n    const dragPoint = e.target.position();\r\n    e.target.x(-node.rect.w * ks.unit * 0.05 + dragPoint.x);\r\n    e.target.y(-node.rect.h * ks.unit * 0.05 + dragPoint.y);\r\n    \r\n    props.dragMove({...node, focus: false}, {\r\n      x: node.point.x * ks.unit + dragPoint.x,\r\n      y: node.point.y * ks.unit + dragPoint.y\r\n    });\r\n  }\r\n\r\n  const handleDragEnd = () => {\r\n    if (!props.isEditing) { return; }\r\n    stageRef.current!.container().style.cursor = 'default';\r\n    draggableRef.current.to({\r\n      x: 0,\r\n      y: 0,\r\n      scaleX: 1,\r\n      scaleY: 1,\r\n      easing: Konva.Easings.EaseInOut,\r\n      onFinish: props.dragEnd\r\n    });\r\n    const currentTree = props.getCurrentTree();\r\n    const ct = TreeUtil._find(currentTree, node.id)!;\r\n    baseRef.current!.to({\r\n      x: ct.point.x * ks.unit,\r\n      y: ct.point.y * ks.unit,\r\n      easing: Konva.Easings.EaseInOut\r\n    });\r\n  }\r\n\r\n  const fill = node.isDraft ? grey[50] :\r\n    isTask(node.type) ? lightBlue[50] :\r\n    isSwitch(node.type) ? amber[100] : yellow[100];\r\n\r\n  const baseRectProps = {\r\n    x: 0, y: 0,\r\n    width: node.rect.w * ks.unit,\r\n    height: node.rect.h * ks.unit,\r\n    cornerRadius: 4,\r\n    fill,\r\n    onMouseEnter: onMouseEnterBaseRect,\r\n    onMouseLeave: onMouseLeaveBaseRect,\r\n  };\r\n\r\n  const rectProps = node.focus ? {\r\n    ...baseRectProps,\r\n    stroke: '#80bdff',\r\n    shadowColor: '#80bdff',\r\n    strokeWidth: 6,\r\n    shadowBlur: 6,\r\n    shadowOffsetY: 0,\r\n    shadowOpacity: 1,\r\n  } : baseRectProps;\r\n\r\n  const labelProps = {\r\n    text: Util.isEmpty(node.label)\r\n      ? isTask(node.type) ? phrase.empty.task : isSwitch(node.type) ? phrase.empty.switch : phrase.empty.case\r\n      : node.label,\r\n    fontSize: ks.fontSize * ks.unit,\r\n    x: (ks.rect.h + ks.fontSize / 2) * ks.unit,\r\n    y: (ks.rect.h - ks.fontHeight) / 2 * ks.unit,\r\n    onMouseEnter: onMouseEnterText,\r\n    onMouseLeave: onMouseLeaveText,\r\n  };\r\n\r\n  const typeProps: IconProps = {\r\n    ks,\r\n    x: 0, y: 0,\r\n    svg: isTask(node.type) ? task : isSwitch(node.type) ? switchSvg : check,\r\n    scale: isSwitch(node.type) ? { x: 1, y: -1 } : undefined,\r\n  };\r\n\r\n  // onTouchStart?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n  // onTouchMove?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n  // onTouchEnd?(evt: Konva.KonvaEventObject<TouchEvent>): void;\r\n\r\n  const rectGroupProps = {\r\n    x: 0, y: 0,\r\n    ref: draggableRef,\r\n    onClick: handleFocus,\r\n    onTap: handleFocus,\r\n    draggable: props.isEditing,\r\n    onDragStart: handleDragStart,\r\n    onTouchStart: handleDragStart,\r\n    onDragMove: handleDragMove,\r\n    onTouchMove: handleDragMove,\r\n    onDragEnd: handleDragEnd,\r\n    onTouchEnd: handleDragEnd,\r\n  };\r\n\r\n  const baseEl = baseRef.current;\r\n  const draggableEl = draggableRef.current;\r\n  // dragElが要素の参照を持っていてもなぜか座標を持っていない場合があるため x の値をチェック\r\n  const willAnimation = baseEl !== null && draggableEl !== null &&\r\n    (baseEl.x() !== 0 && !draggableEl.isDragging());\r\n  if (willAnimation) {\r\n    baseEl.to({\r\n      x: node.point.x * ks.unit,\r\n      y: node.point.y * ks.unit,\r\n      easing: Konva.Easings.EaseInOut\r\n    });\r\n  }\r\n\r\n  const x = !willAnimation ? node.point.x * ks.unit : undefined;\r\n  const y = !willAnimation ? node.point.y * ks.unit : undefined;\r\n\r\n  const moreProps: IconWithBadgeProps = {\r\n    ks,\r\n    x: (ks.rect.w - ks.rect.h) * ks.unit, y: 0,\r\n    svg: moreVert,\r\n    badgeContent: node.children.length,\r\n    onClick: handleFocus,\r\n    onTap: handleFocus,\r\n    onMouseEnter: onMouseEnterButton,\r\n    onMouseLeave: onMouseLeaveButton,\r\n  };\r\n\r\n  return (\r\n    <Group ref={baseRef} x={x} y={y} >\r\n      <Group {...rectGroupProps}>\r\n        <Rect ref={rectRef} {...rectProps} />\r\n        <Icon {...typeProps} />\r\n        {!(node.focus && props.labelFocus) && <Text {...labelProps} />}  \r\n        <IconWithBadge {...moreProps} />\r\n      </Group>\r\n    </Group>\r\n  );\r\n}, (prev, next) => {\r\n  return !prev.node.isDragging && next.node.isDragging;\r\n});\r\n\r\nexport default KNode;","import * as React from 'react';\r\nimport { lightBlue, amber, yellow, grey } from '@material-ui/core/colors';\r\nimport Konva from 'konva';\r\nimport { Rect, Group, Text, Arrow } from 'react-konva';\r\nimport { task, switchSvg, flag } from '../../resource/svg-icon';\r\n\r\nimport { KWithArrow, isSwitch, isTask } from '../../data-types/tree';\r\n\r\nimport { theme } from '../..';\r\nimport Util from '../../func/util';\r\nimport { phrase } from '../../settings/phrase';\r\nimport IconWithBadge, { IconWithBadgeProps } from './icon-with-badge';\r\nimport KSize from '../../data-types/k-size';\r\nimport check from '../../resource/svg-icon/check';\r\nimport Icon, { IconProps } from './icon';\r\nimport moreVert from '../../resource/svg-icon/more/more-vert';\r\n\r\nexport interface KNodeProps {\r\n  node: KWithArrow;\r\n  isEditing: boolean;\r\n  labelFocus: boolean;\r\n  ks: KSize;\r\n  deleteFocus: () => void;\r\n}\r\n\r\nclass KShadow extends React.Component<KNodeProps> {\r\n\r\n  groupRef = React.createRef<any>();\r\n\r\n  componentWillUnmount() {\r\n    this.groupRef.current!.destroy();\r\n  }\r\n\r\n  handleDeleteFocus = (e: any) => {\r\n    e.cancelBubble = true;\r\n    this.props.deleteFocus();\r\n  }\r\n\r\n  render() {\r\n    const { node, ks, labelFocus } = this.props;\r\n    const fill = node.isDraft ? grey[50] :\r\n      isTask(node.type) ? lightBlue[50] :\r\n      isSwitch(node.type) ? amber[100] : yellow[100];\r\n    const baseRectProps = {\r\n      x: 0, y: 0,\r\n      width: node.rect.w * ks.unit,\r\n      height: node.rect.h * ks.unit,\r\n      cornerRadius: 4,\r\n      fill,\r\n      stroke: node.focus ? '#80bdff' : '#0000',\r\n      strokeWidth: 6,\r\n      shadowColor: node.focus ? '#80bdff' : 'black',\r\n      shadowBlur: 6,\r\n      shadowOffsetY: node.focus ? 0 : 3,\r\n      shadowOpacity: node.focus ? 1 : 0.2,\r\n    };\r\n\r\n    const labelProps = {\r\n      text: Util.isEmpty(node.label)\r\n        ? isTask(node.type) ? phrase.empty.task : isSwitch(node.type) ? phrase.empty.switch : phrase.empty.case\r\n        : node.label,\r\n      fontSize: ks.fontSize * ks.unit,\r\n      x: (ks.rect.h + ks.fontSize / 2) * ks.unit,\r\n      y: (ks.rect.h - ks.fontHeight) / 2 * ks.unit,\r\n    };\r\n\r\n    const typeProps: IconProps = {\r\n      ks,\r\n      x: 0, y: 0,\r\n      svg: isTask(node.type) ? task : isSwitch(node.type) ? switchSvg : check,\r\n      scale: isSwitch(node.type) ? { x: 1, y: -1 } : undefined,\r\n    };\r\n\r\n    const dragEl = this.groupRef.current;\r\n    // dragElが要素の参照を持っていてもなぜか座標を持っていない場合があるため x の値をチェック\r\n    const willAnimation = dragEl !== null && dragEl.x() !== 0;\r\n\r\n    if (willAnimation) {\r\n      dragEl.to({\r\n        x: node.point.x * ks.unit,\r\n        y: node.point.y * ks.unit,\r\n        easing: Konva.Easings.EaseInOut\r\n      });\r\n    }\r\n\r\n    const rectGroupProps = {\r\n      x: !willAnimation ? node.point.x * ks.unit : undefined,\r\n      y: !willAnimation ? node.point.y * ks.unit : undefined,\r\n    };\r\n\r\n    const containerRectProps = {\r\n      x: (ks.indent / 2 - ks.spr.w) * ks.unit,\r\n      y: ks.spr.h * ks.unit,\r\n      width: (node.self.w - (ks.indent / 2 - ks.spr.w)) * ks.unit,\r\n      height: (node.self.h - ks.spr.h) * ks.unit,\r\n      cornerRadius: ks.cornerRadius * ks.unit,\r\n      stroke: grey[500],\r\n      fill: '#00000009',\r\n      strokeWidth: ks.hasArrow ? 0 : 1,\r\n      onClick: this.handleDeleteFocus\r\n    };\r\n\r\n    const arrowBaseProps = {\r\n      stroke: grey[700],\r\n      fill: grey[700],\r\n      pointerLength: ks.pointerLength * ks.unit,\r\n      pointerWidth: ks.pointerWidth * ks.unit,\r\n    }\r\n    const endIconProps: IconProps = {\r\n      ks,\r\n      x: -ks.rect.h * ks.unit, y: 0,\r\n      svg: flag,\r\n      color: theme.palette.secondary.main,\r\n    };\r\n\r\n    const moreProps: IconWithBadgeProps = {\r\n      ks,\r\n      x: (ks.rect.w - ks.rect.h) * ks.unit, y: 0,\r\n      svg: moreVert,\r\n      badgeContent: node.children.length,\r\n    };\r\n\r\n    return (\r\n      <Group ref={this.groupRef} {...rectGroupProps}>\r\n        {!node.isDragging && (\r\n          <>\r\n            {node.open && <Rect {...containerRectProps} />}\r\n            <Rect {...baseRectProps} />\r\n            <Icon {...typeProps} />\r\n            {!(node.focus && labelFocus) && <Text {...labelProps} />}\r\n            <IconWithBadge {...moreProps} />\r\n            {ks.hasArrow && node.arrows.map((a, i) => {\r\n              const points = a.map(point => [point.x, point.y]).reduce((before, next) => before.concat(next)).map(p => p * ks.unit);\r\n              return <Arrow key={`${node.id}-arrow-${i}`} {...arrowBaseProps} points={points} />;\r\n            })}\r\n            {node.arrows.length === 0 && node.depth.top !== 0 && <Icon {...endIconProps} />}\r\n          </>\r\n        )}\r\n      </Group>\r\n    );\r\n  }\r\n}\r\n\r\nexport default KShadow;","import * as React from 'react';\r\nimport { useState, useRef } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport classnames from 'classnames';\r\n\r\nimport {\r\n  Theme, TextField, Button,\r\n  InputAdornment, MenuItem, IconButton, Paper, Box, Collapse\r\n} from '@material-ui/core';\r\nimport {\r\n  Task, Switch, Case, Input, Output, PreConditions, PostConditions,\r\n  WorkerInCharge, Remarks, NecessaryTools, Exceptions, Image, Close, More, Less,\r\n} from '../../../settings/layout';\r\nimport { isTask, isSwitch, KTreeNode} from '../../../data-types/tree';\r\n\r\nimport { phrase } from '../../../settings/phrase';\r\nimport { makeStyles } from '@material-ui/styles';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    position: 'relative',\r\n    marginTop: theme.spacing(2),\r\n    width: '100%',\r\n  },\r\n  select: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  selectType: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  switchIcon: {\r\n    transform: 'scale(1, -1)',\r\n  },\r\n  title: {\r\n    fontSize: 40,\r\n  },\r\n  imageButton: {\r\n    paddingTop: theme.spacing(1.8),\r\n    paddingBottom: theme.spacing(1.8),\r\n  },\r\n  imageIcon: {\r\n    // marginLeft: -theme.spacing(0.28),\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  imageFormContainer: {\r\n    marginTop: -theme.spacing(2),\r\n    marginBottom: -theme.spacing(1),\r\n    width: '100%',\r\n    paddingLeft: 68\r\n  },\r\n  imageContainer: {\r\n    position: 'relative',\r\n  },\r\n  img: {\r\n    width: '100%',\r\n    height: 400,\r\n    objectFit: 'contain',\r\n    verticalAlign: 'bottom',\r\n  },\r\n  deleteButton: {\r\n    position: 'absolute',\r\n    top: -theme.spacing(2),\r\n    right: -theme.spacing(2),\r\n  }\r\n}));\r\n\r\nexport interface InfoContentProps {\r\n  node: KTreeNode;\r\n  isEditing: boolean;\r\n  changeNode: (node: KTreeNode) => void;\r\n}\r\n\r\ninterface Props extends InfoContentProps { }\r\n\r\nconst InfoContentComponent: React.FC<Props> = (props: Props) => {\r\n  var fileReader: FileReader;\r\n  var fileName: string;\r\n\r\n  const { node, changeNode, isEditing } = props;\r\n  const [open, setOpen] = useState(isEditing);\r\n  function handleOpenClose() {\r\n    setOpen(!open);\r\n  }\r\n  const selectIsCommonRef = useRef(null);\r\n  const [, setSelectIsCommonWidth] = useState(0);\r\n  const selectTypeRef = useRef(null);\r\n  const [, setSelectTypeWidth] = useState(0);\r\n\r\n  if (node !== null) {\r\n    process.nextTick(() => {\r\n      const commonEl = ReactDOM.findDOMNode(selectIsCommonRef.current) as HTMLElement | null;\r\n      if (commonEl !== null) { setSelectIsCommonWidth(commonEl.offsetWidth); }\r\n      const typeEl = ReactDOM.findDOMNode(selectTypeRef.current) as HTMLElement | null;\r\n      if (typeEl !== null) { setSelectTypeWidth(typeEl.offsetWidth); }\r\n    });\r\n  }\r\n\r\n  const handleFileRead = () => {\r\n    const content = fileReader.result as string;\r\n    changeNode({ ...node!, imageName: fileName, imageBlob: content });\r\n    fileName = '';\r\n  }\r\n\r\n  const handleFileChosen = (e: any) => {\r\n    const file = e.target.files[0];\r\n    if (file === undefined) { return; }\r\n    fileReader = new FileReader();\r\n    fileReader.onload = handleFileRead;\r\n    fileReader.readAsDataURL(file);\r\n    const filePath = String(e.target.value).split('\\\\');\r\n    fileName = filePath[filePath.length - 1];\r\n    e.target.value = '';\r\n  }\r\n\r\n  const handleDeleteImage = (node: KTreeNode) => () => {\r\n    changeNode({ ...node!, imageName: '', imageBlob: '' });\r\n  }\r\n\r\n  const handleLabel = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, label: e.target.value as string});\r\n\r\n  const handleInput = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, input: e.target.value as string});\r\n\r\n  const handleOutput = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, output: e.target.value as string});\r\n\r\n  const handlePreConditions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, preConditions: e.target.value as string});\r\n\r\n  const handlePostConditions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, postConditions: e.target.value as string});\r\n\r\n  const handleWorkerInCharge = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, workerInCharge: e.target.value as string});\r\n\r\n  const handleRemarks = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, remarks: e.target.value as string});\r\n\r\n  const handleNecessaryTools = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, necessaryTools: e.target.value as string});\r\n\r\n  const handleExceptions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, exceptions: e.target.value as string});\r\n\r\n  const classes = useStyles();\r\n\r\n  const InputIcon = <InputAdornment position=\"start\"><Input /></InputAdornment>;\r\n\r\n  const OutputIcon = <InputAdornment position=\"start\"><Output /></InputAdornment>;\r\n\r\n  const PreConditionsIcon = <InputAdornment position=\"start\"><PreConditions /></InputAdornment>;\r\n\r\n  const PostConditionsIcon = <InputAdornment position=\"start\"><PostConditions /></InputAdornment>;\r\n\r\n  const WorkerInChargeIcon = <InputAdornment position=\"start\"><WorkerInCharge /></InputAdornment>;\r\n\r\n  const RemarksIcon = <InputAdornment position=\"start\"><Remarks /></InputAdornment>;\r\n\r\n  const NecessaryToolsIcon = <InputAdornment position=\"start\"><NecessaryTools /></InputAdornment>;\r\n\r\n  const ExceptionsIcon = <InputAdornment position=\"start\"><Exceptions /></InputAdornment>;\r\n\r\n  const InputField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"インプット\"\r\n        value={node.input}\r\n        onChange={handleInput}\r\n        InputProps={{ startAdornment: InputIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const OutputField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"アウトプット\"\r\n        value={node.output}\r\n        onChange={handleOutput}\r\n        InputProps={{ startAdornment: OutputIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const PreConditionsField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"事前条件\"\r\n        value={node.preConditions}\r\n        onChange={handlePreConditions}\r\n        InputProps={{ startAdornment: PreConditionsIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const PostConditionsField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"事後条件\"\r\n        value={node.postConditions}\r\n        onChange={handlePostConditions}\r\n        InputProps={{ startAdornment: PostConditionsIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const WorkerInChargeField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"担当者\"\r\n        value={node.workerInCharge}\r\n        onChange={handleWorkerInCharge}\r\n        InputProps={{ startAdornment: WorkerInChargeIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const RemarksField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"備考\"\r\n        value={node.remarks}\r\n        onChange={handleRemarks}\r\n        InputProps={{ startAdornment: RemarksIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const NecessaryToolsField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"必要システム・ツール\"\r\n        value={node.necessaryTools}\r\n        onChange={handleNecessaryTools}\r\n        InputProps={{ startAdornment: NecessaryToolsIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const ExceptionsField = (\r\n    <Box mt={1.5}>\r\n      <TextField\r\n        label=\"例外\"\r\n        value={node.exceptions}\r\n        onChange={handleExceptions}\r\n        InputProps={{ startAdornment: ExceptionsIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  return (\r\n    <Box>\r\n      {node.depth.top !== 0 &&\r\n      <Box display=\"flex\" flexDirection=\"row\">\r\n        <TextField\r\n          select\r\n          variant=\"outlined\"\r\n          label=\"タイプ\"\r\n          value={node.type}\r\n          InputProps={{\r\n            startAdornment:\r\n              isTask(node.type)   ? <Task className={classes.selectType}/> :\r\n              isSwitch(node.type) ? <Switch className={classes.selectType}/> :\r\n              <Case className={classnames(classes.selectType, classes.switchIcon)}/>\r\n          }}\r\n          disabled\r\n        >\r\n          <MenuItem value=\"0\">作業</MenuItem>\r\n          <MenuItem value=\"1\">分岐</MenuItem>\r\n          <MenuItem value=\"2\">条件</MenuItem>\r\n        </TextField>\r\n        <Box flexGrow={1}/>\r\n        <Box>\r\n          <IconButton onClick={handleOpenClose}>{open ? <Less /> : <More />}</IconButton>\r\n        </Box>\r\n      </Box>}\r\n      <Box mt={1.5}>\r\n        <TextField\r\n          placeholder={\r\n            isTask(node.type) ? phrase.placeholder.task :\r\n              isSwitch(node.type) ? phrase.placeholder.switch : phrase.placeholder.case\r\n          }\r\n          value={node.label}\r\n          onChange={handleLabel}\r\n          fullWidth\r\n          disabled={!isEditing}\r\n        />\r\n      </Box>\r\n      {node.imageBlob.length !== 0 &&\r\n        <Box mt={1.5} justifyContent=\"center\">\r\n          <Paper className={classes.imageContainer}>\r\n            <img src={node.imageBlob} className={classes.img} alt={node.imageName} />\r\n            {isEditing &&\r\n            <IconButton className={classes.deleteButton} onClick={handleDeleteImage(node)}>\r\n              <Close />\r\n            </IconButton>}\r\n          </Paper>\r\n        </Box>}\r\n      <Collapse in={!open}>\r\n        {node.input.length !== 0 && InputField}\r\n        {node.output.length !== 0 && OutputField}\r\n        {node.preConditions.length !== 0 && PreConditionsField}\r\n        {node.postConditions.length !== 0 && PostConditionsField}\r\n        {node.workerInCharge.length !== 0 && WorkerInChargeField}\r\n        {node.remarks.length !== 0 && RemarksField}\r\n        {node.necessaryTools.length !== 0 && NecessaryToolsField}\r\n        {node.exceptions.length !== 0 && ExceptionsField}\r\n      </Collapse>\r\n\r\n      <Collapse in={open}>\r\n      {isEditing && node.imageBlob.length === 0 &&\r\n        <Box mt={1.5}>\r\n          <Button component=\"label\" variant=\"outlined\" className={classes.imageButton} fullWidth>\r\n            <Image className={classes.imageIcon} />\r\n            {node.imageName.length !== 0 ? node.imageName : 'ファイルを選択'}\r\n            <form><input type=\"file\" style={{ display: 'none' }} onChange={handleFileChosen} /></form>\r\n          </Button>\r\n        </Box>}\r\n        {InputField}\r\n        {OutputField}\r\n        {PreConditionsField}\r\n        {PostConditionsField}\r\n        {WorkerInChargeField}\r\n        {RemarksField}\r\n        {NecessaryToolsField}\r\n        {ExceptionsField}\r\n      </Collapse>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default InfoContentComponent;","import * as React from 'react';\r\nimport {\r\n  Theme, createStyles, WithStyles, withStyles, Portal, Button, Box,\r\n} from '@material-ui/core';\r\n\r\nimport { TreeNode, Manual } from '../../../../data-types/tree';\r\nimport TreeUtil from '../../../../func/tree';\r\nimport TextLineWithIcon, { TextLineWithIconProps } from './text-line-with-icon';\r\nimport { Action } from 'typescript-fsa';\r\nimport { Prompt, withRouter, RouteComponentProps } from 'react-router-dom';\r\nimport { TreePutRequest } from '../../../../api/definitions';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  root: {\r\n    width: '100%',\r\n    padding: theme.spacing(2),\r\n  },\r\n  saveButton: {\r\n    minWidth: 100,\r\n  },\r\n  extendedIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  close: {\r\n    padding: theme.spacing(0.5),\r\n  },\r\n  viewSettingModal: {\r\n    backgroundColor: '#0002',\r\n  },\r\n  viewSettingPaper: {\r\n    position: 'absolute',\r\n    top: '75vh',\r\n    left: '50vw',\r\n    width: '90vw',\r\n    maxHeight: '45vh',\r\n    transform: 'translate(-50%, -50%)',\r\n    padding: theme.spacing(2),\r\n    outline: 'none',\r\n  },\r\n});\r\n\r\nexport interface TextEditorProps {\r\n  manual: Manual;\r\n  node: TreeNode;\r\n  putTree: (params: TreePutRequest) => Action<TreePutRequest>;\r\n  buttonRef: React.RefObject<HTMLDivElement>;\r\n}\r\n\r\ninterface Props extends TextEditorProps, RouteComponentProps, WithStyles<typeof styles> {}\r\n\r\ninterface State {\r\n  node: TreeNode;\r\n  saved: boolean;\r\n}\r\n\r\nclass TextEditor extends React.Component<Props, State> {\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n\r\n    this.state = {node: props.node, saved: false};\r\n  }\r\n\r\n  save = () => {\r\n    const { manual, putTree, history } = this.props;\r\n    const { node } = this.state;\r\n    const hasDifference = TreeUtil._hasDifference(this.props.node, this.state.node);\r\n    if (hasDifference) {\r\n      const params: TreePutRequest = {manualId: manual.id, rootTree: node };\r\n      putTree(params);\r\n    }\r\n    this.setState({saved: true})\r\n    process.nextTick(() => history.push(`/manual/${manual.id}/text`));\r\n  }\r\n\r\n  changeNode = (target: TreeNode) => {\r\n    const {node} = this.state;\r\n    this.setState({node: TreeUtil._replace(node, target)});\r\n  }\r\n\r\n\r\n  deleteSelf = (target: TreeNode) => {\r\n    const {node} = this.state;\r\n    this.setState({node: TreeUtil._deleteById(node, target.id)});\r\n  }\r\n\r\n  render() {\r\n    const { buttonRef, classes, location } = this.props;\r\n    const isEditing = location.pathname.slice(-4) === 'edit';\r\n    const { node, saved } = this.state;\r\n\r\n    const textLineWithIconProps: TextLineWithIconProps = {\r\n      itemNumber: node.label,\r\n      node,\r\n      isEditing,\r\n      showChildren: true,\r\n      changeNode: this.changeNode,\r\n    };\r\n    const hasDifference = TreeUtil._hasDifference(this.props.node, this.state.node);\r\n    return (\r\n      <div className={classes.root}>\r\n        {isEditing &&\r\n        <>\r\n          <Portal container={buttonRef.current}>\r\n            <Box mt={0.7}>\r\n              <Button color=\"primary\" onClick={this.save}>編集完了</Button>\r\n            </Box>\r\n          </Portal>\r\n          <Prompt\r\n            when={hasDifference && !saved}\r\n            message=\"編集内容を保存していません。編集を終了して良いですか？\"\r\n          />\r\n        </>}\r\n        \r\n        <TextLineWithIcon {...textLineWithIconProps}/>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(withStyles(styles)(TextEditor));","import * as React from 'react';\r\nimport { useState, useRef } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport classnames from 'classnames';\r\n\r\nimport {\r\n  Theme, TextField, Button,\r\n  InputAdornment, FormControl, Select, MenuItem, IconButton, Typography, Paper, Box, Collapse\r\n} from '@material-ui/core';\r\nimport {\r\n  Task, Switch, Case, Input, Output, PreConditions, PostConditions,\r\n  WorkerInCharge, Remarks, NecessaryTools, Exceptions, Image, Close, Less, More,\r\n} from '../../../../settings/layout';\r\nimport { TreeNode, Type, isTask, isSwitch, isCase } from '../../../../data-types/tree';\r\n\r\nimport { phrase } from '../../../../settings/phrase';\r\nimport { makeStyles } from '@material-ui/styles';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    position: 'relative',\r\n    marginTop: theme.spacing(2),\r\n    width: '100%',\r\n  },\r\n  select: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  selectType: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  switchIcon: {\r\n    transform: 'scale(1, -1)',\r\n  },\r\n  title: {\r\n    fontSize: 40,\r\n  },\r\n  imageButton: {\r\n    paddingTop: theme.spacing(1.8),\r\n    paddingBottom: theme.spacing(1.8),\r\n  },\r\n  imageIcon: {\r\n    // marginLeft: -theme.spacing(0.28),\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  imageFormContainer: {\r\n    marginTop: -theme.spacing(2),\r\n    marginBottom: -theme.spacing(1),\r\n    width: '100%',\r\n    paddingLeft: 68\r\n  },\r\n  imageContainer: {\r\n    position: 'relative',\r\n  },\r\n  img: {\r\n    width: '100%',\r\n    height: 400,\r\n    objectFit: 'contain',\r\n    verticalAlign: 'bottom',\r\n  },\r\n  deleteButton: {\r\n    position: 'absolute',\r\n    top: -theme.spacing(2),\r\n    right: -theme.spacing(2),\r\n  }\r\n}));\r\n\r\nexport interface TextLineWithIconProps {\r\n  itemNumber: string;\r\n  node: TreeNode;\r\n  isEditing: boolean;\r\n  showChildren: boolean;\r\n  changeNode: (node: TreeNode) => void;\r\n}\r\n\r\ninterface Props extends TextLineWithIconProps { }\r\n\r\nconst TextLineWithIcon: React.FC<Props> = (props: Props) => {\r\n  var fileReader: FileReader;\r\n  var fileName: string;\r\n\r\n  const { itemNumber, node, changeNode, isEditing, showChildren } = props;\r\n  const [open, setOpen] = useState(isEditing);\r\n  function handleOpenClose() {\r\n    setOpen(!open);\r\n  }\r\n  const selectIsCommonRef = useRef(null);\r\n  const [, setSelectIsCommonWidth] = useState(0);\r\n  const selectTypeRef = useRef(null);\r\n  const [, setSelectTypeWidth] = useState(0);\r\n\r\n  if (node !== null) {\r\n    process.nextTick(() => {\r\n      const commonEl = ReactDOM.findDOMNode(selectIsCommonRef.current) as HTMLElement | null;\r\n      if (commonEl !== null) { setSelectIsCommonWidth(commonEl.offsetWidth); }\r\n      const typeEl = ReactDOM.findDOMNode(selectTypeRef.current) as HTMLElement | null;\r\n      if (typeEl !== null) { setSelectTypeWidth(typeEl.offsetWidth); }\r\n    });\r\n  }\r\n\r\n  const handleFileRead = () => {\r\n    const content = fileReader.result as string;\r\n    changeNode({ ...node!, imageName: fileName, imageBlob: content });\r\n    fileName = '';\r\n  }\r\n\r\n  const handleFileChosen = (e: any) => {\r\n    const file = e.target.files[0];\r\n    if (file === undefined) { return; }\r\n    fileReader = new FileReader();\r\n    fileReader.onload = handleFileRead;\r\n    fileReader.readAsDataURL(file);\r\n    const filePath = String(e.target.value).split('\\\\');\r\n    fileName = filePath[filePath.length - 1];\r\n    e.target.value = '';\r\n  }\r\n\r\n  const handleDeleteImage = (node: TreeNode) => () => {\r\n    changeNode({ ...node!, imageName: '', imageBlob: '' });\r\n  }\r\n\r\n  const handleInput = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, input: e.target.value as string});\r\n\r\n  const handleOutput = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, output: e.target.value as string});\r\n\r\n  const handlePreConditions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, preConditions: e.target.value as string});\r\n\r\n  const handlePostConditions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, postConditions: e.target.value as string});\r\n\r\n  const handleWorkerInCharge = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, workerInCharge: e.target.value as string});\r\n\r\n  const handleRemarks = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, remarks: e.target.value as string});\r\n\r\n  const handleNecessaryTools = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, necessaryTools: e.target.value as string});\r\n\r\n  const handleExceptions = (e: React.ChangeEvent<HTMLInputElement>) =>  changeNode({ ...node!, exceptions: e.target.value as string});\r\n\r\n  const classes = useStyles();\r\n\r\n  const InputIcon = <InputAdornment position=\"start\"><Input /></InputAdornment>;\r\n\r\n  const OutputIcon = <InputAdornment position=\"start\"><Output /></InputAdornment>;\r\n\r\n  const PreConditionsIcon = <InputAdornment position=\"start\"><PreConditions /></InputAdornment>;\r\n\r\n  const PostConditionsIcon = <InputAdornment position=\"start\"><PostConditions /></InputAdornment>;\r\n\r\n  const WorkerInChargeIcon = <InputAdornment position=\"start\"><WorkerInCharge /></InputAdornment>;\r\n\r\n  const RemarksIcon = <InputAdornment position=\"start\"><Remarks /></InputAdornment>;\r\n\r\n  const NecessaryToolsIcon = <InputAdornment position=\"start\"><NecessaryTools /></InputAdornment>;\r\n\r\n  const ExceptionsIcon = <InputAdornment position=\"start\"><Exceptions /></InputAdornment>;\r\n\r\n  const focusType: Type = node === null ? Type.task : node.type;\r\n\r\n  const InputField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"インプット\"\r\n        value={node.input}\r\n        onChange={handleInput}\r\n        InputProps={{ startAdornment: InputIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const OutputField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"アウトプット\"\r\n        value={node.output}\r\n        onChange={handleOutput}\r\n        InputProps={{ startAdornment: OutputIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const PreConditionsField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"事前条件\"\r\n        value={node.preConditions}\r\n        onChange={handlePreConditions}\r\n        InputProps={{ startAdornment: PreConditionsIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const PostConditionsField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"事後条件\"\r\n        value={node.postConditions}\r\n        onChange={handlePostConditions}\r\n        InputProps={{ startAdornment: PostConditionsIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const WorkerInChargeField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"担当者\"\r\n        value={node.workerInCharge}\r\n        onChange={handleWorkerInCharge}\r\n        InputProps={{ startAdornment: WorkerInChargeIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const RemarksField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"備考\"\r\n        value={node.remarks}\r\n        onChange={handleRemarks}\r\n        InputProps={{ startAdornment: RemarksIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const NecessaryToolsField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"必要システム・ツール\"\r\n        value={node.necessaryTools}\r\n        onChange={handleNecessaryTools}\r\n        InputProps={{ startAdornment: NecessaryToolsIcon }}\r\n        fullWidth\r\n        multiline\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  const ExceptionsField = (\r\n    <Box mt={1} pl={10} pr={2}>\r\n      <TextField\r\n        placeholder=\"例外\"\r\n        value={node.exceptions}\r\n        onChange={handleExceptions}\r\n        InputProps={{ startAdornment: ExceptionsIcon }}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </Box>);\r\n\r\n  return (\r\n    <Box py={2}>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" pr={2}>\r\n        <Box pr={1}>\r\n          <FormControl>\r\n            <Select\r\n              classes={{\r\n                icon: !isSwitch(focusType) ? classes.selectType : classnames(classes.selectType, classes.switchIcon),\r\n                select: classes.select\r\n              }}\r\n              value={node.type}\r\n              IconComponent={\r\n                p => isTask(focusType) ? <Task {...p} /> : isSwitch(focusType) ? <Switch {...p} /> : <Case {...p} />}\r\n              disabled\r\n            >\r\n              <MenuItem value=\"0\">作業</MenuItem>\r\n              <MenuItem value=\"1\">分岐</MenuItem>\r\n              {isCase(node.type) && <MenuItem value=\"2\">条件</MenuItem>}\r\n            </Select>\r\n          </FormControl>\r\n        </Box>\r\n        <Box>\r\n          {node.label !== itemNumber && <Typography variant=\"h5\">{itemNumber}</Typography>}\r\n        </Box>\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"center\" pr={2}>\r\n        <Box pr={4}>\r\n          <IconButton onClick={handleOpenClose}>{open ? <Less /> : <More />}</IconButton>\r\n        </Box>\r\n        <Box flexGrow={1}>\r\n          <TextField\r\n            placeholder={\r\n              isTask(node.type) ? phrase.placeholder.task :\r\n                isSwitch(node.type) ? phrase.placeholder.switch : phrase.placeholder.case\r\n            }\r\n            value={node.label}\r\n            InputProps={{ classes: { input: showChildren ? classes.title : undefined } }}\r\n            fullWidth\r\n            disabled={!isEditing}\r\n          />\r\n        </Box>\r\n      </Box>\r\n      {node.imageBlob.length !== 0 &&\r\n        <Box mt={1} pl={10} pr={2} justifyContent=\"center\">\r\n          <Paper className={classes.imageContainer}>\r\n            <img src={node.imageBlob} className={classes.img} alt={node.imageName} />\r\n            {isEditing &&\r\n            <IconButton className={classes.deleteButton} onClick={handleDeleteImage(node)}>\r\n              <Close />\r\n            </IconButton>}\r\n          </Paper>\r\n        </Box>}\r\n      <Collapse in={!open}>\r\n        {node.input.length !== 0 && InputField}\r\n        {node.output.length !== 0 && OutputField}\r\n        {node.preConditions.length !== 0 && PreConditionsField}\r\n        {node.postConditions.length !== 0 && PostConditionsField}\r\n        {node.workerInCharge.length !== 0 && WorkerInChargeField}\r\n        {node.remarks.length !== 0 && RemarksField}\r\n        {node.necessaryTools.length !== 0 && NecessaryToolsField}\r\n        {node.exceptions.length !== 0 && ExceptionsField}\r\n      </Collapse>\r\n\r\n      <Collapse in={open}>\r\n      {isEditing && node.imageBlob.length === 0 &&\r\n        <Box mt={1} pl={10} pr={2}>\r\n          <Button component=\"label\" variant=\"outlined\" className={classes.imageButton} fullWidth>\r\n            <Image className={classes.imageIcon} />\r\n            {node.imageName.length !== 0 ? node.imageName : 'ファイルを選択'}\r\n            <form><input type=\"file\" style={{ display: 'none' }} onChange={handleFileChosen} /></form>\r\n          </Button>\r\n        </Box>}\r\n        {InputField}\r\n        {OutputField}\r\n        {PreConditionsField}\r\n        {PostConditionsField}\r\n        {WorkerInChargeField}\r\n        {RemarksField}\r\n        {NecessaryToolsField}\r\n        {ExceptionsField}\r\n      </Collapse>\r\n\r\n      {showChildren && node.children.map((c, i) =>\r\n      <TextLineWithIcon key={c.id} {...props} itemNumber={`${itemNumber} - ${i + 1}`} node={c} />)}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default TextLineWithIcon;","export default class Util {\r\n  static isEmpty = (str: string): boolean => str.replace(/\\n|\\t|\\f|\\s|　/g, '') === '';\r\n  \r\n  static getID = (): string => `tmp:${String(Math.random()).slice(2)}`;\r\n\r\n  static validPassword = (password: string): string | undefined => {\r\n    const textRegex = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])./;\r\n    if (!textRegex.test(password)) { return \"パスワードは大文字、小文字、数字を組み合わせて下さい\"; }\r\n\r\n    const lengthRegex = /^.{6,30}$/;\r\n    if (!lengthRegex.test(password)) { return \"パスワードは6~30文字である必要があります\"; }\r\n\r\n    return undefined;\r\n  }\r\n}","import actionCreatorFactory from 'typescript-fsa';\r\nimport KSize from '../../data-types/k-size';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\nexport const ACTIONS_KSIZE_CHANGE = 'ACTIONS_KSIZE_CHANGE';\r\nexport const ACTIONS_KSIZE_ZOOM_IN = 'ACTIONS_KSIZE_ZOOM_IN';\r\nexport const ACTIONS_KSIZE_ZOOM_OUT = 'ACTIONS_KSIZE_ZOOM_OUT';\r\n\r\nexport const ksActions = {\r\n  change: actionCreator<KSize>(ACTIONS_KSIZE_CHANGE),\r\n  zoomIn: actionCreator<void>(ACTIONS_KSIZE_ZOOM_IN),\r\n  zoomOut: actionCreator<void>(ACTIONS_KSIZE_ZOOM_OUT),\r\n  reset: actionCreator<void>('ACTIONS_KSIZE_RESET'),\r\n};","/**\r\n * POSTでのIdの扱いについて\r\n * POSTについてはサーバーサイドではIdの値を採番する。\r\n * そのためフロントからサーバーに送られるIDの値については無視すること。\r\n */\r\nimport User, { LoginUser } from \"../data-types/user\";\r\nimport { Manual, Tree } from \"../data-types/tree\";\r\nimport Category from \"../data-types/category\";\r\nimport { Password } from \"../data-types/password\";\r\nimport UserGroup from \"../data-types/user-group\";\r\nimport { TitleCheckResult } from \"../redux/actions/titileCheckAction\";\r\n\r\n/* Login */\r\nexport const loginURL = '/api/v1/login';\r\n// POST\r\nexport interface LoginPostRequest {\r\n  id: string;\r\n  password: string;\r\n}\r\n\r\nexport interface LoginPostResponse {\r\n  user: LoginUser;\r\n  users: User[];\r\n  userGroups: UserGroup[];\r\n  categories: Category[];\r\n  manuals: Manual[];\r\n}\r\n// DELETE -> ステータスコード200でログアウト\r\n\r\n/* Sesson Check */\r\nexport const sessionCheckURL = '/api/v1/session-check';\r\n// POST\r\nexport interface SessonCheckPostRequest {}\r\n\r\nexport interface SessonCheckPostResponse {\r\n  user: LoginUser;\r\n  users: User[];\r\n  userGroups: UserGroup[];\r\n  categories: Category[];\r\n  manuals: Manual[];\r\n}\r\n\r\n/* Users */\r\nexport const usersURL = '/api/v1/users';\r\n// GET\r\n// PUT(/api/v1/users/:id)\r\nexport type LoginUserPutRequest = LoginUser;\r\nexport type LoginUserPutResponse = LoginUser;\r\n// DELETE\r\n\r\n/* Users */\r\nexport const passwordURL = '/api/v1/password';\r\n// GET\r\n// PUT(/api/v1/password/:id) -> 成功の場合、ステータスコード200のみを返す\r\nexport type PasswordPutRequestParams = {\r\n  user: LoginUser;\r\n  password: Password;\r\n}\r\n\r\n/**\r\n * queryParamsは以下の通り\r\n * -filterList\r\n * -searchText\r\n * -sortColumn\r\n * -sortDirection\r\n * -page\r\n * -rowsPerPage\r\n * -count\r\n * \r\n * 本来はGETメソッドでquery-stringsとしてパラメーターを渡したいが、\r\n * filterListのネストが深いのでPOSTを採用する\r\n **/\r\nexport const manualsURL = '/api/v1/manuals';\r\n\r\nexport interface ManualsQueryParams {\r\n  filters: {\r\n    favorite: Show;\r\n    like: Show;\r\n    categoryId: string | null;\r\n  },\r\n  searchText: string[];\r\n  sortColumn: string;\r\n  sortDirection: 'asc' | 'desc';\r\n  page: number;\r\n  rowsPerPage: number;\r\n}\r\n\r\nexport enum Show { ALL, CHECK, UNCHECK }\r\n\r\nexport const baseManualQueryParams: ManualsQueryParams = {\r\n  filters: {\r\n    favorite: Show.ALL,\r\n    like: Show.ALL,\r\n    categoryId: null,\r\n  },\r\n  searchText: [],\r\n  sortColumn: 'updateAt',\r\n  sortDirection: 'desc',\r\n  page: 0,\r\n  rowsPerPage: 10\r\n}\r\n\r\n// レスポンスにQueryParamsを含めて返す\r\nexport interface ManualsQueryResponse {\r\n  queryParams: ManualsQueryParams;\r\n  manuals: Manual[];\r\n  count: number;\r\n}\r\n\r\n/* Manual */\r\n/**\r\n * PUTでのIdの扱いについて\r\n * マニュアルは編集終了ボタン押下時にサーバーへPUTされる。\r\n * childrenには編集されたTreeや新規作成されたTreeが存在するが\r\n * それぞれの状態に合わせた保存が必要となる。\r\n * 新しいTreeにはフロント側で\"tmp:~\"で始まるIdを降っているので、\r\n * それぞれのTreeのIdが\"tmp:~\"で始まっているかどうかでレコードのインサートなのかアップデートなのか\r\n * 判断できます。\r\n * \r\n * ※GUIDは１６進数を表現するための文字列であるため、t, m, pといった文字は使用されません。\r\n * なので最初の一文字がtで始まるかどうかや、\r\n * GUIDとして適当な文字列かどうかをチェックするC#のメソッド（TryParse）で判定可能です。\r\n */\r\nexport const manualURL = '/api/v1/manual';\r\n// GET(/api/v1/manuals/:id)\r\nexport type ManualGetRequestParams = Manual;\r\nexport type ManualGetResponse = Manual;\r\n// POST(/api/v1/manuals)\r\nexport type ManualPostRequest = Manual;\r\nexport type ManualPostResponse = Manual;\r\n// PUT(/api/v1/manuals/:id)\r\nexport type ManualPutRequest = Manual;\r\nexport type ManualPutResponse = Manual;\r\n// DELETE\r\nexport type ManualDeleteResponse = {};\r\n\r\nexport const titleCheckURL = '/api/v1/manual-title-check';\r\nexport type TitleCheckPostRequest = { title: string; };\r\nexport type TitleCheckPostResponse = TitleCheckResult;\r\n\r\nexport const generateTitleURL = '/api/v1/manual-generate-title';\r\nexport type GenerateTitleRequest = { title: string; };\r\nexport type GenerateTitleResponse = TitleCheckResult;\r\n\r\n/* Tree */\r\nexport const treeURL = '/api/v1/tree';\r\n// PUT(/api/v1/tree/:manualId)\r\nexport type TreePutRequest = { manualId: string; rootTree: Tree; };\r\nexport type TreePutResponse = Tree;\r\n\r\n/* Favorite */\r\nexport const favoriteURL = '/api/v1/favorites';\r\n// POST(/api/v1/favorites/:manualId)\r\nexport type FavoritePostRequestParams = { manualId: string; userId: string; };\r\nexport type FavoritePostRequest = void;\r\nexport type FavoritePostResponse = {};\r\n// DELETE(/api/v1/favorites/:manualId)\r\nexport type FavoriteDeleteRequestParams = { manualId: string; userId: string; };\r\nexport type FavoriteDeleteRequest = void;\r\nexport type FavoriteDeleteResponse = {};\r\n\r\n/* Like */\r\nexport const likeURL = '/api/v1/likes';\r\n// POST(/api/v1/likes/:manualId)\r\nexport type LikePostRequestParams = { manualId: string; userId: string; };\r\nexport type LikePostRequest = void;\r\nexport type LikePostResponse = {};\r\n// DELETE(/api/v1/likes/:manualId)\r\nexport type LikeDeleteRequestParams = { manualId: string; userId: string; };\r\nexport type LikeDeleteRequest = void;\r\nexport type LikeDeleteResponse = {};","import actionCreatorFactory from 'typescript-fsa';\r\nimport { LoginUser } from '../../../data-types/user';\r\n\r\nexport const actionCreator = actionCreatorFactory();\r\nexport const ACTIONS_LOGINUSER_SET   = 'ACTIONS_LOGINUSER_SET';\r\nexport const ACTIONS_LOGINUSER_RESET = 'ACTIONS_LOGINUSER_RESET';\r\n\r\nexport const ACTIONS_LOGINUSER_START_SESSIONCHECK = 'ACTIONS_LOGINUSER_START_SESSIONCHECK';\r\nexport const ACTIONS_LOGINUSER_SESSIONCHECKED = 'ACTIONS_LOGINUSER_SESSIONCHECKED';\r\n\r\nexport const ACTIONS_LOGINUSER_PUT         = 'ACTIONS_LOGINUSER_PUT';\r\nexport const ACTIONS_LOGINUSER_PUT_SUCCESS = 'ACTIONS_LOGINUSER_PUT_SUCCESS';\r\nexport const ACTIONS_LOGINUSER_PUT_ERROR   = 'ACTIONS_LOGINUSER_PUT_ERROR';\r\n\r\nexport const loginUserAction = {\r\n  set:   actionCreator<LoginUser>(ACTIONS_LOGINUSER_SET),\r\n  reset: actionCreator<void>(ACTIONS_LOGINUSER_RESET),\r\n\r\n  startSessionCheck: actionCreator<void>(ACTIONS_LOGINUSER_START_SESSIONCHECK),\r\n  sessionChecked: actionCreator<void>(ACTIONS_LOGINUSER_SESSIONCHECKED),\r\n\r\n  put:        actionCreator<LoginUser>(ACTIONS_LOGINUSER_PUT),\r\n  putSuccess: actionCreator<void>(ACTIONS_LOGINUSER_PUT_SUCCESS),\r\n  putError:   actionCreator<void>(ACTIONS_LOGINUSER_PUT_ERROR),\r\n};","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { LoginUser } from '../../../data-types/user';\r\nimport { loginUserAction } from '../../actions/main/loginUserAction';\r\n\r\nexport interface LoginUserState {\r\n  user: LoginUser | null;\r\n  userBeforeSaving: LoginUser | null;\r\n  sessionChecked: boolean;\r\n}\r\n\r\nconst initialState: LoginUserState = { user: null, userBeforeSaving: null, sessionChecked: false };\r\n\r\nexport const loginUserReducer = reducerWithInitialState(initialState)\r\n.case(loginUserAction.set, (state, user) => ({...state, user}))\r\n\r\n.case(loginUserAction.sessionChecked, (state) => ({...state, sessionChecked: true}))\r\n\r\n.case(\r\n  loginUserAction.put,\r\n  (state, user) => ({...state, user, userBeforeSaving: state.user})\r\n)\r\n.case(\r\n  loginUserAction.putSuccess,\r\n  (state) => ({...state, userBeforeSaving: null})\r\n)\r\n.case(\r\n  loginUserAction.putError,\r\n  (state) => ({...state, user: state.userBeforeSaving, userBeforeSaving: null})\r\n)\r\n.case(loginUserAction.reset,  (state) => ({...state, user: null}))","import actionCreatorFactory from 'typescript-fsa';\r\nimport { Manual, TreeNode, Tree } from '../../../data-types/tree';\r\nimport { TreePutRequest, FavoritePostRequestParams, FavoriteDeleteRequestParams, LikePostRequestParams, LikeDeleteRequestParams } from '../../../api/definitions';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const ACTIONS_MANUAL_GET          = 'ACTIONS_MANUAL_GET';\r\nexport const ACTIONS_MANUAL_GET_SUCCESS  = 'ACTIONS_MANUAL_GET_SUCCESS';\r\nexport const ACTIONS_MANUAL_GET_ERROR    = 'ACTIONS_MANUAL_GET_ERROR';\r\n\r\nexport const ACTIONS_SELECT_UPDATE = 'ACTIONS_SELECT_UPDATE';\r\nexport const ACTIONS_SELECT_CLEAR = 'ACTIONS_SELECT_CLEAR';\r\n\r\nexport const ACTIONS_MANUAL_POST         = 'ACTIONS_MANUAL_POST';\r\n\r\nexport const ACTIONS_MANUAL_PUT          = 'ACTIONS_MANUAL_PUT';\r\nexport const ACTIONS_MANUAL_PUT_SUCCESS  = 'ACTIONS_MANUAL_PUT_SUCCESS';\r\nexport const ACTIONS_MANUAL_PUT_ERROR    = 'ACTIONS_MANUAL_PUT_ERROR';\r\n\r\nexport const ACTIONS_MANUAL_DELETE         = 'ACTIONS_MANUAL_DELETE';\r\n\r\nexport const ACTIONS_FAVORITE_POST = 'ACTIONS_FAVORITE_POST';\r\nexport const ACTIONS_FAVORITE_DELETE = 'ACTIONS_FAVORITE_DELETE';\r\nexport const ACTIONS_LIKE_POST = 'ACTIONS_LIKE_POST';\r\nexport const ACTIONS_LIKE_DELETE = 'ACTIONS_LIKE_DELETE';\r\n\r\nexport const ACTIONS_MANUAL_COPY   = 'ACTIONS_MANUAL_COPY';\r\nexport const ACTIONS_MANUAL_POST_FOR_COPY   = 'ACTIONS_MANUAL_POST_FOR_COPY';\r\n\r\nexport const manualAction = {\r\n  get:        actionCreator<string>(ACTIONS_MANUAL_GET),\r\n  getSuccess: actionCreator<Manual>  (ACTIONS_MANUAL_GET_SUCCESS),\r\n\r\n  update: actionCreator<TreeNode>(ACTIONS_SELECT_UPDATE),\r\n  clear: actionCreator<void>(ACTIONS_SELECT_CLEAR),\r\n\r\n  post: actionCreator<Manual>(ACTIONS_MANUAL_POST),\r\n\r\n  put: actionCreator<Manual>(ACTIONS_MANUAL_PUT),\r\n  putSuccess: actionCreator<Manual>(ACTIONS_MANUAL_PUT_SUCCESS),\r\n\r\n  delete: actionCreator<Manual>(ACTIONS_MANUAL_DELETE),\r\n\r\n  checkFavorite: actionCreator<FavoritePostRequestParams>(ACTIONS_FAVORITE_POST),\r\n  uncheckFavorite: actionCreator<FavoriteDeleteRequestParams>(ACTIONS_FAVORITE_DELETE),\r\n\r\n  checkLike: actionCreator<LikePostRequestParams>(ACTIONS_LIKE_POST),\r\n  uncheckLike: actionCreator<LikeDeleteRequestParams>(ACTIONS_LIKE_DELETE),\r\n\r\n  copy: actionCreator<Manual>(ACTIONS_MANUAL_COPY),\r\n  postForCopy: actionCreator<Manual>(ACTIONS_MANUAL_POST_FOR_COPY),\r\n};\r\n\r\nexport const ACTIONS_TREE_PUT         = 'ACTIONS_TREE_PUT';\r\nexport const ACTIONS_TREE_PUT_SUCCESS = 'ACTIONS_TREE_PUT_SUCCESS';\r\nexport const ACTIONS_TREE_PUT_ERROR   = 'ACTIONS_TREE_PUT_ERROR';\r\n\r\nexport const ACTIONS_TREE_PUT_FOR_COPY = 'ACTIONS_TREE_PUT_FOR_COPY';\r\n\r\nexport const treeActions = {\r\n  put: actionCreator<TreePutRequest>(ACTIONS_TREE_PUT),\r\n  putSuccess: actionCreator<Tree>(ACTIONS_TREE_PUT_SUCCESS),\r\n  putError: actionCreator<string>(ACTIONS_TREE_PUT_ERROR),\r\n}","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { manualAction, treeActions } from '../../actions/main/manualsAction';\r\nimport { Manual, TreeNode, Tree, baseTreeNode } from '../../../data-types/tree';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport TreeNodeUtil from '../../../func/tree-node';\r\nimport TreeUtil from '../../../func/tree';\r\n\r\nexport interface ManualState {\r\n  manual: Manual | null;\r\n  node: TreeNode | null;\r\n}\r\n\r\nconst initialState: ManualState = {\r\n  manual: null,\r\n  node: null,\r\n};\r\n\r\nexport const manualReducer = reducerWithInitialState(initialState)\r\n\r\n// GET\r\n.case(\r\n  manualAction.get,\r\n  (state) => ({ ...state, requestGet: true, manual: null, node: null })\r\n)\r\n.case(\r\n  manualAction.getSuccess,\r\n  (state, manual) => {\r\n    const node = manual.rootTree !== null\r\n      ? TreeNodeUtil._init(TreeUtil._get<Tree, TreeNode>(manual.rootTree!, baseTreeNode))\r\n      : {...baseTreeNode};\r\n    node.label = manual.title;\r\n\r\n    return ({ ...state, requestGet: false, manual, node})\r\n  }\r\n)\r\n\r\n// PUT\r\n.case(\r\n  manualAction.put,\r\n  (state, manual) => {\r\n    const cloneManual = cloneDeep(manual);\r\n    const node = cloneManual.rootTree !== null\r\n      ? TreeNodeUtil._init(TreeUtil._get<Tree, TreeNode>(cloneManual.rootTree!, baseTreeNode))\r\n      : null;\r\n    if (node !== null) { node.label = cloneManual.title; }\r\n\r\n    return ({\r\n      ...state,\r\n      manual: cloneManual,\r\n      node,\r\n    })\r\n  }\r\n)\r\n.case(\r\n  manualAction.putSuccess,\r\n  (state, manual) => {\r\n    const cloneManual = cloneDeep(manual);\r\n    const node = cloneManual.rootTree !== null\r\n    ? TreeNodeUtil._init(TreeUtil._get<Tree, TreeNode>(cloneManual.rootTree!, baseTreeNode))\r\n    : null;\r\n    if (node !== null) { node.label = cloneManual.title; }\r\n\r\n    return ({\r\n      ...state,\r\n      manual: cloneManual,\r\n      node,\r\n    })\r\n  }\r\n)\r\n\r\n.case(manualAction.update, (state, node) => ({...state, node}))\r\n.case(manualAction.clear, (state) => ({...state, manual: null, node: null}))\r\n\r\n// Favorite\r\n.case(\r\n  manualAction.checkFavorite,\r\n  (state, {userId}) => {\r\n    const manual = state.manual!;\r\n    return ({\r\n      ...state,\r\n      manual: {...manual, favoriteIds: manual.favoriteIds.concat([userId])},\r\n    })\r\n  }\r\n)\r\n\r\n.case(\r\n  manualAction.uncheckFavorite,\r\n  (state, {userId}) => {\r\n    const manual = state.manual!;\r\n    return ({\r\n      ...state,\r\n      manual: {...manual, favoriteIds: manual.favoriteIds.filter(fid => fid !== userId )},\r\n    })\r\n  }\r\n)\r\n\r\n// Like\r\n.case(\r\n  manualAction.checkLike,\r\n  (state, {userId}) => {\r\n    const manual = state.manual!;\r\n    return ({\r\n      ...state,\r\n      manual: {...manual, likeIds: manual.likeIds.concat([userId])},\r\n    })\r\n  }\r\n)\r\n\r\n.case(\r\n  manualAction.uncheckLike,\r\n  (state, {userId}) => {\r\n    const manual = state.manual!;\r\n\r\n    return ({\r\n      ...state,\r\n      manual: {...manual, likeIds: manual.likeIds.filter(lid => lid !== userId )},\r\n    })\r\n  }\r\n)\r\n\r\n// PUT TREE\r\n.case(\r\n  treeActions.put,\r\n  (state, {rootTree}) => {\r\n    const node = rootTree !== null\r\n    ? TreeNodeUtil._init(TreeUtil._get<Tree, TreeNode>(rootTree, baseTreeNode))\r\n    : null;\r\n    return ({\r\n      ...state,\r\n      manual: {...state.manual!, rootTree},\r\n      node,\r\n    });\r\n  }\r\n)\r\n.case(\r\n  treeActions.putSuccess,\r\n  (state, tree) => {\r\n    const node = tree !== null\r\n    ? TreeNodeUtil._init(TreeUtil._get<Tree, TreeNode>(tree, baseTreeNode))\r\n    : null;\r\n    if (node !== null) { node.label = state.manual!.title; }\r\n    return ({\r\n      ...state,\r\n      manual: {...state.manual!, rootTree: node},\r\n      node,\r\n    });\r\n  }\r\n)","import actionCreatorFactory from 'typescript-fsa';\r\nimport { Memo } from '../../../data-types/tree';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\nconst ACTIONS_MEMOS_SET = 'ACTIONS_MEMOS_SET';\r\nexport const ACTIONS_MEMOS_CHANGE = 'ACTIONS_MEMOS_CHANGE';\r\nconst ACTIONS_MEMOS_CHANGE_SUCCESS = 'ACTIONS_MEMOS_CHANGE_SUCCESS';\r\nconst ACTIONS_MEMOS_CHANGE_ERROR = 'ACTIONS_MEMOS_CHANGE_ERROR';\r\n\r\nexport const memosActions = {\r\n  set:           actionCreator<Memo[]>(ACTIONS_MEMOS_SET),\r\n  change:        actionCreator<Memo[]>(ACTIONS_MEMOS_CHANGE),\r\n  changeSuccess: actionCreator<Memo[]>(ACTIONS_MEMOS_CHANGE_SUCCESS),\r\n  changeError:   actionCreator<void>(ACTIONS_MEMOS_CHANGE_ERROR),\r\n};","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { memosActions } from '../../actions/main/memoAction';\r\nimport { Memo } from '../../../data-types/tree';\r\n\r\nexport interface MemosState {\r\n  memos: Memo[];\r\n}\r\n\r\nconst initialState: MemosState = {\r\n  memos: []\r\n};\r\n\r\nexport const memoReducer = reducerWithInitialState(initialState)\r\n.case(memosActions.set, (state, memos) => ({...state, memos}))\r\n.case(memosActions.change, (state, memos) => ({...state, memos}))\r\n.case(memosActions.changeSuccess, (state, memos) => ({...state, memos}))","const keys = {\r\n  ks: 'ks',\r\n  ft: 'ft',\r\n  rs: 'rs',\r\n  tes: 'tes',\r\n  tree: 'tree',\r\n  commonList: 'commonList',\r\n  memoList: 'memoList',\r\n}\r\n\r\nexport default keys;","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { ksActions } from '../actions/ksAction';\r\nimport KSize from '../../data-types/k-size';\r\nimport { defaultKS } from '../../settings/layout';\r\nimport keys from '../../settings/storage-keys';\r\n\r\nexport interface KSState {\r\n  ks: KSize;\r\n}\r\n\r\nconst ksString = localStorage.getItem(keys.ks);\r\nconst ks = ksString !== null ? JSON.parse(ksString) as KSize : defaultKS;\r\nconst initialState: KSState = { ks };\r\n\r\nexport const ksReducer = reducerWithInitialState(initialState)\r\n.case(ksActions.change, (state, ks) => ({...state, ks}))\r\n.case(ksActions.reset, (state) => ({...state, ks: defaultKS}))\r\n.case(ksActions.zoomIn, (state) => ({...state, ks: {...state.ks, unit: state.ks.unit + 2}}))\r\n.case(ksActions.zoomOut, (state) => ({...state, ks: {...state.ks, unit: state.ks.unit - 2}}))\r\n","import ReadingSetting from \"../data-types/reading-settings\";\r\n\r\nexport const defaultRS: ReadingSetting = {\r\n  playOnClick: false,\r\n  rate: 1,\r\n  pitch: 1,\r\n};","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport ReadingSetting from '../../data-types/reading-settings';\r\nimport { defaultRS } from '../../settings/reading';\r\nimport { rsActions } from '../actions/rsAction';\r\n\r\nexport interface RSState {\r\n  rs: ReadingSetting;\r\n}\r\n\r\nconst initialState: RSState = {\r\n  rs: defaultRS\r\n};\r\n\r\nexport const rsReducer = reducerWithInitialState(initialState)\r\n.case(rsActions.change, (state, rs) => ({...state, rs}))\r\n.case(rsActions.reset, (state) => ({...state, rs: defaultRS}))","import { LoginUser } from '../../../data-types/user';\r\n\r\nexport const user1: LoginUser = {\r\n  id: 'a',\r\n  lastName: '山田',\r\n  firstName: '太郎',\r\n  mail: 'user@user.com'\r\n};\r\n\r\nexport const user2: LoginUser = {\r\n  id: 'b',\r\n  lastName: '佐藤',\r\n  firstName: '花子',\r\n  mail: 'user@user.com'\r\n};\r\n\r\nexport const user3: LoginUser = {\r\n  id: 'c',\r\n  lastName: '江戸川',\r\n  firstName: 'コナン',\r\n  mail: 'user@user.com'\r\n};\r\n\r\nexport const user4: LoginUser = {\r\n  id: 'd',\r\n  lastName: '毛利',\r\n  firstName: '小五郎',\r\n  mail: 'user@user.com'\r\n};","import { Manual, baseTree, baseManual } from \"../../../data-types/tree\";\r\n\r\nexport const manual1: Manual = {\r\n  ...baseManual,\r\n  id: '1',\r\n  title: '企画マニュアル',\r\n  description: 'ここには企画マニュアルの説明。ここにはマニュアルの説明。ここにはマニュアルの説明。',\r\n  ownerId: 'a',\r\n  collaboratorIds:[],\r\n  categoryId: '1',\r\n  favoriteIds: ['a'],\r\n  likeIds: ['a', 'c', 'd'],\r\n  rootTree: null,\r\n  updateAt: 'yyyy/MM/dd hh:mm',\r\n  createAt: 'yyyy/MM/dd hh:mm',\r\n};\r\n\r\nexport const manual2: Manual = {\r\n  ...baseManual,\r\n  id: '2',\r\n  title: '営業マニュアル',\r\n  description: 'ここには営業マニュアルの説明。ここにはマニュアルの説明。ここにはマニュアルの説明。',\r\n  ownerId: 'a',\r\n  collaboratorIds:['b'],\r\n  categoryId: '2',\r\n  favoriteIds: ['b', 'd'],\r\n  likeIds: ['a'],\r\n  rootTree: null,\r\n  updateAt: 'yyyy/MM/dd hh:mm',\r\n  createAt: 'yyyy/MM/dd hh:mm',\r\n};\r\n\r\nexport const manual3: Manual = {\r\n  ...baseManual,\r\n  id: '3',\r\n  title: '人事マニュアル',\r\n  description: 'ここには人事マニュアルの説明。ここにはマニュアルの説明。ここにはマニュアルの説明。',\r\n  ownerId: 'c',\r\n  collaboratorIds:['b'],\r\n  categoryId: '3',\r\n  isPublic: false,\r\n  favoriteIds: [],\r\n  rootTree: null,\r\n  updateAt: 'yyyy/MM/dd hh:mm',\r\n  createAt: 'yyyy/MM/dd hh:mm',\r\n};\r\n\r\nexport const manual4: Manual = {\r\n  ...baseManual,\r\n  id: '4',\r\n  title: '企画マニュアル２',\r\n  description: 'ここには企画マニュアル２の説明。ここにはマニュアルの説明。ここにはマニュアルの説明。',\r\n  ownerId: 'a',\r\n  collaboratorIds:['b'],\r\n  categoryId: '1',\r\n  visible: false,\r\n  favoriteIds: ['a', 'c', 'd'],\r\n  likeIds: ['a', 'd'],\r\n  rootTree: null,\r\n  updateAt: 'yyyy/MM/dd hh:mm',\r\n  createAt: 'yyyy/MM/dd hh:mm',\r\n};\r\n\r\nexport const rootTree = {\r\n  ...baseTree,\r\n  id: '5',\r\n  label: '',\r\n  children:[\r\n    {...baseTree, id: '6', label: '手順１'},\r\n    {...baseTree, id: '7', label: '手順２'},\r\n    {...baseTree, id: '8', label: '手順３'},\r\n  ]\r\n}\r\n\r\n","import Category from \"../../../data-types/category\";\r\n\r\nexport const category1: Category = {\r\n  id: '1',\r\n  name: '企画'\r\n};\r\n\r\nexport const category2: Category = {\r\n  id: '2',\r\n  name: '営業'\r\n};\r\n\r\nexport const category3: Category = {\r\n  id: '3',\r\n  name: '人事'\r\n};","import UserGroup from \"../../../data-types/user-group\";\r\n\r\nexport const userGroup1: UserGroup = {\r\n  id: 'ga',\r\n  name: '営業チーム',\r\n  memberIds: ['a', 'b']\r\n};\r\n\r\nexport const userGroup2: UserGroup = {\r\n  id: 'gb',\r\n  name: '少年探偵団',\r\n  memberIds: ['c', 'd']\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { LoginPostResponse } from '../definitions';\r\nimport { user1, user2, user3, user4 } from './common-data/users';\r\nimport { manual1, manual2, manual3, manual4 } from './common-data/manuals';\r\nimport { category1, category2, category3 } from './common-data/categories';\r\nimport { userGroup1, userGroup2 } from './common-data/userGroups';\r\nimport Category from '../../data-types/category';\r\n\r\nexport const postLogin = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson);\r\n\r\n  const users = [user1, user2, user3, user4];\r\n  const userGroups = [userGroup1, userGroup2];\r\n  const manuals = [manual1, manual2, manual3, manual4];\r\n  const categories: Category[] = [...Array(300)]\r\n  .map(_ =>  [category1, category2, category3])\r\n  .reduce((a, b) => a.concat(b))\r\n  .map((c, i) => ({id: String(i), name: `${c.name} (${i})`}));\r\n\r\n  const data1: LoginPostResponse = {\r\n    user: user1,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data2: LoginPostResponse = {\r\n    user: user2,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data3: LoginPostResponse = {\r\n    user: user3,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data4: LoginPostResponse = {\r\n    user: user4,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data = req.id === 'a' ? data1 : req.id === 'b' ? data2 : req.id === 'c' ? data3 : data4;\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const deleteLogin = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data = {}\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { ManualPostResponse, ManualPostRequest, ManualPutResponse, ManualDeleteResponse, ManualGetResponse } from '../definitions';\r\nimport Util from '../../func/util';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport { manual1, manual2, manual3, manual4, rootTree as tree } from './common-data/manuals';\r\n\r\nexport const get = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const reversedURL = [...url!].reduceRight((p, c) => p + c);\r\n  const rootTree = cloneDeep(tree);\r\n  const data: ManualGetResponse =\r\n    reversedURL[0] === '1' ? {...manual1, rootTree} :\r\n    reversedURL[0] === '2' ? {...manual2, rootTree} :\r\n    reversedURL[0] === '3' ? {...manual3, rootTree} : {...manual4, rootTree};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const post = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as ManualPostRequest;\r\n\r\n  const data: ManualPostResponse = {\r\n    ...req, id: `${Util.getID()}`\r\n  };\r\n\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const put = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as ManualPostRequest;\r\n\r\n  const data: ManualPutResponse = {...req};\r\n\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const _delete = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data: ManualDeleteResponse = {};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport {\r\n  FavoritePostResponse,\r\n  FavoriteDeleteResponse\r\n} from '../definitions';\r\n\r\nexport const post = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data: FavoritePostResponse = {};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const _delete = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data: FavoriteDeleteResponse = {};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport {\r\n  LikePostResponse\r\n} from '../definitions';\r\n\r\nexport const post = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data: LikePostResponse = {};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};\r\n\r\nexport const _delete = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n  const data: LikePostResponse = {};\r\n\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { TreePutResponse } from '../definitions';\r\n\r\nexport const putTree = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson);\r\n\r\n  const data: TreePutResponse = {...req};\r\n\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { LoginUserPutRequest, LoginUserPutResponse } from '../definitions';\r\n\r\nexport const putLoginUser = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as LoginUserPutRequest;\r\n\r\n  const data: LoginUserPutResponse = {...req};\r\n\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { Password } from '../../data-types/password';\r\n\r\nexport const putPassword = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as Password;\r\n\r\n  console.log(method, url, req);\r\n  return [200]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { TitleCheckPostResponse } from '../definitions';\r\n\r\nexport const postTitleCheck = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as { title: string };\r\n  const data: TitleCheckPostResponse = {\r\n    title: req.title,\r\n    valid: true\r\n  }\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { GenerateTitleRequest, GenerateTitleResponse } from '../definitions';\r\n\r\nexport const postGenerateTitle = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as GenerateTitleRequest;\r\n  const data: GenerateTitleResponse = {\r\n    title: `${req.title} のコピー(${Math.ceil(Math.random() * 10)})`,\r\n    valid: true,\r\n  }\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { ManualsQueryResponse, ManualsQueryParams } from '../definitions';\r\nimport { manual1 } from './common-data/manuals';\r\n\r\nexport const postManualsQuery = (config: AxiosRequestConfig) => {\r\n  const { method, url, data: requestJson } = config;\r\n  const req = JSON.parse(requestJson) as ManualsQueryParams;\r\n  const { page, rowsPerPage } = req;\r\n  const count = 500;\r\n  const manuals = [...Array(rowsPerPage)].fill(true)\r\n  .map((t, i) => ({\r\n    ...manual1,\r\n    title: `${manual1.title}(${page * rowsPerPage + i + 1})`\r\n  }));\r\n\r\n\r\n  const data: ManualsQueryResponse = {\r\n    queryParams: req,\r\n    manuals,\r\n    count,\r\n  };\r\n\r\n  console.log(method, url, req, data);\r\n  return [200, data]\r\n};","import { AxiosRequestConfig } from 'axios';\r\nimport { LoginPostResponse } from '../definitions';\r\nimport { user1, user2, user3, user4 } from './common-data/users';\r\nimport { manual1, manual2, manual3, manual4 } from './common-data/manuals';\r\nimport { category1, category2, category3 } from './common-data/categories';\r\nimport { userGroup1, userGroup2 } from './common-data/userGroups';\r\nimport Category from '../../data-types/category';\r\n\r\nexport const postSessionCheck = (config: AxiosRequestConfig) => {\r\n  const { method, url } = config;\r\n\r\n  const users = [user1, user2, user3, user4];\r\n  const userGroups = [userGroup1, userGroup2];\r\n  const manuals = [manual1, manual2, manual3, manual4];\r\n  const categories: Category[] = [...Array(300)]\r\n  .map(_ =>  [category1, category2, category3])\r\n  .reduce((a, b) => a.concat(b))\r\n  .map((c, i) => ({id: String(i), name: `${c.name} (${i})`}));\r\n\r\n  const data1: LoginPostResponse = {\r\n    user: user1,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data2: LoginPostResponse = {\r\n    user: user2,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data3: LoginPostResponse = {\r\n    user: user3,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const data4: LoginPostResponse = {\r\n    user: user4,\r\n    users, userGroups, manuals, categories,\r\n  };\r\n\r\n  const rand = Math.floor(Math.random() * 8);\r\n  const data = rand < 4\r\n    ? [data1, data2, data3, data4].find((d, i) => i === rand)\r\n    : { error: {} };\r\n  console.log(method, url, data);\r\n  return [200, data]\r\n};","import axiosbase from 'axios';\r\nimport MockAdapter from 'axios-mock-adapter';\r\nimport { loginURL, manualURL, favoriteURL, likeURL, treeURL, usersURL, passwordURL, titleCheckURL, generateTitleURL, manualsURL, sessionCheckURL } from './definitions';\r\nimport { postLogin, deleteLogin } from './mock-data/login';\r\nimport * as Manual from './mock-data/manual';\r\nimport * as Favorite from './mock-data/favorite';\r\nimport * as Like from './mock-data/like';\r\nimport { putTree } from './mock-data/tree';\r\nimport { putLoginUser } from './mock-data/login-user';\r\nimport { putPassword } from './mock-data/password';\r\nimport { postTitleCheck } from './mock-data/title-checker';\r\nimport { postGenerateTitle } from './mock-data/generate-title';\r\nimport { postManualsQuery } from './mock-data/manuals';\r\nimport { postSessionCheck } from './mock-data/session-check';\r\n\r\nexport const baseURL = 'http://localhost:55616';\r\n\r\nconst mockAdapter = () => {\r\n  const mock = new MockAdapter(axiosbase, { delayResponse: 500 });\r\n  // login\r\n  mock.onPost(loginURL).reply(postLogin);\r\n  mock.onDelete(loginURL).reply(deleteLogin);\r\n\r\n  // session check\r\n  mock.onPost(sessionCheckURL).reply(postSessionCheck);\r\n\r\n  // LoginUser\r\n  const regexUsersURL = new RegExp(`${usersURL}/*`);\r\n  mock.onPut(regexUsersURL).reply(putLoginUser);\r\n\r\n  // Password\r\n  const regexPasswordURL = new RegExp(`${passwordURL}/*`);\r\n  mock.onPut(regexPasswordURL).reply(putPassword);\r\n\r\n  // manuals query\r\n  mock.onPost(manualsURL).reply(postManualsQuery);\r\n\r\n  // manual\r\n  const regexManualsURL = new RegExp(`${manualURL}/*`);\r\n  mock.onGet(regexManualsURL).reply(Manual.get);\r\n  mock.onPost(manualURL).reply(Manual.post);\r\n  mock.onPut(regexManualsURL).reply(Manual.put);\r\n  mock.onDelete(regexManualsURL).reply(Manual._delete);\r\n\r\n  \r\n  mock.onPost(titleCheckURL).reply(postTitleCheck);\r\n  mock.onPost(generateTitleURL).reply(postGenerateTitle);\r\n\r\n\r\n  // favorite\r\n  const regexFavoriteURL= new RegExp(`${favoriteURL}/*`);\r\n  mock.onPost(regexFavoriteURL).reply(Favorite.post);\r\n  mock.onDelete(regexFavoriteURL).reply(Favorite._delete);\r\n\r\n  // like\r\n  const regexLikeURL= new RegExp(`${likeURL}/*`);\r\n  mock.onPost(regexLikeURL).reply(Like.post);\r\n  mock.onDelete(regexLikeURL).reply(Like._delete);\r\n\r\n  // tree\r\n  const regexTreeURL = new RegExp(`${treeURL}/*`);\r\n  mock.onPut(regexTreeURL).reply(putTree);\r\n\r\n  return axiosbase;\r\n};\r\n\r\nconst axios = true ? mockAdapter() : axiosbase.create({\r\n    baseURL,\r\n    headers: {'Content-Type': 'application/json'},\r\n  });\r\n\r\nexport default axios;","import {\r\n  loginURL, LoginPostResponse,\r\n  sessionCheckURL, SessonCheckPostResponse, \r\n  usersURL, LoginUserPutRequest, LoginUserPutResponse, \r\n  manualURL, ManualPostRequest,\r\n  treeURL, TreePutRequest,\r\n  favoriteURL, FavoritePostRequestParams, FavoriteDeleteRequestParams,\r\n  likeURL, LikePostRequestParams, LikeDeleteRequestParams,\r\n  passwordURL, PasswordPutRequestParams,\r\n  titleCheckURL, TitleCheckPostRequest,\r\n  generateTitleURL, GenerateTitleRequest,\r\n} from \"./definitions\";\r\n\r\nimport axios from \"./axios\";\r\nimport { LoginInfo } from \"../redux/actions/loginAction\";\r\nimport { Password } from \"../data-types/password\";\r\n\r\nexport const login = (loginInfo: LoginInfo) => axios\r\n  .post<LoginPostResponse>(loginURL, loginInfo)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const logout = () => axios\r\n  .delete(loginURL)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const sessionCheck = () => axios\r\n  .post<SessonCheckPostResponse>(sessionCheckURL)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const loginUserPut = (user: LoginUserPutRequest) => axios\r\n  .put<LoginUserPutResponse>(`${usersURL}/${user.id}`, user)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\n  /**\r\n   * パスワード変更についてのロジックはprofileコンポーネントに直接記述したため、\r\n   * この\"passwordPut\"は使用していない。\r\n   */\r\nexport const passwordPut = (params: PasswordPutRequestParams) => axios\r\n  .put<Password>(`${passwordURL}/${params.user.id}`, params.password)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\n// export const manualsQuery = (queryParams: ManualsQueryParams) => axios\r\n//   .post<ManualsQueryResponse>(manualsURL, queryParams)\r\n//   .then(res => res.data)\r\n//   .catch(error => ({ error }));\r\n\r\nexport const manualGet = (manualId: string) => axios\r\n  .get(`${manualURL}/${manualId}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const manualPost = (manual: ManualPostRequest) => axios\r\n  .post<ManualPostRequest>(manualURL, manual)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const manualPut = (manual: ManualPostRequest) => axios\r\n  .put<ManualPostRequest>(`${manualURL}/${manual.id}`, manual)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const manualDelete = (manual: ManualPostRequest) => axios\r\n  .delete(`${manualURL}/${manual.id}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const titleCheckPost = (checkRequest: TitleCheckPostRequest) => axios\r\n  .post<TitleCheckPostRequest>(titleCheckURL, checkRequest)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const generateTitlePost = (original: GenerateTitleRequest) => axios\r\n  .post<GenerateTitleRequest>(generateTitleURL, original)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const favoritePost = (params: FavoritePostRequestParams) => axios\r\n  .post<void>(`${favoriteURL}/${params.manualId}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const favoriteDelete = (params: FavoriteDeleteRequestParams) => axios\r\n  .delete(`${favoriteURL}/${params.manualId}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const likePost = (params: LikePostRequestParams) => axios\r\n  .post<void>(`${likeURL}/${params.manualId}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const likeDelete = (params: LikeDeleteRequestParams) => axios\r\n  .delete(`${likeURL}/${params.manualId}`)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n\r\nexport const treePut = ({ manualId, rootTree }: TreePutRequest) => axios\r\n  .put(`${treeURL}/${manualId}`, rootTree)\r\n  .then(res => res.data)\r\n  .catch(error => ({ error }));\r\n","import actionCreatorFactory from 'typescript-fsa';\r\n\r\nexport interface LoginInfo {\r\n  id: string;\r\n  password: string;\r\n}\r\nexport const actionCreator = actionCreatorFactory();\r\nexport const ACTIONS_LOGIN = 'ACTIONS_LOGIN';\r\nexport const ACTIONS_LOGOUT = 'ACTIONS_LOGOUT';\r\n\r\nexport const loginActions = {\r\n  login:  actionCreator<LoginInfo>(ACTIONS_LOGIN),\r\n  logout: actionCreator<void>(ACTIONS_LOGOUT),\r\n};","import actionCreatorFactory from 'typescript-fsa';\r\nimport User from '../../../data-types/user';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const usersAction = {\r\n  change:  actionCreator<User[]>('ACTIONS_USER_CHANGE'),\r\n};","import actionCreatorFactory from 'typescript-fsa';\r\nimport Category from '../../../data-types/category';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const categoriesAction = {\r\n  set: actionCreator<Category[]>('ACTIONS_CATEGORIES_SET'),\r\n  filterSet: actionCreator<Category>('ACTIONS_CATEGORY_FILTER_SET'),\r\n  filterReset: actionCreator<void>('ACTIONS_CATEGORY_FILTER_RESET'),\r\n};\r\n","import actionCreatorFactory from 'typescript-fsa';\r\nimport { MyNotification } from '../states/notificationsState';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const notificationsAction = {\r\n  enqueue: actionCreator<MyNotification>('ACTIONS_NOTIFICATIONS_ENQUEUE'),\r\n  display: actionCreator<void>('ACTIONS_NOTIFICATIONS_DISPLAY'),\r\n  dequeue: actionCreator<number>('ACTIONS_NOTIFICATIONS_DEQUEUE'),\r\n  dismiss: actionCreator<void>('ACTIONS_NOTIFICATIONS_DISMISS'),\r\n  remove: actionCreator<number>('ACTIONS_NOTIFICATIONS_REMOVE'),\r\n};","import actionCreatorFactory from 'typescript-fsa';\r\n\r\nexport const actionCreator = actionCreatorFactory();\r\n\r\nexport const ACTIONS_LOADING_BEGIN_LOGIN = 'ACTIONS_LOADING_BEGIN_LOGIN';\r\nexport const ACTIONS_LOADING_END_LOGIN = 'ACTIONS_LOADING_END_LOGIN';\r\n\r\nexport const ACTIONS_LOADING_BEGIN_MANUAL_QUERY = 'ACTIONS_LOADING_BEGIN_MANUAL_QUERY';\r\nexport const ACTIONS_LOADING_END_MANUAL_QUERY = 'ACTIONS_LOADING_END_MANUAL_QUERY';\r\n\r\nexport const ACTIONS_LOADING_BEGIN_MANUAL = 'ACTIONS_LOADING_BEGIN_MANUAL';\r\nexport const ACTIONS_LOADING_END_MANUAL = 'ACTIONS_LOADING_END_MANUAL';\r\n\r\nexport const loadingActions = {\r\n  beginLogin:  actionCreator<void>(ACTIONS_LOADING_BEGIN_LOGIN),\r\n  endLogin: actionCreator<void>(ACTIONS_LOADING_END_LOGIN),\r\n  beginManualQuery:  actionCreator<void>(ACTIONS_LOADING_BEGIN_MANUAL_QUERY),\r\n  endManualQuery: actionCreator<void>(ACTIONS_LOADING_END_MANUAL_QUERY),\r\n  beginManual:  actionCreator<void>(ACTIONS_LOADING_BEGIN_MANUAL),\r\n  endManual: actionCreator<void>(ACTIONS_LOADING_END_MANUAL),\r\n};","import actionCreatorFactory from 'typescript-fsa';\r\nimport UserGroup from '../../../data-types/user-group';\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const userGroupsAction = {\r\n  change:  actionCreator<UserGroup[]>('ACTIONS_USERGROUPS_CHANGE'),\r\n};","import { AppState } from \"../store\";\r\n\r\nexport const getTitleForCheck = (state: AppState) => state.titleCheck;\r\nexport const getKSize = (state: AppState) => state.ks.ks;\r\nexport const getLoginUser = (state: AppState) => state.loginUser.user;\r\nexport const getUsers = (state: AppState) => state.users.users;","import actionCreatorFactory from 'typescript-fsa';\r\n\r\nexport interface TitleSet {\r\n  preTitle: string;\r\n  title: string;\r\n}\r\n\r\nexport interface TitleCheckResult {\r\n  title: string;\r\n  valid: boolean;\r\n}\r\n\r\nconst actionCreator = actionCreatorFactory();\r\n\r\nexport const ACTIONS_TITLECHECK_SET_PRETITLE = 'ACTIONS_TITLECHECK_SET_PRETITLE';\r\nexport const ACTIONS_TITLECHECK_ENQUEUE = 'ACTIONS_TITLECHECK_ENQUEUE';\r\nexport const ACTIONS_TITLECHECK_RESULT_GET = 'ACTIONS_TITLECHECK_RESULT_GET';\r\nexport const ACTIONS_TITLECHECK_GENERATE = 'ACTIONS_TITLECHECK_GENERATE';\r\nexport const ACTIONS_TITLECHECK_GENERATE_DONE = 'ACTIONS_TITLECHECK_GENERATE_DONE';\r\n\r\nexport const titleCheckAction = {\r\n  set: actionCreator<{preTitle: string; willGenerate?: string}>(ACTIONS_TITLECHECK_SET_PRETITLE),\r\n  enqueue: actionCreator<TitleSet>(ACTIONS_TITLECHECK_ENQUEUE),\r\n  get: actionCreator<TitleCheckResult>(ACTIONS_TITLECHECK_RESULT_GET),\r\n  generate: actionCreator<void>(ACTIONS_TITLECHECK_GENERATE),\r\n  done: actionCreator<TitleCheckResult>(ACTIONS_TITLECHECK_GENERATE_DONE),\r\n};","import { put, call, fork, take, select, throttle } from 'redux-saga/effects';\r\nimport { MyNotification } from './states/notificationsState';\r\nimport * as API from '../api/axios-func';\r\nimport { ACTIONS_LOGIN, ACTIONS_LOGOUT } from './actions/loginAction';\r\nimport { loginUserAction, ACTIONS_LOGINUSER_PUT, ACTIONS_LOGINUSER_PUT_SUCCESS, ACTIONS_LOGINUSER_START_SESSIONCHECK } from './actions/main/loginUserAction';\r\nimport { LoginPostResponse, TreePutRequest, GenerateTitleRequest, SessonCheckPostResponse } from '../api/definitions';\r\nimport * as ManualAction from './actions/main/manualsAction';\r\nimport { usersAction } from './actions/main/usersAction';\r\nimport { categoriesAction } from './actions/main/categoriesAction';\r\nimport { notificationsAction } from './actions/notificationsAction';\r\nimport { loadingActions } from './actions/loadingAction';\r\nimport { Manual } from '../data-types/tree';\r\nimport TreeUtil from '../func/tree';\r\nimport { userGroupsAction } from './actions/main/userGroupsAction';\r\nimport { getTitleForCheck, getKSize, getLoginUser, getUsers } from './selectors';\r\nimport { titleCheckAction, ACTIONS_TITLECHECK_ENQUEUE, ACTIONS_TITLECHECK_GENERATE } from './actions/titileCheckAction';\r\nimport { TitleCheckState } from './states/titleCheckState';\r\nimport { ACTIONS_KSIZE_CHANGE, ACTIONS_KSIZE_ZOOM_IN, ACTIONS_KSIZE_ZOOM_OUT } from './actions/ksAction';\r\nimport keys from '../settings/storage-keys';\r\nimport KSize from '../data-types/k-size';\r\nimport User from '../data-types/user';\r\n\r\nexport const getKey = () => new Date().getTime() + Math.random();\r\n\r\nfunction* handleRequestLogin() {\r\n  while (true) {\r\n    const action = yield take(ACTIONS_LOGIN);\r\n    yield put(loadingActions.beginLogin());\r\n    const data = yield call(API.login, action.payload);\r\n    yield put(loadingActions.endLogin());\r\n    if (data.error === undefined) {\r\n      const { user, users, userGroups, categories } = data as LoginPostResponse;\r\n      yield put(loginUserAction.set(user));\r\n      yield put(usersAction.change(users));\r\n      yield put(userGroupsAction.change(userGroups));\r\n      yield put(categoriesAction.set(categories));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestLogout() {\r\n  while (true) {\r\n    yield take(ACTIONS_LOGOUT);\r\n\r\n    const key = getKey();\r\n    const notification: MyNotification = { key, variant: 'info', message: 'ログアウトしています..' };\r\n    yield put(notificationsAction.enqueue(notification));\r\n\r\n    const data = yield call(API.logout);\r\n    yield put(notificationsAction.dequeue(key));\r\n    \r\n    if (data.error === undefined) {\r\n      yield put(loginUserAction.reset());\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'ログアウトしました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    } else {\r\n      const notification: MyNotification =\r\n      { key: getKey(), variant: 'warning', message: 'ログアウトに失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleSessionCheck() {\r\n  while (true) {\r\n    yield take(ACTIONS_LOGINUSER_START_SESSIONCHECK);\r\n    const data = yield call(API.sessionCheck);\r\n    yield put(loginUserAction.sessionChecked());\r\n    if (data.error === undefined) {\r\n      const { user, users, userGroups, categories } = data as SessonCheckPostResponse;\r\n      yield put(loginUserAction.set(user));\r\n      yield put(usersAction.change(users));\r\n      yield put(userGroupsAction.change(userGroups));\r\n      yield put(categoriesAction.set(categories));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPutLoginUser() {\r\n  while (true) {\r\n    const action = yield take(ACTIONS_LOGINUSER_PUT);\r\n    yield put(loadingActions.beginLogin());\r\n    const data = yield call(API.loginUserPut, action.payload);\r\n    yield put(loadingActions.endLogin());\r\n    if (data.error === undefined) {\r\n      yield put(loginUserAction.putSuccess());\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'プロフィールを更新しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    } else {\r\n      yield put(loginUserAction.putError());\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'プロフィールの更新に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleUpdateLoginUser() {\r\n  while (true) {\r\n    yield take(ACTIONS_LOGINUSER_PUT_SUCCESS);\r\n    const user: User = yield select(getLoginUser);\r\n    const users: User[] = yield select(getUsers);\r\n    yield put(usersAction.change(users.map(u => u.id === user.id ? user : u)))\r\n  }\r\n}\r\n\r\nfunction* handleRequestGetManual() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_MANUAL_GET);\r\n    yield put(loadingActions.beginManual());\r\n    const data = yield call(API.manualGet, action.payload);\r\n    yield put(loadingActions.endManual());\r\n    if (data.error === undefined) {\r\n      yield put(ManualAction.manualAction.getSuccess(data));\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルの読み込みに失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPostManual() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_MANUAL_POST);\r\n    const data = yield call(API.manualPost, action.payload);\r\n    if (data.error === undefined) {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'マニュアルを新規作成しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルの作成に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPutManual() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_MANUAL_PUT);\r\n    const data = yield call(API.manualPut, action.payload);\r\n    if (data.error === undefined) {\r\n      yield put(ManualAction.manualAction.putSuccess(data));\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'マニュアルを保存しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルの保存に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestDeleteManual() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_MANUAL_DELETE);\r\n    const data = yield call(API.manualDelete, action.payload);\r\n    if (data.error === undefined) {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'マニュアルを削除しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルの削除に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleTitleCheck() {\r\n  const { title, preTitle }: TitleCheckState = yield select(getTitleForCheck);\r\n  if (title !== '' && title !== preTitle) {\r\n    const data = yield call(API.titleCheckPost, {title});\r\n    yield put(titleCheckAction.get(data));\r\n  }\r\n}\r\n\r\nfunction* handleRequestGenerateTitle() {\r\n  while (true) {\r\n    yield take(ACTIONS_TITLECHECK_GENERATE);\r\n    const titleCheckState: TitleCheckState = yield select(getTitleForCheck);\r\n    const requestBody: GenerateTitleRequest = { title: titleCheckState.seed! };\r\n    const data = yield call(API.generateTitlePost, requestBody);\r\n    if (data.error === undefined) {\r\n      yield put(titleCheckAction.done(data));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleManualCopy() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_MANUAL_COPY);\r\n    const manual: Manual = action.payload;\r\n    yield put(ManualAction.manualAction.postForCopy(manual));\r\n    const manualPostRes = yield call(API.manualPost, action.payload);\r\n    if (manualPostRes.error === undefined) {\r\n      \r\n      if (manual.rootTree !== null) {\r\n        const tree = TreeUtil._clearId(manual.rootTree);\r\n        const params: TreePutRequest = {\r\n          manualId: (manualPostRes as Manual).id,\r\n          rootTree: tree\r\n        }\r\n        const treePutRes = yield call(API.treePut, params);\r\n        if (treePutRes.error === undefined) {\r\n          yield put(ManualAction.treeActions.putSuccess(tree));\r\n          const notification: MyNotification =\r\n            { key: getKey(), variant: 'success', message: 'マニュアルをコピーしました' };\r\n          yield put(notificationsAction.enqueue(notification));\r\n        } else {\r\n          yield put(ManualAction.treeActions.putError(params.manualId));\r\n          const notification: MyNotification =\r\n            { key: getKey(), variant: 'warning', message: 'マニュアルのコピーに失敗しました' };\r\n          yield put(notificationsAction.enqueue(notification));\r\n        }\r\n      }\r\n\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルのコピーに失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPostFavorite() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_FAVORITE_POST);\r\n    const data = yield call(API.favoritePost, action.payload);\r\n    if (data.error === undefined) {\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'お気に入り登録に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestDeleteFavorite() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_FAVORITE_DELETE);\r\n    const data = yield call(API.favoriteDelete, action.payload);\r\n    if (data.error === undefined) {\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'お気に入り解除に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPostLike() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_LIKE_POST);\r\n    const data = yield call(API.likePost, action.payload);\r\n    if (data.error === undefined) {\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'いいね登録に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestDeleteLike() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_LIKE_DELETE);\r\n    const data = yield call(API.likeDelete, action.payload);\r\n    if (data.error === undefined) {\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'いいね解除に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* handleRequestPutTree() {\r\n  while (true) {\r\n    const action = yield take(ManualAction.ACTIONS_TREE_PUT);\r\n    const data = yield call(API.treePut, action.payload);\r\n    if (data.error === undefined) {\r\n      yield put(ManualAction.treeActions.putSuccess(data));\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'マニュアルを保存しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    } else {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'warning', message: 'マニュアルの保存に失敗しました' };\r\n      yield put(notificationsAction.enqueue(notification));\r\n    }\r\n  }\r\n}\r\n\r\nfunction* saveByChangeKS() {\r\n  while (true) {\r\n    yield take(ACTIONS_KSIZE_CHANGE);\r\n    const ks: KSize = yield select(getKSize);\r\n    localStorage.setItem(keys.ks, JSON.stringify(ks));\r\n  }\r\n}\r\n\r\nfunction* saveByZoomInKS() {\r\n  while (true) {\r\n    yield take(ACTIONS_KSIZE_ZOOM_IN);\r\n    const ks: KSize = yield select(getKSize);\r\n    localStorage.setItem(keys.ks, JSON.stringify(ks));\r\n  }\r\n}\r\n\r\nfunction* saveByZoomOutKS() {\r\n  while (true) {\r\n    yield take(ACTIONS_KSIZE_ZOOM_OUT);\r\n    const ks: KSize = yield select(getKSize);\r\n    localStorage.setItem(keys.ks, JSON.stringify(ks));\r\n  }\r\n}\r\n\r\n\r\nexport function* rootSaga() {\r\n  yield fork(handleRequestLogin);\r\n  yield fork(handleRequestLogout);\r\n\r\n  yield fork(handleSessionCheck);\r\n\r\n  yield fork(handleRequestPutLoginUser);\r\n  yield fork(handleUpdateLoginUser);\r\n\r\n  yield fork(handleRequestGetManual);\r\n  yield fork(handleRequestPostManual);\r\n  yield fork(handleRequestPutManual);\r\n  yield fork(handleRequestDeleteManual);\r\n\r\n  yield throttle(1000, ACTIONS_TITLECHECK_ENQUEUE, handleTitleCheck);\r\n  yield fork(handleRequestGenerateTitle);\r\n  yield fork(handleManualCopy);\r\n\r\n  yield fork(handleRequestPostFavorite);\r\n  yield fork(handleRequestDeleteFavorite);\r\n  \r\n  yield fork(handleRequestPostLike);\r\n  yield fork(handleRequestDeleteLike);\r\n\r\n  yield fork(handleRequestPutTree);\r\n\r\n  yield fork(saveByChangeKS);\r\n  yield fork(saveByZoomInKS);\r\n  yield fork(saveByZoomOutKS);\r\n}","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { categoriesAction } from '../../actions/main/categoriesAction';\r\nimport Category from '../../../data-types/category';\r\n\r\nexport interface CategoriesState {\r\n  categories: Category[];\r\n  filter: Category | null;\r\n}\r\n\r\nconst initialState: CategoriesState = {\r\n  categories: [],\r\n  filter: null\r\n};\r\n\r\nexport const categoriesReducer = reducerWithInitialState(initialState)\r\n.case(categoriesAction.set, (state, categories) => ({...state, categories}))\r\n.case(categoriesAction.filterSet, (state, filter) => ({...state, filter}))\r\n.case(categoriesAction.filterReset, (state) => ({...state, filter: null}))","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport User from '../../../data-types/user';\r\nimport { usersAction } from '../../actions/main/usersAction';\r\n\r\nexport interface UsersState {\r\n  users: User[];\r\n}\r\n\r\nconst initialState: UsersState = {\r\n  users: []\r\n};\r\n\r\nexport const usersReducer = reducerWithInitialState(initialState)\r\n.case(usersAction.change, (state, users) => ({...state, users}))","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\n\r\nimport { VariantType } from 'notistack';\r\nimport { notificationsAction } from '../actions/notificationsAction';\r\n\r\nexport interface MyNotification {\r\n  key: number;\r\n  variant: VariantType;\r\n  message: string;\r\n}\r\n\r\nexport interface NotificationsState {\r\n  enqueue: MyNotification | null;\r\n  dequeue: MyNotification | null;\r\n  displayed: MyNotification[];\r\n}\r\n\r\nconst initialState: NotificationsState = {\r\n  enqueue: null,\r\n  dequeue: null,\r\n  displayed: [],\r\n};\r\n\r\nexport const notificationsReducer = reducerWithInitialState(initialState)\r\n.case(\r\n  notificationsAction.enqueue,\r\n  (state, notification) => ({...state, enqueue: notification})\r\n)\r\n.case(\r\n  notificationsAction.display,\r\n  (state) => ({...state, enqueue: null, displayed: state.displayed.concat([state.enqueue!])})\r\n)\r\n.case(\r\n  notificationsAction.dequeue,\r\n  (state, key) => {\r\n    const dequeue = state.displayed.find(d => d.key === key)!\r\n    return {...state, dequeue};\r\n  }\r\n)\r\n.case(\r\n  notificationsAction.dismiss,\r\n  (state) => ({...state, dequeue: null})\r\n)\r\n.case(\r\n  notificationsAction.remove,\r\n  (state, key) => ({...state, displayed: state.displayed.filter(n => n.key !== key)})\r\n)\r\n","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { loadingActions } from '../actions/loadingAction';\r\n\r\nexport interface LoadingState {\r\n  loginLoading: boolean;\r\n  manualsLoading: boolean;\r\n  manualLoading: boolean;\r\n}\r\n\r\nconst initialState: LoadingState = {\r\n  loginLoading: false,\r\n  manualsLoading: false,\r\n  manualLoading: false,\r\n};\r\n\r\nexport const loadingReducer = reducerWithInitialState(initialState)\r\n.case(loadingActions.beginLogin, (state) => ({...state, loginLoading: true}))\r\n.case(loadingActions.endLogin, (state) => ({...state, loginLoading: false}))\r\n\r\n.case(loadingActions.beginManualQuery, (state) => ({...state, manualsLoading: true}))\r\n.case(loadingActions.endManualQuery, (state) => ({...state, manualsLoading: false}))\r\n\r\n.case(loadingActions.beginManual, (state) => ({...state, manualLoading: true}))\r\n.case(loadingActions.endManual, (state) => ({...state, manualLoading: false}))\r\n","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport UserGroup from '../../../data-types/user-group';\r\nimport { userGroupsAction } from '../../actions/main/userGroupsAction';\r\n\r\nexport interface UserGroupsState {\r\n  userGroups: UserGroup[];\r\n}\r\n\r\nconst initialState: UserGroupsState = {\r\n  userGroups: []\r\n};\r\n\r\nexport const userGroupsReducer = reducerWithInitialState(initialState)\r\n.case(userGroupsAction.change, (state, userGroups) => ({...state, userGroups}))","import { reducerWithInitialState } from 'typescript-fsa-reducers';\r\nimport { TitleCheckResult, titleCheckAction } from '../actions/titileCheckAction';\r\n\r\nexport interface TitleCheckState {\r\n  preTitle: string;\r\n  title: string;\r\n  result: TitleCheckResult | null;\r\n  seed: string | null;\r\n}\r\n\r\nconst initialState: TitleCheckState = {\r\n  preTitle: '',\r\n  title: '',\r\n  result: null,\r\n  seed: null,\r\n};\r\n\r\nexport const titleCheckReducer = reducerWithInitialState(initialState)\r\n.case(\r\n  titleCheckAction.set,\r\n  (state, { preTitle, willGenerate }) => (\r\n    {...state, preTitle, title: preTitle, result: null, seed: willGenerate !== undefined ? willGenerate : null}\r\n  )\r\n)\r\n.case(\r\n  titleCheckAction.enqueue,\r\n  (state, titleSet) => titleSet.title !== '' ? {...state, ...titleSet} : {...state, ...titleSet, result: null}\r\n)\r\n.case(\r\n  titleCheckAction.get,\r\n  (state, result) => ({...state, result})\r\n)\r\n.case(\r\n  titleCheckAction.done,\r\n  (state, result) => ({...state, result, title: result.title})\r\n)","import { createStore, combineReducers, applyMiddleware, compose } from 'redux';\r\nimport { LoginUserState,  loginUserReducer }    from './states/main/loginUserState';\r\nimport { ManualState, manualReducer }   from './states/main/manualsState';\r\nimport { MemosState, memoReducer } from './states/main/memoState';\r\nimport { KSState, ksReducer } from './states/ksState';\r\nimport { RSState, rsReducer } from './states/rsState';\r\nimport createSagaMiddleware from '@redux-saga/core';\r\nimport { rootSaga } from './saga';\r\nimport { CategoriesState, categoriesReducer } from './states/main/categoriesState';\r\nimport { UsersState, usersReducer } from './states/main/usersState';\r\nimport { NotificationsState, notificationsReducer } from './states/notificationsState';\r\nimport { LoadingState, loadingReducer } from './states/loadingState';\r\nimport { UserGroupsState, userGroupsReducer } from './states/main/userGroupsState';\r\nimport { TitleCheckState, titleCheckReducer } from './states/titleCheckState';\r\n\r\nexport type AppState = {\r\n  loading: LoadingState;\r\n  loginUser: LoginUserState;\r\n  users: UsersState;\r\n  userGroups: UserGroupsState;\r\n  manual: ManualState;\r\n  categories: CategoriesState;\r\n  memos: MemosState;\r\n  notifications: NotificationsState;\r\n  titleCheck: TitleCheckState;\r\n  ks: KSState;\r\n  rs: RSState;\r\n};\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\nconst composeEnhancers = (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(\r\n  combineReducers<AppState>({\r\n    loading: loadingReducer,\r\n    loginUser: loginUserReducer,\r\n    users: usersReducer,\r\n    userGroups: userGroupsReducer,\r\n    manual: manualReducer,\r\n    categories: categoriesReducer,\r\n    memos: memoReducer,\r\n    notifications: notificationsReducer,\r\n    titleCheck: titleCheckReducer,\r\n    ks: ksReducer,\r\n    rs: rsReducer,\r\n  }),\r\n  composeEnhancers(applyMiddleware(sagaMiddleware))\r\n);\r\n\r\nsagaMiddleware.run(rootSaga)\r\n\r\nexport default store;","const links = {\r\n  dashboard: '/wolf/',\r\n  follows: '/wolf/follows',\r\n  login: '/wolf/login',\r\n  \r\n  edit: '/wolf/edit',\r\n  text: '/wolf/text',\r\n};\r\n\r\nexport default links;","import * as React from 'react';\r\nimport {useState} from 'react';\r\nimport { makeStyles, Theme, Paper, Avatar, Typography, TextField, Button, CircularProgress } from '@material-ui/core';\r\nimport { InputAdornment, IconButton } from '@material-ui/core';\r\nimport { VisibilityOff, Visibility } from '@material-ui/icons';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport { LoginActions } from './login-container';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  main: {\r\n    width: 'auto',\r\n    display: 'block', // Fix IE 11 issue.\r\n    marginLeft: theme.spacing(3),\r\n    marginRight: theme.spacing(3),\r\n    [theme.breakpoints.up(400 + theme.spacing(3 * 2))]: {\r\n      width: 400,\r\n      marginLeft: 'auto',\r\n      marginRight: 'auto',\r\n    },\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    padding: `${theme.spacing(2)}px ${theme.spacing(3)}px ${theme.spacing(3)}px`,\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  textField: {\r\n    marginTop: theme.spacing(2),\r\n  },\r\n  wrapper: {\r\n    marginTop: theme.spacing(3),\r\n    position: 'relative',\r\n    width: '100%'\r\n  },\r\n  buttonProgress: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12,\r\n  },\r\n}));\r\n\r\ninterface Props extends LoginActions {\r\n  loading: boolean;\r\n}\r\n\r\nconst LoginComponent: React.FC<Props> = ({loading, login}) => {\r\n  const [id, setId] = useState('a');\r\n  const [password, setPassword] = useState('password');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const handleChangeId = (e: any) => setId(e.target.value);\r\n  const handleChangePassword = (e: any) => setPassword(e.target.value);\r\n  const handleChangeShowPassword = () => setShowPassword(!showPassword);\r\n\r\n  const handleLogin = () => {\r\n    login({id, password});\r\n  }\r\n\r\n  const classes = useStyles();\r\n  return (\r\n    <main className={classes.main}>\r\n      <Paper className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">Flow Like</Typography>\r\n\r\n        <TextField\r\n          className={classes.textField}\r\n          label=\"ID\"\r\n          variant=\"outlined\"\r\n          value={id}\r\n          onChange={handleChangeId}\r\n          fullWidth\r\n          margin=\"normal\"\r\n        />\r\n        <TextField\r\n          className={classes.textField}\r\n          label=\"パスワード\"\r\n          type={showPassword ? 'text' : 'password'}\r\n          value={password}\r\n          onChange={handleChangePassword}\r\n          InputProps={{\r\n            endAdornment: (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  aria-label=\"Toggle password visibility\"\r\n                  onClick={handleChangeShowPassword}\r\n                >\r\n                  {showPassword ? <VisibilityOff /> : <Visibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n          fullWidth\r\n        />\r\n        <div className={classes.wrapper}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            size=\"large\"\r\n            disabled={loading}\r\n            onClick={handleLogin}\r\n            fullWidth\r\n          >\r\n            ログイン\r\n          </Button>\r\n          {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n        </div>\r\n        \r\n      </Paper>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport default LoginComponent;\r\n","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { loginActions, LoginInfo } from '../../redux/actions/loginAction';\r\nimport LoginComponent from './login-component';\r\nimport { AppState } from '../../redux/store';\r\n\r\nexport interface LoginActions {\r\n  login: (loginInfo: LoginInfo) => void;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return { loading: appState.loading.loginLoading };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    login: (loginInfo: LoginInfo) => dispatch(loginActions.login(loginInfo)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginComponent);\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Dispatch } from 'redux';\r\nimport { Action } from 'typescript-fsa';\r\nimport { TitleCheckState } from '../../redux/states/titleCheckState';\r\nimport { AppState } from '../../redux/store';\r\nimport { titleCheckAction, TitleSet } from '../../redux/actions/titileCheckAction';\r\nimport { TextField, InputAdornment, CircularProgress } from '@material-ui/core';\r\nimport { Check, Error } from '@material-ui/icons';\r\nimport { green, red } from '@material-ui/core/colors';\r\nimport { debounce } from 'lodash';\r\n\r\ninterface Props extends TitleCheckState {\r\n  defaultTitle: string;\r\n  disabled?: boolean;\r\n  willGenerate?: string;\r\n  set: (params: {preTitle: string; willGenerate?: string}) => Action<{preTitle: string; willGenerate?: string}>;\r\n  generate: () => Action<void>;\r\n  enqueue: (titleSet: TitleSet) => Action<TitleSet>;\r\n}\r\n\r\nconst TitleChecker: React.FC<Props> = props => {\r\n  const {defaultTitle, disabled, willGenerate, title, result, set, generate, enqueue} = props;\r\n  const [isFirstRender, setIsFirstRender] = useState(true);\r\n  if (isFirstRender) {\r\n    setIsFirstRender(false);\r\n    set({preTitle: defaultTitle, willGenerate});\r\n    if (willGenerate !== undefined) {\r\n      generate()\r\n    }\r\n  }\r\n\r\n  const [currentTitle, setCurrentTitle] = useState<string>(defaultTitle);\r\n  const debounced = useRef(\r\n    debounce((title: string) => {\r\n      enqueue({preTitle: defaultTitle, title});\r\n    }, 500)\r\n  );\r\n  useEffect(() => debounced.current(currentTitle), [currentTitle]);\r\n  \r\n  const handleChangeTitle = (e: any) => {\r\n    setCurrentTitle(e.target.value);\r\n  };\r\n\r\n  const renderAdornment = (title !== '' && title !== defaultTitle) ? (\r\n    <InputAdornment position=\"end\">\r\n      {(result === null || title !== result.title) ? <CircularProgress size={24}/> :\r\n      result.valid ? <Check style={{color: green[300]}}/> : <Error style={{color: red[300]}}/>}\r\n    </InputAdornment>\r\n  ) : undefined;\r\n\r\n  const helperText: string | undefined =\r\n  title === defaultTitle ? '' :\r\n  title === '' ? '' :\r\n  result === null ? '' :\r\n  title !== result.title ? '-' :\r\n  result.valid ? 'このタイトルは使用可能です' : 'このタイトルは重複しているため使用できません';\r\n  \r\n  return (\r\n    <TextField\r\n      label=\"マニュアルの名称\"\r\n      value={currentTitle}\r\n      onChange={handleChangeTitle}\r\n      InputProps={{ endAdornment: renderAdornment }}\r\n      helperText={helperText}\r\n      disabled={disabled !== undefined && disabled}\r\n      fullWidth\r\n    />\r\n  );\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {...appState.titleCheck};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    set: (params: {preTitle: string; willGenerate?: string}) => dispatch(titleCheckAction.set(params)),\r\n    generate: () => dispatch(titleCheckAction.generate()),\r\n    enqueue: (titleSet: TitleSet) => dispatch(titleCheckAction.enqueue(titleSet)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TitleChecker);","import React from 'react';\r\nimport Downshift, { GetItemPropsOptions } from 'downshift';\r\nimport { makeStyles, Theme, Paper } from '@material-ui/core';\r\n\r\nimport deburr from 'lodash/deburr';\r\nimport TextField, { TextFieldProps } from '@material-ui/core/TextField';\r\nimport MenuItem, { MenuItemProps } from '@material-ui/core/MenuItem';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    flexGrow: 1,\r\n    height: 250,\r\n  },\r\n  container: {\r\n    flexGrow: 1,\r\n    position: 'relative',\r\n  },\r\n  paper: {\r\n    position: 'absolute',\r\n    zIndex: 2000,\r\n    marginTop: theme.spacing(1),\r\n    left: 0,\r\n    right: 0,\r\n  },\r\n  chip: {\r\n    margin: theme.spacing(0.5, 0.25),\r\n  },\r\n  inputRoot: {\r\n    flexWrap: 'wrap',\r\n  },\r\n  inputInput: {\r\n    width: 'auto',\r\n    flexGrow: 1,\r\n  },\r\n  divider: {\r\n    height: theme.spacing(2),\r\n  },\r\n}),\r\n);\r\n\r\ninterface AutoSingleSelectProps {\r\n  inputLabel?: string;\r\n  placeholder?: string;\r\n  suggestions: any[];\r\n  labelProp: string;\r\n  initialSelectedItem?: string | null;\r\n  onChange: (selectedItem: any) => void;\r\n  willReset?: boolean;\r\n  setWillReset?: (will: boolean) => void;\r\n  disabled?: boolean;\r\n}\r\n\r\ntype RenderInputProps = TextFieldProps & {\r\n  classes: ReturnType<typeof useStyles>;\r\n  ref?: React.Ref<HTMLDivElement>;\r\n};\r\n\r\nconst AutoSingleSelect: React.FC<AutoSingleSelectProps> = props => {\r\n\r\n  const {\r\n    inputLabel = '',\r\n    placeholder = '',\r\n    suggestions,\r\n    labelProp,\r\n    initialSelectedItem = null,\r\n    onChange,\r\n    willReset,\r\n    setWillReset,\r\n    disabled,\r\n  } = props\r\n  \r\n  function renderInput(inputProps: RenderInputProps) {\r\n    const { InputProps, classes, ref, ...other } = inputProps;\r\n  \r\n    return (\r\n      <TextField\r\n        InputProps={{\r\n          inputRef: ref,\r\n          classes: { root: classes.inputRoot, input: classes.inputInput },\r\n          ...InputProps,\r\n        }}\r\n        {...other}\r\n        disabled={disabled}\r\n      />\r\n    );\r\n  }\r\n\r\n  function getSuggestions(value: string, { showEmpty = false } = {}) {\r\n    const inputValue = deburr(value.trim()).toLowerCase();\r\n    const inputLength = inputValue.length;\r\n    let count = 0;\r\n  \r\n    return inputLength === 0 && !showEmpty\r\n      ? []\r\n      : suggestions.filter(suggestion => {\r\n          const keep = count < 5 && suggestion[labelProp].slice(0, inputLength).toLowerCase() === inputValue;\r\n          if (keep) { count += 1; }\r\n          return keep;\r\n        });\r\n  }\r\n\r\n  interface RenderSuggestionProps {\r\n    highlightedIndex: number | null;\r\n    index: number;\r\n    itemProps: MenuItemProps<'div', { button?: never }>;\r\n    selectedItem: string;\r\n    item: any;\r\n  }\r\n  \r\n  function renderSuggestion(suggestionProps: RenderSuggestionProps) {\r\n    const { item, index, itemProps, highlightedIndex, selectedItem } = suggestionProps;\r\n    const isHighlighted = highlightedIndex === index;\r\n    const isSelected = (selectedItem || '').indexOf(item[labelProp]) > -1;\r\n  \r\n    return (\r\n      <MenuItem\r\n        {...itemProps}\r\n        key={item[labelProp]}\r\n        selected={isHighlighted}\r\n        component=\"div\"\r\n        style={{fontWeight: isSelected ? 500 : 400}}\r\n      >\r\n        {item[labelProp]}\r\n      </MenuItem>\r\n    );\r\n  }\r\n\r\n  interface RenderSuggestionListProps {\r\n    inputValue: string | null;\r\n    highlightedIndex: number | null;\r\n    selectedItem: string;\r\n    getItemProps: (options: GetItemPropsOptions<any>) => any;\r\n  }\r\n  function renderSuggestionList(listProps: RenderSuggestionListProps) {\r\n    const { inputValue, getItemProps, highlightedIndex, selectedItem } = listProps;\r\n    return getSuggestions(inputValue!, { showEmpty: true }).map((item, index) =>\r\n      renderSuggestion({\r\n        item,\r\n        index,\r\n        itemProps: getItemProps({ item: item[labelProp] }),\r\n        highlightedIndex,\r\n        selectedItem,\r\n      }),\r\n    );\r\n  }\r\n\r\n  const classes = useStyles();\r\n  return (\r\n    <Downshift\r\n      initialSelectedItem={initialSelectedItem}\r\n      onChange={onChange}\r\n    >\r\n      {({\r\n        getInputProps,\r\n        getItemProps,\r\n        getLabelProps,\r\n        getMenuProps,\r\n        highlightedIndex,\r\n        inputValue,\r\n        isOpen,\r\n        selectedItem,\r\n        openMenu,\r\n        clearSelection,\r\n      }) => {\r\n        const { onBlur, onFocus, ...inputProps } = getInputProps({\r\n          onChange: (event: React.ChangeEvent<HTMLInputElement>) => {\r\n            if (event.target.value === '') {\r\n              clearSelection();\r\n            }\r\n          },\r\n          onFocus: openMenu,\r\n          placeholder\r\n        });\r\n\r\n        if (willReset) {\r\n          clearSelection();\r\n          setWillReset !== undefined && setWillReset(false);\r\n        }\r\n\r\n        return (\r\n          <div className={classes.container}>\r\n            {renderInput({\r\n              fullWidth: true,\r\n              classes,\r\n              label: inputLabel,\r\n              InputLabelProps: getLabelProps({ shrink: true } as any),\r\n              InputProps: { onBlur, onChange, onFocus },\r\n              inputProps,\r\n            })}\r\n            <div {...getMenuProps()}>\r\n              {isOpen && (\r\n                <Paper className={classes.paper} square>\r\n                  {renderSuggestionList({ inputValue, getItemProps, highlightedIndex, selectedItem })}\r\n                </Paper>)}\r\n            </div>\r\n          </div>\r\n        );\r\n      }}\r\n    </Downshift>\r\n  );\r\n}\r\n\r\nexport default AutoSingleSelect;","import * as React from 'react';\r\nimport { useState } from 'react';\r\n\r\nimport {\r\n  Theme, FormControlLabel, Switch,\r\n  Button, DialogTitle, DialogContent, DialogActions, makeStyles, Box,\r\n} from '@material-ui/core';\r\nimport { CreateManualActions } from './create-manual-container';\r\nimport { baseManual, Manual, baseTree } from '../../../data-types/tree';\r\nimport User from '../../../data-types/user';\r\nimport Util from '../../../func/util';\r\nimport { CategoriesState } from '../../../redux/states/main/categoriesState';\r\nimport TitleChecker from '../../../components/title-checker/title-checker';\r\nimport { TitleCheckState } from '../../../redux/states/titleCheckState';\r\nimport AutoSingleSelect from '../../../components/auto-single-select/auto-single-select';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  switch: {\r\n    minWidth: 150,\r\n    margin: theme.spacing(1),\r\n    marginBottom: 0,\r\n  }\r\n}));\r\n\r\ninterface Props extends CategoriesState, TitleCheckState, CreateManualActions {\r\n  user: User;\r\n  onClose: () => void;\r\n}\r\n\r\nconst CreateManualComponent: React.FC<Props> = props => {\r\n\r\n  const { categories, filter, onClose, title, result } = props;\r\n  const [categoryId, setCategoryId] = useState(categories[0].id);\r\n  const handleCategorySelect = (item: string | null) => {\r\n    if (item !== null) {\r\n      setCategoryId(categories.find(c => c.name === item)!.id);\r\n    }\r\n  }\r\n\r\n  const [isPublic, setIsPublic] = useState(true);\r\n  const handleIsPublic = (e: any) => setIsPublic(e.target.checked);\r\n  const close = () => {\r\n    setIsPublic(true);\r\n    onClose();\r\n  }\r\n\r\n  const create = () => {\r\n    const {user, add} = props;\r\n    const newManual: Manual = {\r\n      ...baseManual, id: Util.getID(), title, categoryId, isPublic, ownerId: user.id, rootTree: baseTree\r\n    };\r\n    add(newManual);\r\n    close();\r\n  };\r\n  const classes = useStyles();\r\n  return (\r\n    <>\r\n      <DialogTitle>マニュアルの新規作成</DialogTitle>\r\n      <DialogContent style={{minHeight: 400}}>\r\n        <TitleChecker defaultTitle=\"\"/>\r\n        <Box py={2}>\r\n          <AutoSingleSelect\r\n            inputLabel=\"カテゴリー\"\r\n            suggestions={categories}\r\n            labelProp=\"name\"\r\n            initialSelectedItem={filter !== null ? filter.name : null}\r\n            onChange={handleCategorySelect}\r\n          />\r\n        </Box>\r\n        <FormControlLabel\r\n          className={classes.switch}\r\n          control={<Switch checked={isPublic} onChange={handleIsPublic} color=\"primary\"/>}\r\n          label=\"公開\"\r\n        />\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close}>キャンセル</Button>\r\n        <Button\r\n          onClick={create}\r\n          color=\"primary\"\r\n          disabled={title === '' || result === null || title !== result.title}\r\n        >\r\n          作成\r\n        </Button>\r\n      </DialogActions>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateManualComponent;","import { Action } from 'typescript-fsa';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../redux/store';\r\nimport { manualAction } from '../../../redux/actions/main/manualsAction';\r\nimport { Manual } from '../../../data-types/tree';\r\nimport CreateManualComponent from './create-manual-component';\r\n\r\nexport interface CreateManualActions {\r\n  add: (manuals: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {user: appState.loginUser.user!, ...appState.categories, ...appState.titleCheck};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    add: (manual: Manual) => dispatch(manualAction.post(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateManualComponent);\r\n","import { MUIDataTableTextLabels } from \"mui-datatables\";\r\n\r\nexport const getTextLabels = (isFirstLoad: boolean): MUIDataTableTextLabels => ({\r\n  body: {\r\n    noMatch: isFirstLoad ? \"Now Loading..\" : \"Sorry, no matching records found\",\r\n    toolTip: \"Sort\",\r\n  },\r\n  pagination: {\r\n    next: \"Next Page\",\r\n    previous: \"Previous Page\",\r\n    rowsPerPage: \"Rows per page:\",\r\n    displayRows: \"of\",\r\n  },\r\n  toolbar: {\r\n    search: \"Search\",\r\n    downloadCsv: \"Download CSV\",\r\n    print: \"Print\",\r\n    viewColumns: \"View Columns\",\r\n    filterTable: \"Filter Table\",\r\n  },\r\n  filter: {\r\n    all: \"All\",\r\n    title: \"FILTERS\",\r\n    reset: \"RESET\",\r\n  },\r\n  viewColumns: {\r\n    title: \"Show Columns\",\r\n    titleAria: \"Show/Hide Table Columns\",\r\n  },\r\n  selectedRows: {\r\n    text: \"row(s) selected\",\r\n    delete: \"Delete\",\r\n    deleteAria: \"Delete Selected Rows\",\r\n  },\r\n});","import React, { useEffect, useState, useRef } from 'react';\r\nimport { pink, blue } from '@material-ui/core/colors';\r\n\r\nimport { connect } from 'react-redux';\r\nimport { LoginUserState } from '../../redux/states/main/loginUserState';\r\nimport { AppState } from '../../redux/store';\r\nimport MUIDataTable, { MUIDataTableOptions, MUIDataTableColumn } from 'mui-datatables';\r\nimport { Star, StarBorder, ThumbUpAlt, ThumbUpAltOutlined, Add } from '@material-ui/icons';\r\nimport { TableCell, TableSortLabel, createMuiTheme, Typography, Button, Box, CircularProgress, Badge, Hidden, Fab, Dialog } from '@material-ui/core';\r\nimport { MuiThemeProvider, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport { categoriesAction } from '../../redux/actions/main/categoriesAction';\r\nimport { Dispatch } from 'redux';\r\nimport { Action } from 'typescript-fsa';\r\nimport { CategoriesState } from '../../redux/states/main/categoriesState';\r\nimport { UsersState } from '../../redux/states/main/usersState';\r\nimport { drawerWidth } from '../layout/layout-component';\r\nimport { Manual } from '../../data-types/tree';\r\nimport { ManualsQueryParams, baseManualQueryParams, ManualsQueryResponse, manualsURL, Show } from '../../api/definitions';\r\nimport axios from '../../api/axios';\r\nimport { debounce } from 'lodash';\r\nimport Category from '../../data-types/category';\r\nimport CreateManualContainer from '../layout/create-manual/create-manual-container';\r\nimport { manualAction } from '../../redux/actions/main/manualsAction';\r\nimport { getTextLabels } from './text-labels';\r\n\r\n\r\nconst otherWidthSum = 800;\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  head: {\r\n    position: 'sticky',\r\n    backgroundColor: theme.palette.background.paper,\r\n    top: 0,\r\n    zIndex: 1000,\r\n  },\r\n  description: {\r\n    width: `calc(100vw - ${otherWidthSum + drawerWidth}px)`,\r\n    [theme.breakpoints.down('md')]: {\r\n      width: `calc(100vw - ${otherWidthSum}px)`,\r\n    },\r\n  },\r\n  date: {\r\n    maxWidth: 90\r\n  },\r\n  extendedIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n}));\r\n\r\ninterface Props extends\r\n  LoginUserState,\r\n  UsersState,\r\n  CategoriesState,\r\n  RouteComponentProps {\r\n  filterSet: (category: Category) => Action<Category>;\r\n  filterReset: () => Action<void>;\r\n  clearSelectManual: () => Action<void>;\r\n}\r\n\r\nconst getMuiTheme = () => createMuiTheme({\r\n  palette: {\r\n    primary: blue,\r\n    secondary: pink,\r\n  },\r\n  typography: {\r\n    // fontSize: 12,\r\n    button: {\r\n      textTransform: \"none\"\r\n    }\r\n  },\r\n  overrides: {\r\n    MuiTableCell: {\r\n      root: {\r\n        paddingLeft: 8,\r\n        paddingRight: 8\r\n      }\r\n    },\r\n    MuiTableSortLabel: {\r\n      root: {\r\n        marginRight: -10\r\n      }\r\n    },\r\n  }\r\n});\r\n\r\nconst Dashboard: React.FC<Props> = (props: Props) => {\r\n\r\n  const favoriteColumn = 0;\r\n  const likeColumn = 1;\r\n  // const titleColumn = 2;\r\n  // const ownerColumn = 3;\r\n  const categoryColumn = 4;\r\n  // const discriptionColumn = 5;\r\n  // const updateAtColumn = 6;\r\n  // const createAtColumn = 7;\r\n\r\n  const favoriteColumnName = 'favorite';\r\n  const favoriteFilterName = 'お気に入り登録済み';\r\n  const unfavoriteFilterName = 'お気に入り未登録';\r\n\r\n  const likeColumnName = 'like';  \r\n  const likeFilterName = 'いいね登録済み';\r\n  const unlikeFilterName = 'いいね未登録';\r\n\r\n  const [isLoading, setLoading] = useState(false);\r\n  const {\r\n    filters: {favorite: baseFavorite, like: baseLike},\r\n    searchText: baseSearchText,\r\n    sortColumn: baseSortColumn,\r\n    sortDirection: baseSortDirection,\r\n    page: basePage,\r\n    rowsPerPage: baseRowsPerPage,\r\n  } = baseManualQueryParams;\r\n  const [favorite, setFavorite] = useState(baseFavorite);\r\n  const [like, setLike] = useState(baseLike);\r\n\r\n  const [searchText, setSearchText] = useState(baseSearchText);\r\n  const [sortColumn, setSortColumn] = useState(baseSortColumn);\r\n  const [sortDirection, setSortDirection] = useState(baseSortDirection);\r\n  const [page, setPage] = useState(basePage);\r\n  const [rowsPerPage, setRowsPerPage] = useState(baseRowsPerPage);\r\n  const [manuals, setManuals] = useState<Manual[]>([]);\r\n  const [count, setCount] = useState(0);\r\n\r\n  const [isFirstRendering, setIsFirstRendering] = useState(true);\r\n  const [isFirstLoad, setIsFirstLoad] = useState(true);\r\n\r\n  const categoryId = props.filter === null ? null : props.filter.id;\r\n  useEffect(() => {\r\n    if (!isFirstRendering) {\r\n      props.clearSelectManual();\r\n      setLoading(true);\r\n      const params: ManualsQueryParams = {\r\n        filters: {favorite, like, categoryId},\r\n        searchText,\r\n        sortColumn,\r\n        sortDirection,\r\n        page,\r\n        rowsPerPage\r\n      };\r\n\r\n\r\n      axios\r\n      .post<ManualsQueryResponse>(manualsURL, params)\r\n      .then(res => {\r\n        setIsFirstLoad(false);\r\n        setLoading(false);\r\n        setManuals(res.data.manuals);\r\n        setCount(res.data.count);\r\n      })\r\n    }\r\n    setIsFirstRendering(false);\r\n    // eslint-disable-next-line\r\n  }, [favorite, like, categoryId, searchText, sortColumn, sortDirection, page, rowsPerPage]);\r\n\r\n  const changeFilter = (filterList: string[][]) => {\r\n    const favoriteFilterList = filterList[favoriteColumn];\r\n    const newFavoriteFilter = favoriteFilterList.length === 0 ? Show.ALL : \r\n                              favoriteFilterList.indexOf('true') >= 0 ? Show.CHECK : Show.UNCHECK;\r\n    setFavorite(newFavoriteFilter);\r\n\r\n    const likeFilterList = filterList[likeColumn];\r\n    const newLikeFilter = likeFilterList.length === 0 ? Show.ALL : \r\n                          likeFilterList.indexOf('true') >= 0 ? Show.CHECK : Show.UNCHECK;\r\n    setLike(newLikeFilter);\r\n\r\n    const categoryFilterList = filterList[categoryColumn];\r\n\r\n    if (categoryFilterList.length === 0) {\r\n      props.filterReset();\r\n    } else {\r\n      const newCategory = props.categories.find(c => c.name === categoryFilterList[0])!\r\n      props.filterSet(newCategory);\r\n    }\r\n  }\r\n\r\n  const [currentSearchText, setCurrentSearchText] = useState<string>('');\r\n  const debounced = useRef(\r\n    debounce(\r\n      (str: string) => setSearchText(\r\n        str.split(/( |　)+/).filter(txt => txt.match(/( |　)/) === null && txt !== '')\r\n      ),\r\n      500\r\n    )\r\n  );\r\n  useEffect(() => debounced.current(currentSearchText), [currentSearchText]);\r\n  \r\n  const changeSearchText = (searchText: string | null) => {\r\n    setCurrentSearchText(searchText || '');\r\n  };\r\n\r\n  const onColumnSortChange = (colName: string, dirStr: string) => {\r\n    const dir = dirStr === 'ascending' ? 'asc' : 'desc';\r\n    setSortColumn(colName);\r\n    setSortDirection(dir);\r\n  }\r\n\r\n  const changePage = (p: number) => {\r\n    setPage(p)\r\n  };\r\n\r\n  const changeRowsPerPage = (rows: number) => {\r\n    setRowsPerPage(rows);\r\n  }\r\n\r\n  const handleClickTitle = (id: string) => () => {\r\n    history.push(`/manual/${id}/tree`);\r\n    filterReset();\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  const columns: MUIDataTableColumn[] = [\r\n    {\r\n      name: favoriteColumnName, // column: 0\r\n      label: \"お気に入り\",\r\n      options: {\r\n        filter: true,\r\n        filterOptions: {\r\n          names: [favoriteFilterName, unfavoriteFilterName],\r\n          logic(value: string, filters: string[]) { return false; }\r\n        },\r\n        sort: true,\r\n        customHeadRender: (o, update) =>\r\n        <TableCell className={classes.head} sortDirection={o.options!.sortDirection as (\"asc\" | \"desc\")} onClick={() => update(o.index)}>\r\n          <TableSortLabel\r\n            active={o.options!.sortDirection !== undefined}\r\n            direction={o.options!.sortDirection as (\"asc\" | \"desc\") || \"asc\"}\r\n          >\r\n            <StarBorder />\r\n          </TableSortLabel>\r\n        </TableCell>,\r\n        customBodyRender: (value: { bool: boolean; sum: number; }) =>\r\n        <Box display=\"flex\" justifyContent=\"left\">\r\n          <Badge badgeContent={value.sum}>\r\n            {value.bool ? <Star /> : <StarBorder />}\r\n          </Badge>\r\n        </Box>,\r\n      }\r\n    },\r\n    {\r\n      name: likeColumnName, // column: 2\r\n      label: \"いいね\",\r\n      options: {\r\n        filter: true,\r\n        filterOptions: {\r\n          names: [likeFilterName, unlikeFilterName],\r\n          logic(value: string, filters: string[]) { return false; }\r\n        },\r\n        sort: true,\r\n        customHeadRender: (o, update) =>\r\n        <TableCell className={classes.head} sortDirection={o.options!.sortDirection as (\"asc\" | \"desc\")} onClick={() => update(o.index)}>\r\n          <TableSortLabel\r\n            active={o.options!.sortDirection !== undefined}\r\n            direction={o.options!.sortDirection as (\"asc\" | \"desc\") || \"asc\"}\r\n          >\r\n            <ThumbUpAltOutlined />\r\n          </TableSortLabel>\r\n        </TableCell>,\r\n        customBodyRender: (value: { bool: boolean; sum: number; }) =>\r\n        <Box display=\"flex\" justifyContent=\"left\">\r\n          <Badge badgeContent={value.sum}>\r\n            {value.bool ? <ThumbUpAlt /> : <ThumbUpAltOutlined />}\r\n          </Badge>\r\n        </Box>,\r\n      }\r\n    },\r\n    {\r\n      name: \"title\", // column: 4\r\n      label: \"タイトル\",\r\n      options: {\r\n        filter: false,\r\n        sort: false,\r\n        customBodyRender: value =>\r\n          <Button size=\"small\"color=\"primary\" onClick={handleClickTitle(value.id)}>\r\n            <Typography noWrap>{value.title}</Typography>\r\n          </Button>\r\n      }\r\n    },\r\n    {\r\n      name: \"owner\", // column: 5\r\n      label: \"オーナー\",\r\n      options: {\r\n        filter: false,\r\n        sort: false,\r\n      }\r\n    },\r\n    {\r\n      name: \"category\", // column: 6\r\n      label: \"カテゴリー\",\r\n      options: {\r\n        filter: true,\r\n        filterOptions: {\r\n          names: props.categories.map(c => c.name),\r\n          logic(value: string, filters: string[]) { return false; }\r\n        },\r\n        sort: false,\r\n        customBodyRender: value => <Typography>{value.name}</Typography>\r\n      }\r\n    },\r\n    {\r\n      name: \"description\", // column: 7\r\n      label: \"説明\",\r\n      options: {\r\n        filter: false,\r\n        sort: false,\r\n        customBodyRender: value => <Typography className={classes.description} noWrap>{value}</Typography>\r\n      }\r\n    },\r\n    {\r\n      name: \"updateAt\", // column: 8\r\n      label: \"更新日時\",\r\n      options: {\r\n        filter: false,\r\n        sort: true,\r\n        sortDirection: 'desc',\r\n        customBodyRender: value => <Typography className={classes.date}>{value}</Typography>\r\n\r\n      }\r\n    },\r\n    {\r\n      name: \"createAt\", // column: 9\r\n      label: \"作成日時\",\r\n      options: {\r\n        filter: false,\r\n        sort: true,\r\n        customBodyRender: value => <Typography className={classes.date}>{value}</Typography>\r\n\r\n      }\r\n    },\r\n  ];\r\n\r\n  interface CellData {\r\n    favorite: { bool: boolean; sum: number; };\r\n    like: { bool: boolean; sum: number; };\r\n    title: { id: string; title: string; };\r\n    description: string;\r\n    owner: string;\r\n    category: Category;\r\n    updateAt: string;\r\n    createAt: string;\r\n  }\r\n\r\n  const { user, users, categories, history, filterReset } = props;\r\n  if (user === null) { throw new Error('LoginUser cannot be null.') }\r\n\r\n  const data: CellData[] = manuals\r\n    .map((m, i) => {\r\n      const owner = user.id === m.ownerId ? user : users.find(u => u.id === m.ownerId)!;\r\n      const isFavorite = m.favoriteIds.find(f => f === user.id) !== undefined;\r\n      const isLike = m.likeIds.find(l => l === user.id) !== undefined;\r\n      return {\r\n        favorite: { bool: isFavorite, sum: m.favoriteIds.length },\r\n        like:     { bool: isLike,     sum: m.likeIds.length },\r\n        title: { id: m.id, title: m.title },\r\n        description: m.description,\r\n        owner: `${owner.lastName} ${owner.firstName}`,\r\n        category: categories.find(c => c.id === m.categoryId)!,\r\n        updateAt: m.updateAt,\r\n        createAt: m.createAt,\r\n      };\r\n    });\r\n\r\n  const options: MUIDataTableOptions = {\r\n    print: false,\r\n    download: false,\r\n    selectableRows: 'none',\r\n    viewColumns: false,\r\n    sortFilterList: false,\r\n    elevation: 0,\r\n    rowHover: false,\r\n    responsive: 'scrollFullHeight',\r\n    serverSide: true,\r\n    count,\r\n    searchText: currentSearchText || '',\r\n    rowsPerPageOptions: [10, 20, 50],\r\n    onTableChange: (action, tableState) => {\r\n      // console.log(action)\r\n      switch (action) {\r\n        \r\n        case 'filterChange' :\r\n          changeFilter(tableState.filterList);\r\n          break;\r\n        case 'search' :\r\n          changeSearchText(tableState.searchText);\r\n          break;\r\n        case 'changePage':\r\n          changePage(tableState.page);\r\n          break;\r\n        case 'changeRowsPerPage' :\r\n          changeRowsPerPage(tableState.rowsPerPage);\r\n          break;\r\n      }\r\n    },\r\n    onColumnSortChange,\r\n    textLabels: getTextLabels(isFirstLoad),\r\n  };\r\n\r\n  const [open, setOpen] = useState(false);\r\n  function handleOpen() {\r\n    setOpen(true);\r\n  }\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  const title = (\r\n    <Box display=\"flex\" flexDirection=\"row\" alignItems=\"center\" py={2}>\r\n      <Box mr={2}><Typography variant=\"h5\">マニュアル一覧</Typography></Box>\r\n      <Hidden lgUp implementation=\"css\">\r\n        <Box mr={2}>\r\n          <Fab variant=\"extended\" color=\"primary\" onClick={handleOpen}>\r\n            新規作成\r\n            <Add className={classes.extendedIcon} />\r\n          </Fab>\r\n        </Box>\r\n      </Hidden>\r\n      {isLoading && <Box><CircularProgress size={24}/></Box>}\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <MuiThemeProvider theme={getMuiTheme()}>\r\n        <MUIDataTable\r\n          title={title}\r\n          data={data}\r\n          columns={columns}\r\n          options={options}\r\n        />\r\n      </MuiThemeProvider>\r\n      <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\r\n        <CreateManualContainer onClose={handleClose}/>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {\r\n    user: appState.loginUser.user!,\r\n    ...appState.users,\r\n    ...appState.categories\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    filterSet: (category: Category) => dispatch(categoriesAction.filterSet(category)),\r\n    filterReset: () => dispatch(categoriesAction.filterReset()),\r\n    clearSelectManual: () => dispatch(manualAction.clear()),\r\n  };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Dashboard));","import React, {useEffect, useState} from 'react';\r\nimport { Typography, Box, TextField, Button } from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { BaseSettingsActions } from './base-settings-container';\r\nimport Category from '../../../../data-types/category';\r\nimport User from '../../../../data-types/user';\r\n\r\nimport TitleChecker from '../../../../components/title-checker/title-checker';\r\nimport { TitleCheckState } from '../../../../redux/states/titleCheckState';\r\nimport AutoSingleSelect from '../../../../components/auto-single-select/auto-single-select';\r\n\r\ninterface Props extends TitleCheckState, BaseSettingsActions {\r\n  user: User;\r\n  categories: Category[];\r\n  manual: Manual;\r\n  title: string;\r\n}\r\n\r\nconst BaseSettings: React.FC<Props> = props => {\r\n  const { user, manual: propManual, title, result, categories, replace, titleReset } =  props;\r\n  const [manual, setManual] = useState(propManual);\r\n  const isOwner = manual.ownerId === user.id;\r\n  const hasChange = title !== propManual.title ||\r\n                    manual.categoryId !== propManual.categoryId ||\r\n                    manual.description !== propManual.description;\r\n\r\n  const isValid =　propManual.title === title || (title !== '' && result !== null && title === result.title && result.valid);\r\n\r\n  const handleCategorySelect = (item: string) => {\r\n    setManual({...manual, categoryId: categories.find(c => c.name === item)!.id});\r\n  }\r\n\r\n  const handleChangeDescription = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setManual({...manual, description: e.target.value as string});\r\n  }\r\n\r\n  function handleReset() {\r\n    setManual(propManual);\r\n    titleReset({preTitle: manual.title})\r\n  }\r\n\r\n  function handleClickSave() {\r\n    replace({...manual, title});\r\n  }\r\n\r\n  useEffect(() => {\r\n    setManual(propManual);\r\n  }, [propManual]);\r\n  \r\n  return (\r\n    <div>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}><Typography variant=\"h5\">マニュアルの基本設定</Typography></Box>\r\n        {isOwner && <Box><Button onClick={handleReset} disabled={!hasChange}>元に戻す</Button></Box>}\r\n        {isOwner &&\r\n        <Box><Button color=\"primary\" onClick={handleClickSave} disabled={!hasChange || !isValid}>変更する</Button></Box>}\r\n      </Box>\r\n      <Box py={2}>\r\n        <TitleChecker defaultTitle={propManual.title} disabled={!isOwner}/>\r\n      </Box>\r\n      <Box py={2} width=\"100%\">\r\n        <AutoSingleSelect\r\n          inputLabel=\"カテゴリー\"\r\n          suggestions={categories}\r\n          labelProp=\"name\"\r\n          initialSelectedItem={categories.find(c => manual.categoryId === c.id)!.name}\r\n          onChange={handleCategorySelect}\r\n        />\r\n      </Box>\r\n      <Box py={2}>\r\n        <TextField\r\n          variant=\"outlined\"\r\n          label=\"説明\"\r\n          value={manual.description}\r\n          onChange={handleChangeDescription}\r\n          multiline\r\n          rows={6}\r\n          rowsMax={12}\r\n          disabled={!isOwner}\r\n          fullWidth\r\n        />\r\n      </Box>\r\n    </div>\r\n  );\r\n}\r\nexport default BaseSettings;","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport BaseSettingsComponent from './base-settings-component';\r\nimport { Action } from 'typescript-fsa';\r\nimport { titleCheckAction } from '../../../../redux/actions/titileCheckAction';\r\n\r\nexport interface BaseSettingsActions {\r\n  replace: (manual: Manual) => Action<Manual>;\r\n  titleReset: (params: {preTitle: string; willGenerate?: string}) => Action<{preTitle: string; willGenerate?: string}>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {\r\n    user: appState.loginUser.user!,\r\n    manual: manual!,\r\n    categories: appState.categories.categories,\r\n    ...appState.titleCheck\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    replace: (manual: Manual) => dispatch(manualAction.put(manual)),\r\n    titleReset: (params: {preTitle: string; willGenerate?: string}) => dispatch(titleCheckAction.set(params)) \r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(BaseSettingsComponent);","import React, {useState, useEffect} from 'react';\r\nimport {\r\n  Theme, makeStyles, Typography, Chip, Button, Box,\r\n} from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { CollaboratorsActions } from './collaborators-container';\r\nimport { UsersState } from '../../../../redux/states/main/usersState';\r\nimport User from '../../../../data-types/user';\r\nimport _ from 'lodash';\r\nimport AutoSingleSelect from '../../../../components/auto-single-select/auto-single-select';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  chip: { margin: theme.spacing(1) },\r\n}));\r\n\r\ninterface Props extends UsersState, CollaboratorsActions {\r\n  user: User;\r\n  manual: Manual;\r\n}\r\n\r\nconst Collaborators: React.FC<Props> = props => {\r\n  const { user, users, manual: propManual, replace } =  props;\r\n  const [manual, setManual] = useState(propManual);\r\n  const isOwner = manual.ownerId === user.id;\r\n  const hasChange =\r\n  _.difference(manual.collaboratorIds, propManual.collaboratorIds).length !== 0 ||\r\n  _.difference(propManual.collaboratorIds, manual.collaboratorIds).length !== 0;\r\n  \r\n  const deleteCollaborator = (id: string) => () => {\r\n    setManual({...manual, collaboratorIds: manual.collaboratorIds.filter(cid => cid !== id)});    \r\n  };\r\n\r\n  const createUserIdentityName = (u: User) => `${u.lastName} ${u.firstName} (${u.id})`;\r\n\r\n  const [selectCollaboratorId, setCollaboratorId] = useState('');\r\n  const handleSelect = (item: string | null) => {\r\n    setCollaboratorId(\r\n      item === null ? '' :\r\n      users.find(u => item === createUserIdentityName(u))!.id\r\n    );\r\n  }\r\n\r\n  const [willReset, setWillReset] = useState(false);\r\n  const addCollaborator = () => {\r\n    setManual({...manual, collaboratorIds: manual.collaboratorIds.concat([selectCollaboratorId])});    \r\n    setCollaboratorId('');\r\n    setWillReset(true);\r\n  }\r\n\r\n  function handleReset() {\r\n    setManual(propManual);\r\n  }\r\n\r\n  function handleClickSave() {\r\n    replace(manual);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setManual(propManual);\r\n  }, [propManual]);\r\n\r\n  interface UserAsItem extends User { name: string; }\r\n\r\n  const collaborators = manual.collaboratorIds\r\n  .map(cid => users.find(u => u.id === cid)!);\r\n  const others: UserAsItem[] =  users\r\n  .filter(u => manual.collaboratorIds.find(cid => cid === u.id) === undefined && u.id !== user.id)\r\n  .map(u => ({...u, name: createUserIdentityName(u)}));\r\n\r\n  const item = selectCollaboratorId === '' ? null :\r\n  createUserIdentityName(users.find(u => u.id === selectCollaboratorId)!);\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <Typography variant=\"h5\">コラボレーター</Typography>\r\n        </Box>\r\n        {isOwner && <Box><Button onClick={handleReset} disabled={!hasChange}>元に戻す</Button></Box>}\r\n        {isOwner && <Box><Button color=\"primary\" onClick={handleClickSave} disabled={!hasChange}>変更する</Button></Box>}\r\n      </Box>\r\n      <Box py={2}>\r\n        <Box><Typography variant=\"caption\">コラボレーター</Typography></Box>\r\n        {collaborators.length === 0 && <Chip className={classes.chip} label=\"未登録\"/>}\r\n        {collaborators.map((c, i) => \r\n        <Chip\r\n          key={i}\r\n          className={classes.chip}\r\n          label={`${c.lastName} ${c.firstName}`}\r\n          onDelete={isOwner ? deleteCollaborator(c.id) : undefined}\r\n        />)}\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <AutoSingleSelect\r\n            inputLabel=\"コラボレーターの追加\"\r\n            suggestions={others}\r\n            labelProp=\"name\"\r\n            initialSelectedItem={item}\r\n            onChange={handleSelect}\r\n            willReset={willReset}\r\n            setWillReset={setWillReset}\r\n          />\r\n        </Box>\r\n        <Box ml={2}>\r\n          <Button variant=\"contained\" color=\"primary\" onClick={addCollaborator} disabled={selectCollaboratorId === ''}>追加</Button>\r\n        </Box>\r\n      </Box>\r\n    </div>\r\n  );\r\n}\r\nexport default Collaborators;","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport CollaboratorsComponent from './collaborators-component';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface CollaboratorsActions {\r\n  replace: (manual: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {user: appState.loginUser.user!, ...appState.users, manual: manual!};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    replace: (manual: Manual) => dispatch(manualAction.put(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CollaboratorsComponent);","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  makeStyles, Theme, Typography, Chip, Button, MenuItem, Box, FormControlLabel, Switch, TextField\r\n\r\n} from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { CollaboratorsActions } from './publishing-settings-container';\r\nimport { UsersState } from '../../../../redux/states/main/usersState';\r\nimport User from '../../../../data-types/user';\r\nimport _ from 'lodash';\r\nimport { UserGroupsState } from '../../../../redux/states/main/userGroupsState';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: { padding: theme.spacing(2) },\r\n  chip: { margin: theme.spacing(1) },\r\n  switch: { width: 200 },\r\n}));\r\n\r\ninterface Props extends UsersState, UserGroupsState, CollaboratorsActions {\r\n  user: User;\r\n  manual: Manual;\r\n}\r\n\r\nconst PublishingSettingsComponent: React.FC<Props> = props => {\r\n  const { user, users, userGroups: groups, manual: propManual, replace } = props;\r\n  const [manual, setManual] = useState(propManual);\r\n  const isOwner = manual.ownerId === user.id;\r\n  const hasChange =\r\n    manual.isPublic !== propManual.isPublic ||\r\n    _.difference(manual.viewerIdsOfUser, propManual.viewerIdsOfUser).length !== 0 ||\r\n    _.difference(manual.viewerIdsOfGroup, propManual.viewerIdsOfGroup).length !== 0 ||\r\n    _.difference(propManual.viewerIdsOfUser, manual.viewerIdsOfUser).length !== 0 ||\r\n    _.difference(propManual.viewerIdsOfGroup, manual.viewerIdsOfGroup).length !== 0;\r\n\r\n  const handleSwitch = (e: React.ChangeEvent<HTMLInputElement>, checked: boolean) => {\r\n    setManual({ ...manual, isPublic: checked });\r\n  }\r\n\r\n  // Viewer Of User\r\n  const deleteViewerOfUser = (id: string) => () => {\r\n    setManual({ ...manual, viewerIdsOfUser: manual.viewerIdsOfUser.filter(uid => uid !== id) });\r\n  };\r\n\r\n  const [selectViewerOfUser, setViewerOfUser] = useState('');\r\n  const handleUserSelect = (e: any) => setViewerOfUser(e.target.value);\r\n  const addViewerOfUser = () => {\r\n    setManual({ ...manual, viewerIdsOfUser: manual.viewerIdsOfUser.concat([selectViewerOfUser]) });\r\n    setViewerOfUser('');\r\n  }\r\n  const userViewers = manual.viewerIdsOfUser\r\n    .map(uid => users.find(u => u.id === uid)!);\r\n  const otherUsers = users\r\n    .filter(u => manual.viewerIdsOfUser.find(uid => u.id === uid) === undefined && u.id !== user.id);\r\n  // Viewer Of User ここまで\r\n\r\n  // Viewer Of Group\r\n  const deleteViewerOfGroup = (id: string) => () => {\r\n    setManual({ ...manual, viewerIdsOfGroup: manual.viewerIdsOfGroup.filter(gid => gid !== id) });\r\n  };\r\n\r\n  const [selectViewerOfGroup, setViewerOfGroup] = useState('');\r\n  const handleGroupSelect = (e: any) => setViewerOfGroup(e.target.value);\r\n  const addViewerOfGroup = () => {\r\n    setManual({ ...manual, viewerIdsOfGroup: manual.viewerIdsOfGroup.concat([selectViewerOfGroup]) });\r\n    setViewerOfGroup('');\r\n  }\r\n  const groupViewers = manual.viewerIdsOfGroup\r\n    .map(gid => groups.find(g => g.id === gid)!);\r\n  const otherGroups = groups\r\n    .filter(g => manual.viewerIdsOfGroup.find(gid => g.id === gid) === undefined);\r\n  // Viewer Of Group ここまで\r\n\r\n  function handleReset() {\r\n    setManual(propManual);\r\n  }\r\n\r\n  function handleClickSave() {\r\n    replace(manual);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setManual(propManual);\r\n  }, [propManual]);\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <Typography variant=\"h5\">公開設定</Typography>\r\n        </Box>\r\n        {isOwner && <Box><Button onClick={handleReset} disabled={!hasChange}>元に戻す</Button></Box>}\r\n        {isOwner && <Box><Button color=\"primary\" onClick={handleClickSave} disabled={!hasChange}>変更する</Button></Box>}\r\n      </Box>\r\n      <Box py={2} width=\"100%\">\r\n        <div><Typography variant=\"caption\">公開・非公開</Typography></div>\r\n        <Box pt={1}>\r\n          <FormControlLabel\r\n            className={classes.switch}\r\n            control={<Switch checked={manual.isPublic} color=\"primary\" onChange={handleSwitch} />}\r\n            label=\"公開\"\r\n            disabled={!isOwner}\r\n          />\r\n        </Box>\r\n      </Box>\r\n      {!manual.isPublic && isOwner &&\r\n        <Box px={2} pt={2}>\r\n          <Box><Typography variant=\"caption\">閲覧可能なユーザー</Typography></Box>\r\n          {userViewers.length === 0 && <Chip className={classes.chip} label=\"未登録\"/>}\r\n          {userViewers.map((u, i) =>\r\n            <Chip\r\n              key={i}\r\n              className={classes.chip}\r\n              label={`${u.lastName} ${u.firstName}`}\r\n              onDelete={isOwner ? deleteViewerOfUser(u.id) : undefined}\r\n            />)}\r\n        </Box>}\r\n\r\n      {!manual.isPublic && isOwner &&\r\n        <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n          <Box flexGrow={1}>\r\n            <TextField\r\n              select\r\n              variant=\"outlined\"\r\n              label=\"閲覧可能なユーザーの追加\"\r\n              value={selectViewerOfUser}\r\n              onChange={handleUserSelect}\r\n              disabled={!isOwner}\r\n              fullWidth\r\n            >\r\n              <MenuItem value=\"\"><em>None</em></MenuItem>\r\n              {otherUsers.map(o => <MenuItem key={o.id} value={o.id}>{`${o.lastName} ${o.firstName}`}</MenuItem>)}\r\n            </TextField>\r\n          </Box>\r\n          <Box ml={2}>\r\n            <Button variant=\"contained\" color=\"primary\" onClick={addViewerOfUser} disabled={selectViewerOfUser === ''}>追加</Button>\r\n          </Box>\r\n        </Box>}\r\n\r\n      {!manual.isPublic && isOwner &&\r\n        <Box px={2} pt={2}>\r\n          <Box><Typography variant=\"caption\">閲覧可能なユーザーグループ</Typography></Box>\r\n          {groupViewers.length === 0 && <Chip className={classes.chip} label=\"未登録\"/>}\r\n          {groupViewers.map((g, i) =>\r\n            <Chip\r\n              key={i}\r\n              className={classes.chip}\r\n              label={g.name}\r\n              onDelete={isOwner ? deleteViewerOfGroup(g.id) : undefined}\r\n            />)}\r\n        </Box>}\r\n\r\n      {!manual.isPublic && isOwner &&\r\n        <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n          <Box flexGrow={1}>\r\n            <TextField\r\n              select\r\n              variant=\"outlined\"\r\n              label=\"閲覧可能なユーザーグループの追加\"\r\n              value={selectViewerOfGroup}\r\n              onChange={handleGroupSelect}\r\n              disabled={!isOwner}\r\n              fullWidth\r\n            >\r\n              <MenuItem value=\"\"><em>None</em></MenuItem>\r\n              {otherGroups.map(o => <MenuItem key={o.id} value={o.id}>{o.name}</MenuItem>)}\r\n            </TextField>\r\n          </Box>\r\n          <Box ml={2}>\r\n            <Button variant=\"contained\" color=\"primary\" onClick={addViewerOfGroup} disabled={selectViewerOfGroup === ''}>追加</Button>\r\n          </Box>\r\n        </Box>}\r\n    </div>\r\n  );\r\n}\r\nexport default PublishingSettingsComponent;","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport PublishingSettingsComponent from './publishing-settings-component';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface CollaboratorsActions {\r\n  replace: (manual: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {user: appState.loginUser.user!, ...appState.users, ...appState.userGroups, manual: manual!};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    replace: (manual: Manual) => dispatch(manualAction.put(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PublishingSettingsComponent);","import React from 'react';\r\nimport { Typography, Button, Box } from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { CopyActions } from './copy-container';\r\nimport Util from '../../../../func/util';\r\nimport TitleChecker from '../../../../components/title-checker/title-checker';\r\nimport { TitleCheckState } from '../../../../redux/states/titleCheckState';\r\n\r\n\r\ninterface Props extends TitleCheckState, CopyActions {\r\n  manual: Manual;\r\n}\r\n\r\nconst Copy: React.FC<Props> = props => {\r\n\r\n  const { manual, copy, title, result } = props;\r\n\r\n  function handleClick() {\r\n    copy({...manual, id: Util.getID(), title});\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Box py={2}><Typography variant=\"h5\">マニュアルを複製する</Typography></Box>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <TitleChecker defaultTitle=\"\" willGenerate={manual.title}/>\r\n        </Box>\r\n        <Box ml={2}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={handleClick}\r\n            disabled={title === \"\" || result === null || title !== result.title || !result.valid}\r\n          >\r\n            複製する\r\n          </Button>\r\n        </Box>\r\n      </Box>\r\n    </div>\r\n  );\r\n}\r\nexport default Copy;","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport CopyComponent from './copy-component';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface CopyActions {\r\n  copy: (manual: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {...appState.manual, manual: manual!, ...appState.titleCheck };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    copy: (manual: Manual) => dispatch(manualAction.copy(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CopyComponent);","import React, { useState } from 'react';\r\nimport { Typography, Button, TextField, Box, Snackbar, IconButton } from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { DeleteActions } from './delete-container';\r\nimport { Close } from '@material-ui/icons';\r\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport links from '../../../../settings/links';\r\nimport User from '../../../../data-types/user';\r\n\r\n\r\ninterface Props extends DeleteActions, RouteComponentProps {\r\n  user: User;\r\n  manual: Manual;\r\n}\r\n\r\nconst DeleteComponent: React.FC<Props> = props => {\r\n  const { user, manual, manualDelete, history } = props;\r\n  const isOwner = manual.ownerId === user.id;\r\n\r\n  const [title, setTitle] = useState('');\r\n  function handleChangeTitle(e: React.ChangeEvent<HTMLInputElement>) {\r\n    setTitle(e.target.value);\r\n  }\r\n\r\n  const [miss, setMiss] = useState(false);\r\n  function handleClick() {\r\n    if (manual.title === title) {\r\n      manualDelete(manual);\r\n      history.push(links.dashboard);\r\n    } else {\r\n      setMiss(true);\r\n    }\r\n  }\r\n  function onClose() {\r\n    setMiss(false);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Box py={2}><Typography variant=\"h5\">マニュアルを削除する</Typography></Box>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <TextField\r\n            label=\"確認のためタイトルを入力\"\r\n            value={title}\r\n            onChange={handleChangeTitle}\r\n            error={manual.title !== title && isOwner}\r\n            fullWidth\r\n            disabled={!isOwner}\r\n          />\r\n        </Box>\r\n        <Box ml={2}>\r\n          <Button variant=\"contained\" color=\"primary\" onClick={handleClick} disabled={!isOwner}>削除する</Button>\r\n        </Box>\r\n      </Box>\r\n\r\n      <Snackbar\r\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\r\n        open={miss}\r\n        autoHideDuration={3000}\r\n        onClose={onClose}\r\n        message={<span>タイトルが一致しません</span>}\r\n        action={[\r\n          <IconButton key=\"close\" color=\"inherit\" onClick={onClose}>\r\n            <Box><Close/></Box>\r\n          </IconButton>\r\n        ]}\r\n      />\r\n    </div>\r\n  );\r\n}\r\nexport default　withRouter(DeleteComponent);","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport DeleteComponent from './delete-component';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface DeleteActions {\r\n  manualDelete: (manual: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {user: appState.loginUser.user!, manual: manual!};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    manualDelete: (manual: Manual) => dispatch(manualAction.delete(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DeleteComponent);","import React, {useState, useEffect} from 'react';\r\nimport { Typography, Button, Box } from '@material-ui/core';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { CollaboratorsActions } from './change-owner-container';\r\nimport { UsersState } from '../../../../redux/states/main/usersState';\r\nimport User from '../../../../data-types/user';\r\nimport AutoSingleSelect from '../../../../components/auto-single-select/auto-single-select';\r\n\r\ninterface Props extends UsersState, CollaboratorsActions {\r\n  user: User;\r\n  manual: Manual;\r\n}\r\n\r\nconst ChangeOwnerComponent: React.FC<Props> = props => {\r\n  const { user, users, manual: propManual, replace } =  props;\r\n  const [manual, setManual] = useState(propManual);\r\n  const isOwner = propManual.ownerId === user.id;\r\n  const hasChange = manual.ownerId !== propManual.ownerId;\r\n  \r\n  const handleSelect = (item: string | null) => {\r\n    if (item !== null) {\r\n      setManual({...manual, ownerId: users.find(u => item === createUserIdentityName(u))!.id});\r\n    }\r\n  }\r\n\r\n  function handleReset() {\r\n    setManual(propManual);\r\n  }\r\n\r\n  function handleClickSave() {\r\n    replace(manual);\r\n  }\r\n\r\n  useEffect(() => {\r\n    setManual(propManual);\r\n  }, [propManual]);\r\n\r\n  const createUserIdentityName = (u: User) => `${u.lastName} ${u.firstName} (${u.id})`;\r\n  interface UserAsItem extends User { name: string; }\r\n  \r\n  const usersAsItem: UserAsItem[] = users.map(u => ({...u, name: createUserIdentityName(u)}));\r\n  const item = createUserIdentityName(users.find(u => u.id === manual.ownerId)!);\r\n  return (\r\n    <div>\r\n      <Box display=\"flex\" flexDirection=\"row\" alignItems=\"flex-end\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <Typography variant=\"h5\">オーナーの変更</Typography>\r\n        </Box>\r\n        {isOwner && <Box><Button onClick={handleReset} disabled={!hasChange}>元に戻す</Button></Box>}\r\n        {isOwner && <Box><Button color=\"primary\" onClick={handleClickSave} disabled={!hasChange}>変更する</Button></Box>}\r\n      </Box>\r\n      <Box display=\"flex\" py={2}>\r\n        <Box flexGrow={1}>\r\n          <AutoSingleSelect\r\n            inputLabel=\"オーナーの変更\"\r\n            suggestions={usersAsItem}\r\n            labelProp=\"name\"\r\n            initialSelectedItem={item}\r\n            onChange={handleSelect}\r\n            disabled={!isOwner}\r\n          />\r\n        </Box>\r\n      </Box>\r\n    </div>\r\n  );\r\n}\r\nexport default ChangeOwnerComponent;","import { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport { Manual } from '../../../../data-types/tree';\r\nimport { manualAction } from '../../../../redux/actions/main/manualsAction';\r\nimport ChangeOwnerComponent from './change-owner-component';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface CollaboratorsActions {\r\n  replace: (manual: Manual) => Action<Manual>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual } = appState.manual;\r\n  return {user: appState.loginUser.user!, ...appState.users, manual: manual!};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    replace: (manual: Manual) => dispatch(manualAction.put(manual)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChangeOwnerComponent);","import * as React from 'react';\r\nimport {useState} from 'react';\r\nimport {\r\n  Grid, Paper, List, ListItem, ListItemText, Box\r\n} from '@material-ui/core';\r\nimport BaseSettings from './base-settings/base-settings-container';\r\nimport Collaborators from './collaborators/collaborators-container';\r\nimport PublishingSettings from './publishing-settings/publishing-settings-container';\r\nimport Copy from './copy/copy-container';\r\nimport Delete from './delete/delete-container';\r\nimport ChangeOwner from './change-owner/change-owner-container';\r\n\r\ninterface Props {}\r\n\r\nconst ManualSettings: React.FC<Props> = props => {\r\n  const [selected, setSelected] = useState(0)\r\n  const handleSelect = (i: number) => () => setSelected(i);\r\n  return (\r\n    <Box m={3}>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12} sm={5} md={4} lg={3}>\r\n          <Paper >\r\n            <List>\r\n              <ListItem button selected={selected === 0} onClick={handleSelect(0)}>\r\n                <ListItemText>基本設定</ListItemText>\r\n              </ListItem>\r\n              <ListItem button selected={selected === 1} onClick={handleSelect(1)}>\r\n                <ListItemText>コラボレーター</ListItemText>\r\n              </ListItem>\r\n              <ListItem button selected={selected === 2} onClick={handleSelect(2)}>\r\n                <ListItemText>公開設定</ListItemText>\r\n              </ListItem>\r\n              <ListItem button selected={selected === 3} onClick={handleSelect(3)}>\r\n                <ListItemText>マニュアルの複製</ListItemText>\r\n              </ListItem>\r\n              <ListItem button selected={selected === 4} onClick={handleSelect(4)}>\r\n                <ListItemText>マニュアルのオーナー変更</ListItemText>\r\n              </ListItem>\r\n              <ListItem button selected={selected === 5} onClick={handleSelect(5)}>\r\n                <ListItemText>マニュアルの削除</ListItemText>\r\n              </ListItem>\r\n            </List>\r\n          </Paper>\r\n        </Grid>\r\n        <Grid item xs={12} sm={7} md={8} lg={9}>\r\n          <Box maxWidth={600}>\r\n            {selected === 0 && <BaseSettings/>}\r\n            {selected === 1 && <Collaborators/>}\r\n            {selected === 2 && <PublishingSettings/>}\r\n            {selected === 3 && <Copy/>}\r\n            {selected === 4 && <ChangeOwner/>}\r\n            {selected === 5 && <Delete/>}\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n    </Box>\r\n  );\r\n}\r\nexport default ManualSettings;","import { Action } from 'typescript-fsa';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport { AppState } from '../../../redux/store';\r\nimport { treeActions } from '../../../redux/actions/main/manualsAction';\r\nimport EditorFrameComponent from './node-frame-component';\r\nimport { TreePutRequest } from '../../../api/definitions';\r\n\r\nexport interface EditorFrameActions {\r\n  putTree: (params: TreePutRequest) => Action<TreePutRequest>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual, node } = appState.manual;\r\n  return {manual: cloneDeep(manual)!, node: cloneDeep(node)!, ...appState.ks};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    putTree: (params: TreePutRequest) => dispatch(treeActions.put(params)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditorFrameComponent);","import { Dispatch, Action } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport TextEditorComponent from './text-component';\r\nimport { treeActions } from '../../../../redux/actions/main/manualsAction';\r\nimport { TreePutRequest } from '../../../../api/definitions';\r\n\r\n\r\nexport interface NodeViewerActions {\r\n  putTree: (params: TreePutRequest) => Action<TreePutRequest>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { manual, node } = appState.manual;\r\n  return { manual: manual!, node: node!, ...appState.ks, ...appState.rs };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    putTree: (params: TreePutRequest) => dispatch(treeActions.put(params)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TextEditorComponent);","import * as React from 'react';\r\nimport { LinkProps, Link } from 'react-router-dom';\r\n\r\nconst AdapterLink = React.forwardRef<HTMLAnchorElement, LinkProps>((props, ref) => (\r\n  <Link innerRef={ref as any} {...props} />\r\n));\r\n\r\nexport default AdapterLink;","import { SvgPath } from \"../../../data-types/svg-path\";\r\n\r\nexport const more: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z', fill: true}\r\n];\r\nexport default more;","import { SvgPath } from \"../../../data-types/svg-path\";\r\n\r\nexport const less: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z', fill: true}\r\n];\r\nexport default less;","import * as React from 'react';\r\nimport { lightBlue, amber, yellow, grey } from '@material-ui/core/colors';\r\nimport { Rect, Group, Text, Arrow } from 'react-konva';\r\nimport { task, switchSvg, flag } from '../../resource/svg-icon';\r\n\r\nimport { KWithArrow, isSwitch, isTask } from '../../data-types/tree';\r\n\r\nimport { theme } from '../..';\r\nimport Util from '../../func/util';\r\nimport { phrase } from '../../settings/phrase';\r\nimport IconWithBadge, { IconWithBadgeProps } from './icon-with-badge';\r\nimport KSize from '../../data-types/k-size';\r\nimport check from '../../resource/svg-icon/check';\r\nimport Icon, { IconProps } from './icon';\r\nimport more from '../../resource/svg-icon/expand/more';\r\nimport less from '../../resource/svg-icon/expand/less';\r\n\r\nexport interface KNodeProps {\r\n  node: KWithArrow;\r\n  ks: KSize;\r\n  expand: (node: KWithArrow) => void;\r\n  stageRef?: React.RefObject<any>;\r\n}\r\n\r\nconst KViewNode: React.FC<KNodeProps> = props => {\r\n  const { node, ks, expand, stageRef } = props;\r\n  const fill = isTask(node.type) ? lightBlue[50] :\r\n  isSwitch(node.type) ? amber[100] : yellow[100];\r\n  const baseRectProps = {\r\n    x: 0, y: 0,\r\n    width: node.rect.w * ks.unit,\r\n    height: node.rect.h * ks.unit,\r\n    cornerRadius: 4,\r\n    fill,\r\n    stroke: '#0000',\r\n    strokeWidth: 6,\r\n    shadowColor: 'black',\r\n    shadowBlur: 6,\r\n    shadowOffsetY: 3,\r\n    shadowOpacity: 0.2,\r\n  };\r\n\r\n  const labelProps = {\r\n    text: Util.isEmpty(node.label)\r\n      ? isTask(node.type) ? phrase.empty.task : isSwitch(node.type) ? phrase.empty.switch : phrase.empty.case\r\n      : node.label,\r\n    fontSize: ks.fontSize * ks.unit,\r\n    x: (ks.rect.h + ks.fontSize / 2) * ks.unit,\r\n    y: (ks.rect.h - ks.fontHeight) / 2 * ks.unit\r\n  };\r\n\r\n  const typeProps: IconProps = {\r\n    ks,\r\n    x: 0, y: 0,\r\n    svg: isTask(node.type) ? task : isSwitch(node.type) ? switchSvg : check,\r\n    scale: isSwitch(node.type) ? {x: 1, y: -1} : undefined,\r\n  };\r\n\r\n  const containerRectProps = {\r\n    x: (ks.indent / 2 - ks.spr.w) * ks.unit,\r\n    y: ks.spr.h * ks.unit,\r\n    width: (node.self.w - (ks.indent / 2 - ks.spr.w)) * ks.unit,\r\n    height: (node.self.h - ks.spr.h) * ks.unit,\r\n    cornerRadius: ks.cornerRadius * ks.unit,\r\n    stroke: grey[500],\r\n    fill: node.depth.top === 0 ? theme.palette.background.paper : '#00000009',\r\n    strokeWidth: ks.hasArrow ? 0 : 1,\r\n  };\r\n\r\n  const arrowBaseProps = {\r\n    stroke: grey[700],\r\n    fill: grey[700],\r\n    pointerLength: ks.pointerLength * ks.unit,\r\n    pointerWidth: ks.pointerWidth * ks.unit,\r\n  }\r\n  const endIconProps: IconProps = {\r\n    ks,\r\n    x: -ks.rect.h * ks.unit, y: 0,\r\n    svg: flag,\r\n    color: theme.palette.secondary.main,\r\n  };\r\n\r\n  const expandProps: IconWithBadgeProps = {\r\n    ks,\r\n    x: (ks.rect.w - ks.rect.h) * ks.unit, y: 0,\r\n    svg: node.open ? less : more,\r\n    badgeContent: node.children.length,\r\n    onClick: () => expand(node),\r\n    onMouseEnter: () => {\r\n      if (stageRef!.current !== null) {\r\n        stageRef!.current.container().style.cursor = 'pointer';\r\n      }\r\n    },\r\n    onMouseLeave: () => {\r\n      if (stageRef!.current !== null) {\r\n        stageRef!.current.container().style.cursor = 'default';\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Group x={node.point.x * ks.unit} y={node.point.y * ks.unit} >\r\n        \r\n        {node.open && <Rect {...containerRectProps}/>}\r\n        <Rect {...baseRectProps}/>\r\n        <Icon {...typeProps}/>\r\n        <Text {...labelProps}/>\r\n        {node.children.length !== 0 && <IconWithBadge {...expandProps}/>}\r\n        {ks.hasArrow && node.arrows.map((a, i) => {\r\n          const points = a.map(point => [point.x, point.y]).reduce((before, next) => before.concat(next)).map(p => p * ks.unit);\r\n          return <Arrow key={`${node.id}-arrow-${i}`} {...arrowBaseProps} points={points}/>;\r\n        })}\r\n        {node.arrows.length === 0 && node.depth.top !== 0 && <Icon {...endIconProps}/>}\r\n    </Group>\r\n  );\r\n}\r\n\r\nexport default KViewNode;","import React, { useCallback, useRef } from 'react';\r\nimport {\r\n  Dialog, DialogContent, DialogActions, Button,\r\n} from '@material-ui/core';\r\n\r\nimport { Stage, Layer } from 'react-konva';\r\n\r\nimport { TreeNode, baseKWithArrow, KWithArrow } from '../../../../data-types/tree';\r\nimport TreeUtil from '../../../../func/tree';\r\nimport TreeNodeUtil from '../../../../func/tree-node';\r\nimport KTreeUtil from '../../../../func/k-tree';\r\nimport KArrowUtil from '../../../../func/k-arrow';\r\nimport KViewNode from '../../../../components/konva/k-view-node';\r\nimport { RSState } from '../../../../redux/states/rsState';\r\nimport { KSState } from '../../../../redux/states/ksState';\r\nimport ReactToPrint from 'react-to-print';\r\n\r\ninterface Props extends KSState, RSState {\r\n  open: boolean;\r\n  close: () => void;\r\n  node: TreeNode | null;\r\n}\r\n\r\nconst NodePrintComponent: React.FC<Props> = props => {\r\n  const { open, close, node: tree, ks } = props;\r\n\r\n  const stageRef = useCallback(stage => {\r\n    if (stage !== null && tree !== null) {\r\n      const kTreeNode = KTreeUtil.setCalcProps(TreeUtil._get(tree, baseKWithArrow), ks, false);\r\n      const node = KArrowUtil.setArrow(kTreeNode, ks)\r\n      stage.width((node.self.w + ks.spr.w) * ks.unit);\r\n      stage.height((node.self.h + ks.spr.h) * ks.unit);\r\n      stage.draw();\r\n    }\r\n  }, [ks, tree]);\r\n\r\n  const contentRef = useRef();\r\n\r\n  if (tree === null) { return <></>; }\r\n\r\n  const kTreeNode = KTreeUtil.setCalcProps(TreeUtil._get(tree, baseKWithArrow), ks, false);\r\n  const node = KArrowUtil.setArrow(kTreeNode, ks)\r\n  const flatNodes = TreeNodeUtil.toArrayWithoutClose(node);\r\n  const nodeProps = { ks, expand: (target: KWithArrow) => {} };\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={close}\r\n      maxWidth=\"xl\"\r\n    >\r\n      <DialogContent ref={contentRef}>\r\n        <Stage ref={stageRef}>\r\n          <Layer>\r\n            {flatNodes.map(n => <KViewNode key={n.id} node={n} {...nodeProps} />)}\r\n          </Layer>\r\n        </Stage>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close}>閉じる</Button>\r\n        <ReactToPrint\r\n          trigger={() => <Button color=\"primary\">印刷する</Button>}\r\n          content={() => contentRef.current}\r\n        />\r\n      </DialogActions>\r\n    </Dialog>\r\n\r\n  );\r\n}\r\n\r\n\r\nexport default NodePrintComponent;","import { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\nimport NodePrintComponent from './node-print-component';\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { node } = appState.manual;\r\n  return {node: node!, ...appState.ks, ...appState.rs};\r\n}\r\n\r\nexport default connect(mapStateToProps)(NodePrintComponent);","import * as React from 'react';\r\nimport classnames from 'classnames';\r\n\r\nimport {\r\n  Theme, createStyles, WithStyles, withStyles, TextField, Grid,\r\n  InputAdornment, FormControl, Select, MenuItem, Typography, Paper\r\n} from '@material-ui/core';\r\nimport {\r\n  Task, Switch, Case, Input, Output, PreConditions, PostConditions,\r\n  WorkerInCharge, Remarks, NecessaryTools, Exceptions,\r\n} from '../../../../settings/layout';\r\nimport { TreeNode, Type, isSwitch, isTask, isCase } from '../../../../data-types/tree';\r\n\r\nimport { phrase } from '../../../../settings/phrase';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n  root: {\r\n    position: 'relative',\r\n    padding: theme.spacing(2),\r\n    width: '100%',\r\n  },\r\n  select: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  selectType: {\r\n    marginRight: theme.spacing(1),\r\n  },\r\n  switchIcon: {\r\n    transform: 'scale(1, -1)',\r\n  },\r\n  title: {\r\n    fontSize: 40,\r\n  },\r\n  imageIcon: {marginRight: theme.spacing(1)},\r\n  imageFormContainer: {\r\n    marginTop: -theme.spacing(2),\r\n    marginBottom: -theme.spacing(1),\r\n    width: '100%',\r\n    paddingLeft: 68\r\n  },\r\n  imageContainer: {\r\n    position: 'relative',\r\n    // width: '100%',\r\n    // height: '100%',\r\n  },\r\n  img: {\r\n    [theme.breakpoints.up('lg')]: {\r\n      width: '100%',\r\n      height: 340,\r\n      objectFit: 'cover',\r\n    },\r\n    [theme.breakpoints.down('md')]: {\r\n      maxWidth: '100%',\r\n      height: 340,\r\n      objectFit: 'cover',\r\n    },\r\n  },\r\n  deleteButton: {\r\n    position: 'absolute',\r\n    top: -theme.spacing(1),\r\n    right: -theme.spacing(1),\r\n  }\r\n});\r\n\r\nexport interface TextLineWithIconProps {\r\n  itemNumber: string;\r\n  node: TreeNode;\r\n}\r\n\r\ninterface Props extends TextLineWithIconProps, WithStyles<typeof styles> {}\r\n\r\nconst TextPrint: React.FC<Props> = (props: Props) => {\r\n\r\n  const {\r\n    itemNumber, node, classes\r\n  } = props;\r\n\r\n  const InputIcon = <InputAdornment position=\"start\"><Input/></InputAdornment>;\r\n\r\n  const OutputIcon = <InputAdornment position=\"start\"><Output/></InputAdornment>;\r\n\r\n  const PreConditionsIcon = <InputAdornment position=\"start\"><PreConditions/></InputAdornment>;\r\n\r\n  const PostConditionsIcon = <InputAdornment position=\"start\"><PostConditions/></InputAdornment>;\r\n\r\n  const WorkerInChargeIcon = <InputAdornment position=\"start\"><WorkerInCharge/></InputAdornment>;\r\n\r\n  const RemarksIcon = <InputAdornment position=\"start\"><Remarks/></InputAdornment>;\r\n\r\n  const NecessaryToolsIcon = <InputAdornment position=\"start\"><NecessaryTools/></InputAdornment>;\r\n\r\n  const ExceptionsIcon = <InputAdornment position=\"start\"><Exceptions/></InputAdornment>;\r\n\r\n  const focusType: Type = node === null ? Type.task : node.type;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12} lg={8}>\r\n          <Grid container alignItems=\"flex-end\" spacing={1}>\r\n            <Grid item>\r\n              <FormControl>\r\n                <Select\r\n                  classes={{\r\n                    icon: !isSwitch(focusType) ? classes.selectType : classnames(classes.selectType, classes.switchIcon),\r\n                    select: classes.select\r\n                  }}\r\n                  value={node.type}\r\n                  IconComponent={\r\n                    p => isTask(focusType) ? <Task {...p}/> : isSwitch(focusType) ? <Switch {...p}/> : <Case {...p}/>}\r\n                  disabled\r\n                >\r\n                  <MenuItem value=\"0\">作業</MenuItem>\r\n                  <MenuItem value=\"1\">分岐</MenuItem>\r\n                  {isCase(node.type) && <MenuItem value=\"2\">条件</MenuItem>}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            <Grid item xs>\r\n              {node.label !== itemNumber && <Typography variant=\"h5\">{itemNumber}</Typography>}\r\n            </Grid>\r\n          </Grid>\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder={\r\n              isTask(node.type) ? phrase.placeholder.task :\r\n              isSwitch(node.type) ? phrase.placeholder.switch : phrase.placeholder.case\r\n            }\r\n            value={node.label}\r\n            InputProps={{classes: {input: classes.title}}}\r\n            fullWidth\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"インプット\"\r\n            value={node.input}\r\n            InputProps={{startAdornment: InputIcon}}\r\n            fullWidth\r\n            multiline\r\n            disabled\r\n          />\r\n          \r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"アウトプット\"\r\n            value={node.output}\r\n            InputProps={{startAdornment: OutputIcon}}\r\n            fullWidth\r\n            disabled\r\n          />\r\n\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"事前条件\"\r\n            value={node.preConditions}\r\n            InputProps={{startAdornment: PreConditionsIcon}}\r\n            fullWidth\r\n            multiline\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"事後条件\"\r\n            value={node.postConditions}\r\n            InputProps={{startAdornment: PostConditionsIcon}}\r\n            fullWidth\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"担当者\"\r\n            value={node.workerInCharge}\r\n            InputProps={{startAdornment: WorkerInChargeIcon}}\r\n            fullWidth\r\n            multiline\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"備考\"\r\n            value={node.remarks}\r\n            InputProps={{startAdornment: RemarksIcon}}\r\n            fullWidth\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"必要システム・ツール\"\r\n            value={node.necessaryTools}\r\n            InputProps={{startAdornment: NecessaryToolsIcon\r\n            }}\r\n            fullWidth\r\n            multiline\r\n            disabled\r\n          />\r\n          <TextField\r\n            style={{paddingLeft: 80}}\r\n            placeholder=\"例外\"\r\n            value={node.exceptions}\r\n            InputProps={{startAdornment: ExceptionsIcon}}\r\n            fullWidth\r\n            disabled\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12} lg={4}>\r\n          {node.imageBlob.length !== 0 &&\r\n          <Grid container justify=\"center\">\r\n            <Grid item>\r\n              <Paper className={classes.imageContainer}>\r\n                <img src={node.imageBlob} className={classes.img} alt={node.imageName}/>\r\n              </Paper>\r\n            </Grid>\r\n          </Grid>}\r\n        </Grid>\r\n      </Grid>\r\n        \r\n      {node.children.map((c, i) => <TextPrint key={c.id} {...props} itemNumber={`${itemNumber} - ${i + 1}`} node={c}/>)}\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(TextPrint);","import React, { useRef } from 'react';\r\nimport { Dialog, DialogContent, DialogActions, Button } from '@material-ui/core';\r\nimport { TreeNode } from '../../../../data-types/tree';\r\nimport TextPrint from './text-print-component';\r\nimport ReactToPrint from 'react-to-print';\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  close: () => void;\r\n  node: TreeNode | null;\r\n}\r\n\r\nconst TextPrintDialogComponent: React.FC<Props> = props => {\r\n  const { open, close, node } = props;\r\n  const contentRef = useRef();\r\n\r\n  if (node === null) { return <></>; }\r\n\r\n  return (\r\n    <Dialog open={open} onClose={close} maxWidth=\"xl\">\r\n      <DialogContent ref={contentRef}>\r\n        <TextPrint node={node} itemNumber={node.label}/>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close}>閉じる</Button>\r\n        <ReactToPrint\r\n          trigger={() => <Button color=\"primary\">印刷する</Button>}\r\n          content={() => contentRef.current}\r\n        />\r\n      </DialogActions>\r\n    </Dialog>\r\n\r\n  );\r\n}\r\n\r\n\r\nexport default TextPrintDialogComponent;","import { connect } from 'react-redux';\r\nimport { AppState } from '../../../../redux/store';\r\n\r\nimport TextPrintDialogComponent from './text-print-dialog-component';\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  const { node } = appState.manual;\r\n  return {node: node!};\r\n}\r\n\r\nexport default connect(mapStateToProps)(TextPrintDialogComponent);","import React, {useState, useRef} from 'react';\r\nimport {\r\n  makeStyles, Theme, Tabs, Tab, Typography, Divider, Button, IconButton, Modal, Box, Grid, CircularProgress,\r\n} from '@material-ui/core';\r\nimport ViewSettingsIcon from '@material-ui/icons/Settings';\r\n\r\nimport { Manual, TreeNode } from '../../../data-types/tree';\r\nimport ManualSettings from '../settings/settings';\r\nimport ViewSettingsContainer from '../../../components/view-settings/view-settings-container';\r\nimport User from '../../../data-types/user';\r\nimport { Star, StarBorder, ThumbUp, ThumbUpAltOutlined, ZoomIn, ZoomOut, Print, Info } from '@material-ui/icons';\r\nimport { yellow, blue, grey } from '@material-ui/core/colors';\r\nimport { Action } from 'typescript-fsa';\r\nimport NodeContainer from '../node/node-frame-container';\r\nimport { drawerWidth } from '../../layout/layout-component';\r\nimport TextEditorContainer from '../text/text/text-container';\r\nimport { FavoritePostRequestParams, FavoriteDeleteRequestParams, LikePostRequestParams, LikeDeleteRequestParams } from '../../../api/definitions';\r\nimport KSize from '../../../data-types/k-size';\r\nimport AdapterLink from '../../../components/custom-mui/adapter-link';\r\nimport { Switch, Route, RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport NodePrintContainer from '../node/node-print/node-print-container';\r\nimport TextPrintDialogContainer from '../text/text-print/text-print-dialog-container';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    paddingTop: theme.spacing(1),\r\n  },\r\n  header: {\r\n    display: 'flex',\r\n    paddingTop: theme.spacing(1),\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n  },\r\n  info: {\r\n    color: grey[600],\r\n    '&:hover': { opacity: 0.5 }\r\n  },\r\n  favorite: {\r\n    color: yellow[600],\r\n    '&:hover': { opacity: 0.5 }\r\n  },\r\n  like: {\r\n    color: blue[500],\r\n    '&:hover': { opacity: 0.5 }\r\n  },\r\n  body: {\r\n    width: `calc(100vw - ${drawerWidth}px)`,\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100vw',\r\n    },\r\n  },\r\n  progressContainer: {\r\n    width: ``,\r\n    height: `calc(100vh - ${drawerWidth}px)`,\r\n    position: 'relative',\r\n  },\r\n  progress: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -30,\r\n    marginLeft: -30,\r\n  },\r\n}));\r\n\r\ninterface Props extends RouteComponentProps {\r\n  user: User;\r\n  manual: Manual;\r\n  users: User[];\r\n  selectNode: TreeNode | null;\r\n  ks: KSize;\r\n  replace: (manual: Manual) => Action<Manual>;\r\n  postFavorite: (params: FavoritePostRequestParams) => Action<FavoritePostRequestParams>,\r\n  deleteFavorite: (params: FavoriteDeleteRequestParams) => Action<FavoriteDeleteRequestParams>,\r\n  postLike: (params: LikePostRequestParams) => Action<LikePostRequestParams>,\r\n  deleteLike: (params: LikeDeleteRequestParams) => Action<LikeDeleteRequestParams>,\r\n\r\n  zoomIn: () => Action<void>;\r\n  zoomOut: () => Action<void>;\r\n}\r\n\r\nconst LayoutComponent: React.FC<Props> = props => {\r\n  const { user, manual, users, selectNode, ks, zoomIn, zoomOut } =  props;\r\n  const { location, history } = props;\r\n  \r\n  const tabIndex =\r\n    location.pathname.slice(-'tree/edit'.length) === 'tree/edit' ? 0 :\r\n    location.pathname.slice(-'tree'.length)      === 'tree'      ? 0 :\r\n    location.pathname.slice(-'text/edit'.length) === 'text/edit' ? 1 :\r\n    location.pathname.slice(-'text'.length)      === 'text'      ? 1 : 2;\r\n\r\n  const isEditing = location.pathname.slice(-4) === 'edit';\r\n\r\n  const manualUser = users.find(u => u.id === manual.ownerId)!;\r\n  const [showVS, setShowVS] = useState(false);\r\n  const handleShowVS = () => setShowVS(!showVS);\r\n  const handleCloseVS = () => setShowVS(false);\r\n  const [showPrintNode, setShowPrintNode] = useState(false);\r\n  const handleShowPrintNode = () => setShowPrintNode(!showPrintNode);\r\n  const handleClosePrintNode = () => setShowPrintNode(false);\r\n  const [showPrintText, setShowPrintText] = useState(false);\r\n  const handleShowPrintText = () => setShowPrintText(!showPrintText);\r\n  const handleClosePrintText = () => setShowPrintText(false);\r\n\r\n  const handleChangeTab = (_: any, i: number) => {\r\n    const tabType = i === 0 ? 'tree' : i === 1 ? 'text' : 'settings';\r\n    history.push(`/manual/${manual.id}/${tabType}${isEditing ? '/edit' : ''}`);\r\n  }\r\n\r\n  const isCommiter = manual.ownerId === user.id || manual.collaboratorIds.find(cid => cid === user.id) !== undefined;\r\n  const isFavorite = manual.favoriteIds.find(fid => fid === user.id) !== undefined;\r\n  const isLike = manual.likeIds.find(lid => lid === user.id) !== undefined;\r\n\r\n  function uncheckFavorite() {\r\n    props.deleteFavorite({manualId: manual.id, userId: user.id});    \r\n  }\r\n  function uncheckLike() {\r\n    props.deleteLike({manualId: manual.id, userId: user.id});\r\n  }\r\n  function checkFavorite() {\r\n    props.postFavorite({manualId: manual.id, userId: user.id});\r\n  }\r\n  function checkLike() {\r\n    props.postLike({manualId: manual.id, userId: user.id});\r\n  }\r\n\r\n  const buttonRef = useRef<HTMLDivElement>(null);\r\n\r\n  const classes = useStyles();\r\n  const ShowTree = (\r\n    <div className={classes.body}>\r\n      <Switch>\r\n        <Route path={`/manual/:id/tree`} render={() => <NodeContainer buttonRef={buttonRef}/>}/>\r\n        <Route path={`/manual/:id/text`} render={() => <TextEditorContainer buttonRef={buttonRef}/>}/>\r\n        <Route path={`/manual/:id/settings`}  render={() => <ManualSettings/>}/>\r\n      </Switch>\r\n    </div>\r\n  );\r\n\r\n  const LoadingTree = (\r\n    <div className={classes.progressContainer}>\r\n      <CircularProgress className={classes.progress} size={60}/>\r\n    </div>\r\n  );\r\n\r\n  const to = `/manual/${manual.id}/${tabIndex === 0 ? 'tree' : 'text'}/edit`;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Box mt={1} mx={2}>\r\n        <Grid container justify=\"space-between\" alignItems=\"center\" spacing={2}>\r\n          <Grid item>\r\n            <Box display=\"flex\" flexDirection=\"row\">\r\n              <Typography variant=\"h5\" color=\"textSecondary\">\r\n                {`${manualUser.lastName} ${manualUser.firstName} /`}\r\n              </Typography>\r\n              <Box ml={1}><Typography variant=\"h4\">{manual.title}</Typography></Box>\r\n              <Box ml={1} mt={-0.8}>\r\n                \r\n              </Box>\r\n            </Box>\r\n          </Grid>\r\n          <Grid item>\r\n            <Box display=\"flex\" flexDirection=\"row\">\r\n              <Box ml={2} mr={1}>\r\n                <Info className={classes.info} fontSize=\"large\"/>\r\n              </Box>\r\n              <Box ml={2} mr={1}>\r\n                {isFavorite\r\n                ? <Star className={classes.favorite} fontSize=\"large\" onClick={uncheckFavorite}/>\r\n                : <StarBorder className={classes.favorite} fontSize=\"large\" onClick={checkFavorite}/>}\r\n              </Box>\r\n              <Box ml={2} mr={1}>\r\n                {isLike\r\n                ? <ThumbUp className={classes.like} fontSize=\"large\" onClick={uncheckLike}/>\r\n                : <ThumbUpAltOutlined className={classes.like} fontSize=\"large\" onClick={checkLike}/>}\r\n              </Box>\r\n            </Box>\r\n          </Grid>\r\n        </Grid>\r\n      </Box>\r\n      <div className={classes.header}>\r\n        <Tabs value={tabIndex} onChange={handleChangeTab}>\r\n          <Tab label=\"ツリー表示\"/>\r\n          <Tab label=\"テキスト表示\"/>\r\n          <Tab label=\"設定\" disabled={isEditing}/>\r\n        </Tabs>\r\n        {tabIndex === 0 && !isEditing &&\r\n        <Box ml={1}>\r\n          <IconButton onClick={handleShowPrintNode}><Print/></IconButton>\r\n        </Box>}\r\n        {tabIndex === 1 && !isEditing &&\r\n        <Box ml={1}>\r\n          <IconButton onClick={handleShowPrintText}><Print/></IconButton>\r\n        </Box>}\r\n        <div style={{flexGrow: 1}} />\r\n        {(tabIndex === 0 || tabIndex === 1) && isCommiter && !isEditing &&\r\n        <Box mt={0.7}>\r\n          <Button component={AdapterLink} to={to} color=\"primary\">編集する</Button>\r\n        </Box>}\r\n        <div ref={buttonRef}/>\r\n        {tabIndex === 0 &&\r\n        <Box ml={1}>\r\n          <IconButton onClick={zoomIn} disabled={ks.unit === 30}><ZoomIn/></IconButton>\r\n        </Box>}\r\n        {tabIndex === 0 &&\r\n        <Box ml={1}>\r\n          <IconButton onClick={zoomOut} disabled={ks.unit === 8}><ZoomOut/></IconButton>\r\n        </Box>}\r\n        {tabIndex === 0 &&\r\n        <Box ml={1}>\r\n          <IconButton onClick={handleShowVS}><ViewSettingsIcon/></IconButton>\r\n        </Box>}\r\n      </div>\r\n      <Divider/>\r\n      {selectNode !== null ? ShowTree : LoadingTree}\r\n      \r\n      {selectNode !== null && <NodePrintContainer open={showPrintNode} close={handleClosePrintNode}/>}\r\n      {selectNode !== null && <TextPrintDialogContainer open={showPrintText} close={handleClosePrintText}/>}\r\n      <Modal\r\n        open={showVS}\r\n        onClose={handleCloseVS}\r\n        keepMounted\r\n      >\r\n        <div>\r\n          <ViewSettingsContainer/>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(LayoutComponent);","import React from 'react';\r\nimport { Box, CircularProgress, makeStyles, Theme } from '@material-ui/core';\r\nimport { drawerWidth } from '../pages/layout/layout-component';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  box: {\r\n    height: '50vh',\r\n    width: `calc(100vw - ${drawerWidth}px)`,\r\n    [theme.breakpoints.down('md')]: {\r\n      width: '100vw',\r\n    },\r\n  },\r\n  boxWithoutDrawer: {\r\n    height: '50vh',\r\n    width: '100vw',\r\n  },\r\n}));\r\n\r\ninterface Props {\r\n  hasDrawer: boolean;\r\n}\r\n\r\nconst NowLoading: React.FC<Props> = ({hasDrawer}) => {\r\n  const classes = useStyles();\r\n  return (\r\n    <Box\r\n      display=\"flex\"\r\n      justifyContent=\"center\"\r\n      alignItems=\"flex-end\"\r\n      className={hasDrawer ? classes.box : classes.boxWithoutDrawer}\r\n    >\r\n      <Box>\r\n        <CircularProgress size={60} color=\"primary\" />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\nexport default NowLoading;","import React, { useEffect } from 'react';\r\nimport { Action } from 'typescript-fsa';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../redux/store';\r\nimport { ManualState } from       '../../../redux/states/main/manualsState';\r\n\r\nimport { RouteComponentProps } from 'react-router-dom';\r\nimport {  Manual } from '../../../data-types/tree';\r\n\r\nimport LayoutComponent from './layout-component';\r\nimport { CategoriesState } from '../../../redux/states/main/categoriesState';\r\nimport User from '../../../data-types/user';\r\nimport { manualAction } from '../../../redux/actions/main/manualsAction';\r\n\r\nimport { FavoritePostRequestParams, FavoriteDeleteRequestParams, LikePostRequestParams, LikeDeleteRequestParams } from '../../../api/definitions';\r\nimport { ksActions } from '../../../redux/actions/ksAction';\r\nimport { KSState } from '../../../redux/states/ksState';\r\nimport { UsersState } from '../../../redux/states/main/usersState';\r\nimport NowLoading from '../../../components/now-loading';\r\n\r\nexport interface ViewActions {\r\n  get: (id: string) => Action<string>;\r\n  replace: (manual: Manual) => Action<Manual>;\r\n  postFavorite: (params: FavoritePostRequestParams) => Action<FavoritePostRequestParams>,\r\n  deleteFavorite: (params: FavoriteDeleteRequestParams) => Action<FavoriteDeleteRequestParams>,\r\n  postLike: (params: LikePostRequestParams) => Action<LikePostRequestParams>,\r\n  deleteLike: (params: LikeDeleteRequestParams) => Action<LikeDeleteRequestParams>,\r\n  clear: () => Action<void>;\r\n  editStart: () => Action<void>;\r\n  zoomIn: () => Action<void>;\r\n  zoomOut: () => Action<void>;\r\n}\r\n\r\ninterface Props extends\r\n  ManualState,\r\n  UsersState,\r\n  CategoriesState,\r\n  KSState,\r\n  ViewActions,\r\n  RouteComponentProps<{id: string}> {\r\n    user: User;\r\n  }\r\n\r\nconst ViewContainer: React.FC<Props> = props => {\r\n  const {\r\n    user,\r\n    manual,\r\n    users,\r\n    node,\r\n    ks,\r\n    match,\r\n    get,\r\n    replace,\r\n    postFavorite,\r\n    deleteFavorite,\r\n    postLike,\r\n    deleteLike,\r\n\r\n    zoomIn,\r\n    zoomOut,\r\n  } =  props;\r\n\r\n  // eslint-disable-next-line\r\n  useEffect(() => { get(match.params.id); }, []);\r\n  \r\n  if (manual === null) {\r\n    return <NowLoading hasDrawer/>;\r\n  }\r\n\r\n  const componentProps = {\r\n    user,\r\n    manual,\r\n    users,\r\n    selectNode: node,\r\n    ks,\r\n    replace,\r\n    postFavorite,\r\n    deleteFavorite,\r\n    postLike,\r\n    deleteLike,\r\n    zoomIn,\r\n    zoomOut,\r\n  };\r\n  return <LayoutComponent {...componentProps}/>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {\r\n    user: appState.loginUser.user!,\r\n    ...appState.manual,\r\n    ...appState.users,\r\n    ...appState.categories,\r\n    ...appState.ks\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    get: (id: string) => dispatch(manualAction.get(id)),\r\n    replace: (manual: Manual) => dispatch(manualAction.put(manual)),\r\n    postFavorite: (params: FavoritePostRequestParams) => dispatch(manualAction.checkFavorite(params)),\r\n    deleteFavorite: (params: FavoriteDeleteRequestParams) => dispatch(manualAction.uncheckFavorite(params)),\r\n    postLike: (params: LikePostRequestParams) => dispatch(manualAction.checkLike(params)),\r\n    deleteLike: (params: LikeDeleteRequestParams) => dispatch(manualAction.uncheckLike(params)),\r\n\r\n    zoomIn: () => dispatch(ksActions.zoomIn()),\r\n    zoomOut: () => dispatch(ksActions.zoomOut()),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ViewContainer);","import * as React from 'react';\r\nimport { Route, Switch, Redirect } from 'react-router-dom';\r\nimport links from '../settings/links';\r\nimport Dashboard from './dashboard/dashboard-component';\r\nimport ViewContainer from './manual/layout/layout-container';\r\n\r\ninterface Props {}\r\n\r\nconst PageRouter: React.FC<Props> = () => (\r\n  <Switch>\r\n    <Route exact path={links.dashboard} component={Dashboard}/>\r\n    <Route path={'/manual/:id'} component={ViewContainer}/>\r\n    <Redirect to={links.dashboard}/>\r\n  </Switch>\r\n);\r\n\r\nexport default PageRouter;\r\n","import React, { useState, useCallback, useEffect } from 'react';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { FixedSizeList as List } from 'react-window';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { CategoriesState } from '../../../redux/states/main/categoriesState';\r\nimport { Fab, Box, Dialog, Typography } from '@material-ui/core';\r\nimport { Add } from '@material-ui/icons';\r\nimport CreateManualContainer from '../create-manual/create-manual-container';\r\nimport { ExpansionActions } from './drawer-content-container';\r\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport Category from '../../../data-types/category';\r\nimport links from '../../../settings/links';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  toolbar: theme.mixins.toolbar,\r\n  extendedIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  listContainer: {\r\n    height: `calc(100vh - 138px)`,\r\n  },\r\n  selected: {\r\n    backgroundColor: theme.palette.grey[200],\r\n  },\r\n  notSelected: {\r\n    backgroundColor: theme.palette.background.paper,\r\n  }\r\n}));\r\n\r\ninterface Props extends CategoriesState, ExpansionActions, RouteComponentProps {}\r\n\r\nfunction DrawerContentComponent(props: Props) {\r\n  const { categories, filter, filterReset, filterSet, location, history } = props;\r\n\r\n  const [open, setOpen] = useState(false);\r\n  function handleOpen() {\r\n    setOpen(true);\r\n  }\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  const onClickCategory = (c: Category) => () => {\r\n    if (filter !== null && filter.id === c.id) {\r\n      filterReset();\r\n    } else {\r\n      filterSet(c);\r\n      if (location.pathname !== links.dashboard) {\r\n        history.push(links.dashboard);\r\n      }\r\n    }\r\n  }\r\n\r\n  const [height, setHeight] = useState(300);\r\n  const [listContainerEl, setListContainerEl] = useState<HTMLDivElement | null>(null);\r\n  const getListContainerRef = useCallback((el: HTMLDivElement | null) => {\r\n    if (el) {\r\n      setListContainerEl(el);\r\n      setHeight(el.offsetHeight);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('resize', () => {\r\n      if (listContainerEl !== null) {\r\n        setHeight(listContainerEl.offsetHeight);\r\n      }\r\n    });\r\n  }, [listContainerEl]);\r\n\r\n  const classes = useStyles();\r\n  return (\r\n    <div>\r\n      <div className={classes.toolbar}/>\r\n      <Divider />\r\n      <Box m={2}>\r\n        <Fab variant=\"extended\" size=\"large\" color=\"primary\" onClick={handleOpen}>\r\n          新規作成\r\n          <Add className={classes.extendedIcon} />\r\n        </Fab>\r\n      </Box>\r\n      <div ref={getListContainerRef} className={classes.listContainer}>\r\n        <List\r\n          height={height}\r\n          itemCount={categories.length}\r\n          itemSize={50}\r\n          width={300}\r\n        >\r\n          {({ index, style }) => (\r\n            <div\r\n              className={(filter !== null && filter.id === categories[index].id) ? classes.selected : classes.notSelected}\r\n              style={style}\r\n              onClick={onClickCategory(categories[index])}\r\n            >\r\n              <Box display=\"flex\" alignItems=\"center\" height=\"100%\" pl={2}>\r\n                <Typography>{categories[index].name}</Typography>\r\n              </Box>\r\n            </div>\r\n          )}\r\n        </List>\r\n      </div>\r\n      <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\r\n        <CreateManualContainer onClose={handleClose}/>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(DrawerContentComponent);","import { connect } from 'react-redux';\r\nimport { AppState } from '../../../redux/store';\r\nimport DrawerContentComponent from './drawer-content-component';\r\nimport { Dispatch } from 'redux';\r\nimport { categoriesAction } from '../../../redux/actions/main/categoriesAction';\r\nimport Category from '../../../data-types/category';\r\nimport { Action } from 'typescript-fsa';\r\n\r\nexport interface ExpansionActions {\r\n  filterSet: (category: Category) => Action<Category>;\r\n  filterReset: () => Action<void>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {...appState.categories, ...appState.manual};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    filterSet: (category: Category) => dispatch(categoriesAction.filterSet(category)),\r\n    filterReset: () => dispatch(categoriesAction.filterReset()),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DrawerContentComponent);\r\n","import * as React from 'react';\r\nimport { useState } from 'react';\r\n\r\nimport {\r\n  Theme,  TextField,\r\n  Button, DialogTitle, DialogContent, DialogActions, makeStyles, Box, Tabs, Tab, Collapse, InputAdornment, IconButton,\r\n} from '@material-ui/core';\r\n\r\nimport { ProfileActions } from './profile-container';\r\nimport { LoginUser } from '../../../data-types/user';\r\nimport { Action } from 'typescript-fsa';\r\nimport _ from 'lodash';\r\nimport axios from '../../../api/axios';\r\nimport { Password } from '../../../data-types/password';\r\nimport { passwordURL } from '../../../api/definitions';\r\nimport { MyNotification } from '../../../redux/states/notificationsState';\r\nimport { getKey } from '../../../redux/saga';\r\nimport { VisibilityOff, Visibility } from '@material-ui/icons';\r\nimport Util from '../../../func/util';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {},\r\n  switch: {\r\n    minWidth: 150,\r\n    margin: theme.spacing(1),\r\n    marginBottom: 0,\r\n  }\r\n}));\r\n\r\ninterface Props extends ProfileActions {\r\n  user: LoginUser;\r\n  update: (user: LoginUser) => Action<LoginUser>;\r\n  enqueue: (notification: MyNotification) => Action<MyNotification>;\r\n  onClose: () => void;\r\n}\r\n\r\nconst ProfileComponent: React.FC<Props> = props => {\r\n\r\n  const { user: next, update, enqueue, onClose } = props;\r\n  const [user, setUser] = useState(next);\r\n\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [tabIndex, setTabIndex] = useState(0);\r\n  function handleTabChange(e: React.ChangeEvent<{}>, index: any) { setTabIndex(index) }\r\n  const startEditing = () => setIsEditing(true);\r\n\r\n  const [lastName, setLastName] = useState(user.lastName);\r\n  const handleLastName = (e: any) => setLastName(e.target.value);\r\n  const [firstName, setFirstName] = useState(user.firstName);\r\n  const handleFirstName = (e: any) => setFirstName(e.target.value);\r\n  const [mail, setMail] = useState(user.mail);\r\n  const handleMail = (e: any) => setMail(e.target.value);\r\n\r\n  const handleUpdate = () => {\r\n    const newUser = {...user, lastName, firstName, mail};\r\n    update(newUser);\r\n    setIsEditing(false);\r\n    setTabIndex(0);\r\n  }\r\n\r\n  if (!_.isEqual(user, next)) {\r\n    setUser(next);\r\n    setLastName(next.lastName);\r\n    setFirstName(next.firstName);\r\n    setMail(next.mail);\r\n  }\r\n\r\n  const [beforeFirstPasswordSubmit, setBeforeFirstPasswordSubmit] = useState(true);\r\n\r\n  const [oldPassword, setOldPassword] = useState('');\r\n  const handleOldPassword = (e: any) => setOldPassword(e.target.value);\r\n  const [showOld, setShowOld] = useState(false);\r\n  const handleShowOld = () => setShowOld(!showOld);\r\n  const oldValidMsg = Util.validPassword(oldPassword);\r\n\r\n\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const handleNewPassword = (e: any) => setNewPassword(e.target.value);\r\n  const [showNew, setShowNew] = useState(false);\r\n  const handleShowNew = () => setShowNew(!showNew);\r\n  const newValidMsg = Util.validPassword(newPassword);\r\n\r\n  const [confirmation, setConfirmation] = useState('');\r\n  const handleConfirmation = (e: any) => setConfirmation(e.target.value);\r\n  const [showConfirmation, setShowConfirmation] = useState(false);\r\n  const handleShowConfirmation = () => setShowConfirmation(!showConfirmation);\r\n\r\n  const handlePasswordUpdate = () => {\r\n    setBeforeFirstPasswordSubmit(false);\r\n    if (oldValidMsg !== undefined || newValidMsg !== undefined) { return; }\r\n\r\n    const password: Password = {now: oldPassword, next: newPassword};\r\n    axios\r\n    .put<Password>(`${passwordURL}/${user.id}`, password)\r\n    .then(res => {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'success', message: 'パスワードを更新しました' };\r\n      enqueue(notification);\r\n\r\n      setOldPassword('');\r\n      setNewPassword('');\r\n      setConfirmation('');\r\n      setIsEditing(false);\r\n      setTabIndex(0);\r\n      return res;\r\n    })\r\n    .catch(error => {\r\n      const notification: MyNotification =\r\n        { key: getKey(), variant: 'error', message: 'パスワード更新に失敗しました' };\r\n      enqueue(notification);\r\n      return ({ error });\r\n    })\r\n  }\r\n\r\n  const cancel = () => {\r\n    setLastName(user.lastName);\r\n    setFirstName(user.firstName);\r\n    setMail(user.mail);\r\n    setOldPassword('');\r\n    setNewPassword('');\r\n    setConfirmation('');\r\n\r\n    setIsEditing(false);\r\n    setTabIndex(0);\r\n  }\r\n\r\n  const mailRegex = /^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/;\r\n  const mailValidation = mailRegex.test(mail);\r\n  const renderBase = (\r\n    <div>\r\n      <Box pb={2} display=\"flex\" flexDirection=\"row\">\r\n        <Box flexGrow={1} pr={1}>\r\n          <TextField\r\n            label=\"姓\"\r\n            value={lastName}\r\n            onChange={handleLastName}\r\n            error={lastName === ''}\r\n            helperText={lastName === '' ? \"姓は必須です\" : undefined}\r\n            fullWidth\r\n            disabled={!isEditing}\r\n          />\r\n        </Box>\r\n        <Box flexGrow={1} pl={1}>\r\n          <TextField\r\n            label=\"名\"\r\n            value={firstName}\r\n            onChange={handleFirstName}\r\n            error={firstName === ''}\r\n            helperText={firstName === '' ? '名は必須です' : undefined}\r\n            fullWidth\r\n            disabled={!isEditing}\r\n          />\r\n        </Box>\r\n      </Box>\r\n      <TextField\r\n        label=\"メールアドレス\"\r\n        value={mail}\r\n        onChange={handleMail}\r\n        error={!mailValidation}\r\n        helperText={mail === '' ? \"メールアドレスは必須です\" : !mailValidation ? \"不正なメールアドレスです\" : undefined}\r\n        fullWidth\r\n        disabled={!isEditing}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const renderPassword = (\r\n    <div>\r\n      <Box pb={2}>\r\n        <TextField\r\n          label=\"古いパスワード\"\r\n          type={showOld ? 'text' : 'password'}\r\n          value={oldPassword}\r\n          onChange={handleOldPassword}\r\n          InputProps={{\r\n            endAdornment: (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton onClick={handleShowOld}>\r\n                  {showOld ? <VisibilityOff /> : <Visibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n          error={!beforeFirstPasswordSubmit && oldValidMsg !== undefined}\r\n          helperText={!beforeFirstPasswordSubmit ? oldValidMsg : undefined}\r\n          fullWidth\r\n        />\r\n      </Box>\r\n      <Box pb={2}>\r\n        <TextField\r\n          label=\"新しいパスワード\"\r\n          type={showNew ? 'text' : 'password'}\r\n          value={newPassword}\r\n          onChange={handleNewPassword}\r\n          InputProps={{\r\n            endAdornment: (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton onClick={handleShowNew}>\r\n                  {showNew ? <VisibilityOff /> : <Visibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n          error={!beforeFirstPasswordSubmit && newValidMsg !== undefined}\r\n          helperText={!beforeFirstPasswordSubmit ? newValidMsg : undefined}\r\n          fullWidth\r\n        />\r\n      </Box>\r\n      <TextField\r\n        label=\"新しいパスワードの確認\"\r\n        type={showConfirmation ? 'text' : 'password'}\r\n        value={confirmation}\r\n        onChange={handleConfirmation}\r\n        InputProps={{\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton onClick={handleShowConfirmation}>\r\n                {showConfirmation ? <VisibilityOff /> : <Visibility />}\r\n              </IconButton>\r\n            </InputAdornment>\r\n          ),\r\n        }}\r\n        error={newPassword !== confirmation}\r\n        helperText={newPassword !== confirmation ? \"新しいパスワードと一致していません\" : undefined}\r\n        fullWidth\r\n      />\r\n    </div>\r\n  );\r\n\r\n  const isValid = lastName !== '' && firstName !== '' && mailValidation;\r\n\r\n  const classes = useStyles();\r\n  return (\r\n    <>\r\n      <DialogTitle className={classes.root}>プロフィール</DialogTitle>\r\n      <DialogContent>\r\n\r\n        <Collapse in={isEditing}>\r\n          <Box mt={-2} mb={2}>\r\n            <Tabs value={tabIndex} onChange={handleTabChange}>\r\n              <Tab label=\"基本情報\" />\r\n              <Tab label=\"パスワード\" />\r\n            </Tabs>\r\n          </Box>\r\n        </Collapse>\r\n        <Box height={260}>\r\n          {(!isEditing || tabIndex === 0) && renderBase}\r\n          {tabIndex === 1 && renderPassword}\r\n        </Box>\r\n\r\n      </DialogContent>\r\n      <DialogActions>\r\n        {!isEditing && <Button onClick={onClose}>閉じる</Button>}\r\n        {isEditing && <Button onClick={cancel}>キャンセル</Button>}\r\n        {!isEditing && <Button onClick={startEditing} color=\"primary\">編集</Button>}\r\n        {isEditing && tabIndex === 0 &&\r\n        <Button onClick={handleUpdate} color=\"primary\" disabled={!isValid}>基本情報の更新</Button>}\r\n        {isEditing && tabIndex === 1 &&\r\n        <Button\r\n          color=\"primary\"\r\n          onClick={handlePasswordUpdate}\r\n          disabled={\r\n            newPassword !== confirmation ||\r\n            (!beforeFirstPasswordSubmit && (oldValidMsg !== undefined || newValidMsg !== undefined))\r\n          }\r\n        >\r\n          パスワードの更新\r\n        </Button>}\r\n      </DialogActions>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProfileComponent;","import { Action } from 'typescript-fsa';\r\nimport { Dispatch } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../../../redux/store';\r\nimport ProfileComponent from './profile-component';\r\nimport { LoginUser } from '../../../data-types/user';\r\nimport { loginUserAction } from '../../../redux/actions/main/loginUserAction';\r\nimport { notificationsAction } from '../../../redux/actions/notificationsAction';\r\nimport { MyNotification } from '../../../redux/states/notificationsState';\r\n\r\nexport interface ProfileActions {\r\n  update: (user: LoginUser) => Action<LoginUser>;\r\n  enqueue: (notification: MyNotification) => Action<MyNotification>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {user: appState.loginUser.user!};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    update: (user: LoginUser) => dispatch(loginUserAction.put(user)),\r\n    enqueue: (notification: MyNotification) => dispatch(notificationsAction.enqueue(notification)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileComponent);\r\n","import React from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport PageRouter from '../page-router';\r\nimport { Search, AccountCircle } from '@material-ui/icons';\r\nimport { InputBase, Button, Menu, MenuItem, Dialog } from '@material-ui/core';\r\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport links from '../../settings/links';\r\nimport AdapterLink from '../../components/custom-mui/adapter-link';\r\nimport DrawerContentContainer from './drawer-content/drawer-content-container';\r\nimport { LayoutActions } from './layout-container';\r\nimport User from '../../data-types/user';\r\nimport ProfileContainer from './profile/profile-container';\r\nimport { CategoriesState } from '../../redux/states/main/categoriesState';\r\n\r\nexport const drawerWidth = 300;\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n  },\r\n  drawer: {\r\n    [theme.breakpoints.up('lg')]: {\r\n      width: drawerWidth,\r\n      flexShrink: 0,\r\n    },\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    borderBottom: `1px solid rgb(0,0,0,0.12)`,\r\n  },\r\n  logoContainer: {\r\n    [theme.breakpoints.up('lg')]: {\r\n      width: drawerWidth - theme.spacing(3),\r\n      flexShrink: 0,\r\n    },\r\n  },\r\n  menuButton: {\r\n    marginRight: theme.spacing(2),\r\n    [theme.breakpoints.up('lg')]: {\r\n      display: 'none',\r\n    },\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: theme.palette.background.default,\r\n    marginRight: theme.spacing(1),\r\n    marginLeft: theme.spacing(3),\r\n    width: 'auto',\r\n    [theme.breakpoints.up('lg')]: {\r\n      width: 'auto',\r\n      marginLeft: theme.spacing(24),\r\n    },\r\n  },\r\n  searchIcon: {\r\n    width: theme.spacing(9),\r\n    height: '100%',\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    width: '100%',\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing(0.8),\r\n    paddingRight: theme.spacing(0.8),\r\n    paddingBottom: theme.spacing(0.8),\r\n    paddingLeft: theme.spacing(10),\r\n    transition: theme.transitions.create('width'),\r\n    width: '100%',\r\n    [theme.breakpoints.up('lg')]: {\r\n      width: 240,\r\n    },\r\n  },\r\n  grow: {\r\n    flexGrow: 1,\r\n  },\r\n  accountCircle: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  toolbar: theme.mixins.toolbar,\r\n  drawerPaper: {\r\n    width: drawerWidth,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(0),\r\n  },\r\n}));\r\n\r\ninterface Props extends CategoriesState, LayoutActions, RouteComponentProps {\r\n  user: User;\r\n}\r\n\r\nfunction AppFrameComponent({user, categories, logout, location}: Props) {\r\n\r\n  const classes = useStyles();\r\n\r\n  const [mobileOpen, setMobileOpen] = React.useState(false);\r\n  function handleDrawerToggle() {\r\n    setMobileOpen(!mobileOpen);\r\n  }\r\n\r\n  const [searchText, setSearchText] = React.useState('');\r\n  function handleSearch(e: React.ChangeEvent<HTMLInputElement>) {\r\n    setSearchText(e.target.value);\r\n  }\r\n\r\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\r\n  const isMenuOpen = Boolean(anchorEl);\r\n\r\n  function handleProfileMenuOpen(event: React.MouseEvent<HTMLElement>) {\r\n    setAnchorEl(event.currentTarget);\r\n  }\r\n\r\n  function handleMenuClose() {\r\n    setAnchorEl(null);\r\n  }\r\n\r\n  const [showProfile, setShowProfile] = React.useState(false);\r\n\r\n  function handleShowProfile() {\r\n    setAnchorEl(null);\r\n    setShowProfile(true);\r\n  }\r\n\r\n  function handleHideProfile() {\r\n    setShowProfile(false);\r\n  }\r\n\r\n  function handleLogout() {\r\n    setAnchorEl(null);\r\n    logout();\r\n  }\r\n\r\n  const menuId = 'account-menu';\r\n  const renderMenu = (\r\n    <Menu\r\n      anchorEl={anchorEl}\r\n      anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n      id={menuId}\r\n      keepMounted\r\n      transformOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n      open={isMenuOpen}\r\n      onClose={handleMenuClose}\r\n    >\r\n      <MenuItem onClick={handleShowProfile}>プロフィール</MenuItem>\r\n      <MenuItem onClick={handleLogout}>ログアウト</MenuItem>\r\n    </Menu>\r\n  );\r\n\r\n  const renderProfile = (\r\n    <Dialog open={showProfile} onClose={handleHideProfile} maxWidth=\"sm\" fullWidth>\r\n      <ProfileContainer onClose={handleHideProfile}/>\r\n    </Dialog>\r\n  );\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"fixed\" color=\"inherit\" elevation={0} className={classes.appBar}>\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"Open drawer\"\r\n            edge=\"start\"\r\n            onClick={handleDrawerToggle}\r\n            className={classes.menuButton}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Button component={AdapterLink} to={links.dashboard} size=\"small\">\r\n            <Typography variant=\"h6\" noWrap>Flow Like</Typography>\r\n          </Button>\r\n          \r\n          {false && location.pathname !== links.dashboard &&\r\n          <div className={classes.search}>\r\n            <div className={classes.searchIcon}><Search /></div>\r\n            <InputBase\r\n              placeholder=\"マニュアル検索\"\r\n              value={searchText}\r\n              classes={{\r\n                root: classes.inputRoot,\r\n                input: classes.inputInput,\r\n              }}\r\n              onChange={handleSearch}\r\n            />\r\n          </div>}\r\n          <div className={classes.grow} />\r\n          <Button\r\n            aria-label=\"Account of current user\"\r\n            aria-controls={menuId}\r\n            aria-haspopup=\"true\"\r\n            onClick={handleProfileMenuOpen}\r\n            color=\"inherit\"\r\n          >\r\n            <AccountCircle className={classes.accountCircle}/>\r\n            {`${user.lastName} ${user.firstName}`}\r\n          </Button>\r\n          {renderMenu}\r\n          {renderProfile}\r\n\r\n        </Toolbar>\r\n      </AppBar>\r\n      <nav className={classes.drawer}>\r\n        <Hidden lgUp implementation=\"css\">\r\n          <Drawer\r\n            variant=\"temporary\"\r\n            open={mobileOpen}\r\n            onClose={handleDrawerToggle}\r\n            classes={{ paper: classes.drawerPaper }}\r\n            ModalProps={{ keepMounted: true }}\r\n          >\r\n            <DrawerContentContainer/>\r\n          </Drawer>\r\n        </Hidden>\r\n        <Hidden mdDown implementation=\"css\">\r\n          <Drawer classes={{ paper: classes.drawerPaper }} variant=\"permanent\" open>\r\n            <DrawerContentContainer/>\r\n          </Drawer>\r\n        </Hidden>\r\n      </nav>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        {categories.length !== 0 && <PageRouter/>}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(AppFrameComponent);","import { connect } from 'react-redux';\r\nimport { AppState } from '../../redux/store';\r\nimport AppFrameComponent from './layout-component';\r\nimport { Dispatch } from 'redux';\r\nimport { Action } from 'typescript-fsa';\r\nimport { loginActions } from '../../redux/actions/loginAction';\r\n\r\nexport interface LayoutActions {\r\n  logout: () => Action<void>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {user: appState.loginUser.user!, ...appState.categories};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    logout: () => dispatch(loginActions.logout()),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AppFrameComponent);\r\n","import React, { useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { AppState } from '../redux/store';\r\nimport { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom';\r\nimport links from '../settings/links';\r\nimport LoginContainer from './login/login-container';\r\nimport { LoginUserState } from '../redux/states/main/loginUserState';\r\nimport LayoutContainer from './layout/layout-container';\r\nimport NowLoading from '../components/now-loading';\r\nimport { loginUserAction } from '../redux/actions/main/loginUserAction';\r\nimport { Dispatch } from 'redux';\r\nimport { Action } from 'typescript-fsa';\r\n\r\n\r\ninterface Props extends LoginUserState {\r\n  startSessionCheck: () => Action<void>,\r\n}\r\n\r\nconst LoginRouter: React.FC<Props> = ({ user, sessionChecked, startSessionCheck }) => {\r\n\r\n  useEffect(() => {\r\n    startSessionCheck();\r\n  }, [startSessionCheck]);\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <Switch>\r\n        {user === null && !sessionChecked && <Route render={() => <NowLoading hasDrawer={false} />} />}\r\n        {user === null && <Route exact path={links.login} component={LoginContainer} />}\r\n        {user === null && <Redirect to={links.login} />}\r\n        <Route component={LayoutContainer} />\r\n      </Switch>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return { ...appState.loginUser };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    startSessionCheck: () => dispatch(loginUserAction.startSessionCheck()),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginRouter);\r\n","import React from 'react';\r\nimport { OptionsObject } from 'notistack';\r\nimport { IconButton } from '@material-ui/core';\r\nimport { Close } from '@material-ui/icons';\r\n\r\n\r\nconst closeSnackbarButton: (closeSnackbar: (key: OptionsObject['key']) => void) => (\r\n  key: OptionsObject['key']\r\n) => React.ReactNode = closeSnackbar => key => {\r\n  return (\r\n    <IconButton key={key} color=\"inherit\" onClick={() => closeSnackbar(key)}>\r\n      <Close style={{fontSize: 20}} />\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nexport default closeSnackbarButton;","import React, {useEffect} from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { useSnackbar } from 'notistack';\r\nimport { NotificationsState } from './redux/states/notificationsState';\r\nimport { notificationsAction } from './redux/actions/notificationsAction';\r\nimport { AppState } from './redux/store';\r\nimport { Dispatch } from 'redux';\r\nimport { Action } from 'typescript-fsa';\r\nimport closeSnackbarButton from './components/notistack';\r\n\r\ninterface Props extends NotificationsState {\r\n  display: () => Action<void>;\r\n  dismiss: () => Action<void>;\r\n  remove: (key: number) => Action<number>;\r\n}\r\n\r\nconst Notifier: React.FC<Props> = ({enqueue, display, dequeue, dismiss, remove}) => {\r\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar();\r\n\r\n  useEffect(() => {\r\n    if (enqueue) {\r\n      enqueueSnackbar(enqueue.message, {\r\n        key: enqueue.key,\r\n        variant: enqueue.variant,\r\n        action: closeSnackbarButton(closeSnackbar),\r\n        onExited: () => remove(enqueue.key)\r\n      });\r\n      display()\r\n    }\r\n    if (dequeue) {\r\n      closeSnackbar(dequeue.key);\r\n      dismiss();\r\n    }\r\n    return;\r\n  });\r\n  \r\n  return <></>;\r\n}\r\n\r\nfunction mapStateToProps(appState: AppState) {\r\n  return {...appState.notifications};\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n  return {\r\n    display: () => dispatch(notificationsAction.display()),\r\n    dismiss: () => dispatch(notificationsAction.dismiss()),\r\n    remove: (key: number) => dispatch(notificationsAction.remove(key)),\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Notifier);","import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport Store from './redux/store';\r\nimport { CssBaseline, createMuiTheme } from '@material-ui/core';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\nimport { SnackbarProvider } from 'notistack';\r\n\r\nimport { pink, blue } from '@material-ui/core/colors';\r\nimport LoginRouter from './pages/login-router';\r\nimport Notifier from './notifier';\r\n\r\nexport const toolbarHeight = 42;\r\nexport const theme = createMuiTheme({\r\n  mixins: {\r\n    toolbar: {\r\n        minHeight: toolbarHeight,\r\n    }\r\n  },\r\n  palette: {\r\n    primary: blue,\r\n    secondary: pink,\r\n  },\r\n  typography: {\r\n    // fontSize: 12,\r\n    button: {\r\n        textTransform: \"none\"\r\n    }\r\n  },\r\n  props: {\r\n    MuiCheckbox: {\r\n        color: \"primary\"\r\n    },\r\n    MuiList: {\r\n        dense: true\r\n    },\r\n    MuiRadio: {\r\n        color: \"primary\"\r\n    },\r\n    MuiSwitch: {\r\n        color: \"primary\"\r\n    },\r\n    MuiTextField: {\r\n        variant: \"outlined\"\r\n        // InputProps: {\r\n        //     style: {\r\n        //         height: 38\r\n        //     }\r\n        // }\r\n    }\r\n  },\r\n});\r\n\r\nconst Providers: React.FC<{}> = () => (\r\n  <Provider store={Store}>\r\n    <MuiThemeProvider theme={theme}>\r\n      <CssBaseline/>\r\n      <SnackbarProvider maxSnack={3} anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }} autoHideDuration={4000}>\r\n        <>\r\n          <Notifier/>\r\n          <LoginRouter/>\r\n        </>\r\n      </SnackbarProvider>\r\n    </MuiThemeProvider>\r\n  </Provider>\r\n);\r\n\r\nReactDOM.render(<Providers/>, document.querySelector('#root'));","import * as React from 'react';\r\n\r\nimport { Group, Path } from 'react-konva';\r\nimport { SvgPath } from '../../data-types/svg-path';\r\n\r\nexport interface SvgToPathProps {\r\n  svg: SvgPath[];\r\n  x: number;\r\n  y: number;\r\n  fill: string;\r\n  scale?: {x: number, y: number};\r\n  rotation?: number;\r\n  onMouseEnter?: (e:any) => void;\r\n  onMouseLeave?: (e:any) => void;\r\n}\r\n\r\nconst SvgToPath: React.FC<SvgToPathProps> = (props: SvgToPathProps) => {\r\n  const {svg, x, y, fill, scale, rotation, onMouseEnter, onMouseLeave} = props;\r\n  const basePathProps = {x: 0, y: 0};\r\n\r\n  return (\r\n    <Group x={x} y={y}>\r\n      {svg.map(s => (\r\n        <Path\r\n          key={`svg-to-path-${s.d}`}\r\n          {...basePathProps}\r\n          data={s.d}\r\n          fill={s.fill ? fill : '#0000'}\r\n          scale={{x: scale ? scale.x : 1, y: scale ? scale.y : 1}}\r\n          rotation={rotation || 0}\r\n          onMouseEnter={onMouseEnter}\r\n          onMouseLeave={onMouseLeave}\r\n        />\r\n      ))}\r\n    </Group>\r\n  );\r\n};\r\n\r\nexport default SvgToPath;","import * as React from 'react';\r\n\r\nimport { Group, Rect } from 'react-konva';\r\nimport { SvgPath } from '../../data-types/svg-path';\r\nimport SvgToPath from './svg-to-path';\r\nimport KSize from '../../data-types/k-size';\r\n\r\nexport interface IconProps {\r\n  ks: KSize;\r\n  x: number;\r\n  y: number;\r\n  svg: SvgPath[];\r\n  color?: string;\r\n  backgroundColor?: string;\r\n  rotate?: number;\r\n  scale?: {x: number, y: number};\r\n  onClick?: (e: any) => void;\r\n  onMouseEnter?: (e:any) => void;\r\n  onMouseLeave?: (e:any) => void;\r\n}\r\n\r\nconst Icon: React.FC<IconProps> = (props: IconProps) => {\r\n  const {ks, x, y, svg, color, backgroundColor, rotate, scale, onClick, onMouseEnter, onMouseLeave} = props;\r\n  const baseRectProps = {\r\n    x: (ks.rect.h - ks.icon * 2) / 2 * ks.unit,\r\n    y: (ks.rect.h - ks.icon * 2) / 2 * ks.unit,\r\n    width: ks.icon * 2 * ks.unit,\r\n    height: ks.icon * 2 * ks.unit,\r\n    fill: backgroundColor,\r\n    opacity: 0.2,\r\n    cornerRadius: ks.rect.h / 2 * ks.unit,\r\n    onMouseEnter,\r\n    onMouseLeave,\r\n  };\r\n  const transRate = ks.unit / 24;\r\n  const svgProps = {\r\n    x: (ks.rect.h - ks.icon) / 2 * ks.unit,\r\n    y: scale === undefined\r\n      ? (ks.rect.h - ks.icon) / 2 * ks.unit\r\n      : (ks.rect.h - ks.icon * scale.y) / 2 * ks.unit,\r\n    svg,\r\n    fill: color || 'black',\r\n    rotate: rotate || 0,\r\n    scale: scale\r\n      ? {x: scale.x * transRate, y: scale.y * transRate}\r\n      : {x: transRate, y: transRate},\r\n    onMouseEnter,\r\n    onMouseLeave,\r\n  };\r\n\r\n  return (\r\n    <Group x={x} y={y} onClick={onClick}>\r\n      <Rect {...baseRectProps}/>\r\n      <SvgToPath {...svgProps}/>\r\n    </Group>\r\n  );\r\n};\r\n\r\nexport default Icon;","import { SvgPath } from \"../../../data-types/svg-path\";\r\n\r\nexport const checkBlank: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z', fill: true}\r\n];\r\nexport default checkBlank;","import { SvgPath } from \"../../../data-types/svg-path\";\r\n\r\nexport const flag: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z', fill: true}\r\n];\r\nexport default flag;","import { SvgPath } from \"../../data-types/svg-path\";\r\n\r\nexport const switchSvg: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M14 4l2.29 2.29-2.88 2.88 1.42 1.42 2.88-2.88L20 10V4zm-4 0H4v6l2.29-2.29 4.71 4.7V20h2v-8.41l-5.29-5.3z', fill: true}\r\n];\r\nexport default switchSvg;","import { SvgPath } from \"../../data-types/svg-path\";\r\n\r\nexport const task: SvgPath[] = [\r\n  {d: 'M0 0h24v24H0z', fill: false},\r\n  {d: 'M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z', fill: true}\r\n];\r\nexport default task;","import {KTreeNode, DragRow, Point, DropRow } from \"../data-types/tree\";\r\nimport KSize from \"../data-types/k-size\";\r\n\r\nexport default class KTreeUtil {\r\n\r\n  static calcSelfLength = (node: KTreeNode, ks: KSize, which: which) => {\r\n    if (node.open) {\r\n      if (which === 'width') {\r\n        // open, width\r\n        const childrenLength = node.children.length !== 0\r\n          ? node.children.map(c => c.self.w).reduce((a, b) => Math.max(a, b))\r\n          : ks.rect.w;\r\n        return ks.indent * 1.5 + childrenLength;\r\n      } else {\r\n        // open, height\r\n        return ks.rect.h + ks.margin.h\r\n          + (node.children.length !== 0 ?\r\n              node.children.map(c => c.self.h + ks.margin.h).reduce((a, b) => a + b) : 0);\r\n      }\r\n    } else {\r\n      if (which === 'width') {\r\n        // close, width\r\n        return ks.rect.w;\r\n      } else {\r\n        // close, height\r\n        return ks.rect.h;\r\n      }\r\n    }\r\n  }\r\n\r\n  static _setSize = <T extends KTreeNode>(node: T, ks: KSize, showDraft: boolean): T => {\r\n\r\n    const rect = {\r\n      w: ks.rect.w,\r\n      h: ks.rect.h\r\n    };\r\n\r\n    const children = node.children.length !== 0\r\n      ? node.children\r\n        .filter(c => showDraft || !c.isDraft)\r\n        .map(c => KTreeUtil._setSize(c, ks, showDraft))\r\n      : [];\r\n    const newNode = {...node, children};\r\n\r\n    const self = {\r\n      w: KTreeUtil.calcSelfLength(newNode, ks, 'width'),\r\n      h: KTreeUtil.calcSelfLength(newNode, ks, 'height')\r\n    };\r\n\r\n    return {...node, children, self, rect};\r\n  }\r\n\r\n  static _setPoint = <T extends KTreeNode>(node: T, ks: KSize, showDraft: boolean, point: Point = {x: ks.spr.w, y: ks.spr.h}): T => {\r\n\r\n    var anchor = 0;\r\n    const children = node.children\r\n    .filter(c => showDraft || !c.isDraft)\r\n    .map(c => {\r\n      const p: Point = {\r\n        x: point.x + ks.indent,\r\n        y: point.y + node.rect.h + ks.margin.h + anchor\r\n      };\r\n      const child = KTreeUtil._setPoint(c, ks, showDraft, p);\r\n      anchor += c.self.h + ks.margin.h;\r\n      return child;\r\n    });\r\n\r\n    return {...node, point, children};\r\n  }\r\n\r\n  static _setIndexAndDepth = <T extends KTreeNode>(index: number, top: number, node: T): T => {\r\n\r\n    if (!node.open || node.children.length === 0) {\r\n      const depth = {top, bottom: 0};\r\n      return {...node, index, depth};\r\n    }\r\n\r\n    const children = node.children.map((c, i) => (KTreeUtil._setIndexAndDepth(i, top + 1, c)));\r\n    const bottom = children.map(c => c.depth.bottom).reduce((a, b) => a > b ? a : b) + 1;\r\n    const depth = {top, bottom};\r\n\r\n    return {...node, children, index, depth};\r\n  }\r\n\r\n  static setCalcProps = <T extends KTreeNode>(node: T, ks: KSize, showDraft: boolean): T => {\r\n    var kNode = KTreeUtil._setSize(node, ks, showDraft);\r\n    kNode = KTreeUtil._setPoint(kNode, ks, showDraft);\r\n    kNode = KTreeUtil._setIndexAndDepth(0, 0, kNode);\r\n    return kNode;\r\n  }\r\n\r\n  static makeBaseDragMap = <T extends KTreeNode>(node: T): DragRow[] => {\r\n    const base: DragRow[]= [];\r\n    for(var y = 0; y < node.point.y + node.self.h; y++) { base[y] = undefined; }\r\n    return base;\r\n  }\r\n\r\n  static makeDragMap = <T extends KTreeNode>(nodes: T[], ks: KSize): DragRow[] => {\r\n    const root = nodes[0];\r\n    const sorted = nodes.sort((a, b) => a.depth.bottom < b.depth.bottom ? 1 : -1);\r\n\r\n    const selfBase = KTreeUtil.makeBaseDragMap(root);\r\n\r\n    const map: DragRow[][] = [selfBase].concat(sorted.map(s => {\r\n      const result = KTreeUtil.makeBaseDragMap(s);\r\n\r\n      if (s.open && s.depth.top !== 0) {\r\n        (() => {\r\n          for(var y = s.point.y + s.self.h - ks.margin.h; y < s.point.y + s.self.h; y++) {\r\n            result[y] = { node: s, action: 'moveInOut' };\r\n          }\r\n        })();\r\n      }\r\n      \r\n      if (s.depth.top !== 0) {\r\n        (() => {\r\n          for(var y = s.point.y; y < s.point.y + s.rect.h; y++) {\r\n            result[y] = { node: s, action: 'moveToBrother' };\r\n          }\r\n        })();\r\n      }\r\n      \r\n      return result;\r\n    }));\r\n\r\n    return map.reduce((before, next) => before.map((beforeRow, r) => {\r\n      if (next.length - 1 < r) { return beforeRow; }\r\n      const nextRow = next[r];\r\n      return nextRow || beforeRow;\r\n    }))\r\n  }\r\n\r\n  static makeBaseDropMap = <T extends KTreeNode>(node: T): DropRow[] => {\r\n    const base: DropRow[]= [];\r\n    for(var y = 0; y < node.point.y + node.self.h; y++) { base[y] = undefined; }\r\n    return base;\r\n  }\r\n\r\n  static makeDropMap = <T extends KTreeNode>(nodes: T[], ks: KSize): DropRow[] => {\r\n    const root = nodes[0];\r\n    const sorted = nodes.sort((a, b) => a.depth.bottom < b.depth.bottom ? 1 : -1);\r\n\r\n    const selfBase = KTreeUtil.makeBaseDropMap(root);\r\n\r\n    const beforeMarginHalf = Math.floor(ks.margin.h / 2);\r\n    const beforeRectHalf = Math.floor(ks.rect.h / 2);\r\n\r\n    const map: DropRow[][] = [selfBase].concat(sorted.map(s => {\r\n      const result = KTreeUtil.makeBaseDropMap(s);\r\n\r\n      if (s.depth.top !== 0) {\r\n        (() => {\r\n          for(var y = s.point.y - ks.margin.h; y < s.point.y + beforeRectHalf; y++) {\r\n            result[y] = { node: s, action: 'insertBefore' };\r\n          }\r\n        })();\r\n        (() => {\r\n          for(var y = s.point.y + beforeRectHalf; y < s.point.y + ks.rect.h + beforeMarginHalf; y++) {\r\n            result[y] = { node: s, action: 'insertNext' };\r\n          }\r\n        })();\r\n      }\r\n\r\n      if (s.open) {\r\n        for(var y = s.point.y + s.self.h - ks.margin.h; y < s.point.y + s.self.h; y++) {\r\n          result[y] = { node: s, action: 'insertLast' };\r\n        }\r\n      }\r\n      \r\n      return result;\r\n    }));\r\n\r\n    return map.reduce((before, next) => before.map((beforeRow, r) => {\r\n      if (next.length - 1 < r) { return beforeRow; }\r\n      const nextRow = next[r];\r\n      return nextRow || beforeRow;\r\n    }))\r\n  }\r\n  \r\n  static isEqualRow = (a: DragRow | DropRow, b: DragRow | DropRow): boolean => {\r\n    if (a === undefined && b === undefined) { return true; }\r\n    if (a === undefined || b === undefined) { return false; }\r\n    return a.action === b.action && a.node.id === b.node.id;\r\n  }\r\n}\r\n\r\nexport type which = 'width' | 'height';","import User from \"./user\";\r\nimport Category from \"./category\";\r\n\r\nexport enum Type { task, switch, case }\r\n\r\nexport const isTask = (type: Type) => type === Type.task; \r\nexport const isSwitch = (type: Type) => type === Type.switch; \r\nexport const isCase = (type: Type) => type === Type.case; \r\n\r\n\r\nexport interface Tree {\r\n  id: string;\r\n  type: Type;\r\n  label: string;\r\n  isDraft: boolean;\r\n  input: string;\r\n  output: string;\r\n  preConditions: string;\r\n  postConditions: string;\r\n  workerInCharge: string;\r\n  remarks: string;\r\n  necessaryTools: string;\r\n  exceptions: string;\r\n  imageName: string;\r\n  imageBlob: string;\r\n  children: Tree[];\r\n}\r\n\r\nexport const baseTree: Tree = {\r\n  id: '',\r\n  type: Type.task,\r\n  label: '',\r\n  isDraft: false,\r\n  input: '',\r\n  output: '',\r\n  preConditions: '',\r\n  postConditions: '',\r\n  workerInCharge: '',\r\n  remarks: '',\r\n  necessaryTools: '',\r\n  exceptions: '',\r\n  imageName: '',\r\n  imageBlob: '',\r\n  children: [],\r\n};\r\n\r\nexport interface Manual {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  ownerId: string;\r\n  collaboratorIds: string[];\r\n  categoryId: string;\r\n  isPublic: boolean;\r\n  viewerIdsOfUser: string[];\r\n  viewerIdsOfGroup: string[];\r\n  visible: boolean;\r\n  favoriteIds: string[];\r\n  likeIds: string[];\r\n  rootTree: Tree | null;\r\n  createAt: string;\r\n  updateAt: string;\r\n}\r\n\r\nexport const baseManual: Manual = {\r\n  id: '',\r\n  title: '',\r\n  description: '',\r\n  ownerId: '',\r\n  collaboratorIds: [],\r\n  categoryId: '',\r\n  isPublic: true,\r\n  viewerIdsOfUser: [],\r\n  viewerIdsOfGroup: [],\r\n  visible: true,\r\n  favoriteIds: [],\r\n  likeIds: [],\r\n  rootTree: null,\r\n  createAt: '',\r\n  updateAt: '',\r\n};\r\n\r\nexport interface ManualWithObject extends Manual {\r\n  owner: User;\r\n  collaborators: User[];\r\n  category: Category;\r\n  viewers: User[];\r\n  favorites: User[];\r\n  likes: User[];\r\n}\r\n\r\nexport interface TreeNode extends Tree {\r\n  children: TreeNode[];\r\n  open: boolean;\r\n  focus: boolean;\r\n  isDragging: boolean;\r\n}\r\n\r\nexport const baseTreeNode: TreeNode = {\r\n  ...baseTree,\r\n  children: [],\r\n  open: false,\r\n  focus: false,\r\n  isDragging: false,\r\n};\r\n\r\nexport interface NodeWithSimilarity extends Tree {\r\n  _label: number;\r\n  _input: number;\r\n  _output: number;\r\n  _childrenLength: number;\r\n}\r\n\r\nexport type Parent = {id: string, label: string};\r\n\r\nexport interface Memo extends Tree {\r\n  point: Point;\r\n  children: Tree[];\r\n}\r\n\r\nexport interface KTreeNode extends TreeNode {\r\n  children: KTreeNode[];\r\n  \r\n  index: number;\r\n  depth: {top: number, bottom: number};\r\n\r\n  point: Point;\r\n\r\n  self: Size;\r\n  rect: Size;\r\n}\r\n\r\nexport const baseKTreeNode: KTreeNode = {\r\n  ...baseTreeNode,\r\n  children: [],\r\n  index: 0,\r\n  depth: {top: 0, bottom: 0},\r\n  point: {x: 0, y: 0},\r\n  self: {w: 0, h: 0},\r\n  rect: {w: 0, h: 0},\r\n};\r\n\r\nexport interface KWithArrow extends KTreeNode {\r\n  children: KWithArrow[];\r\n  arrows: Point[][];\r\n}\r\n\r\nexport const baseKWithArrow: KWithArrow = {\r\n  ...baseKTreeNode,\r\n  children: [],\r\n  arrows: [],\r\n};\r\n\r\nexport interface CheckNode extends TreeNode {\r\n  parentType: Type;\r\n  children: CheckNode[];\r\n\r\n  open: boolean;\r\n  focus: boolean;\r\n  checked: boolean;\r\n  skipped: boolean;\r\n  \r\n  index: number;\r\n  depth: {top: number, bottom: number};\r\n\r\n  point: Point;\r\n\r\n  self: Size;\r\n  rect: Size;\r\n}\r\n\r\nexport interface CheckRecord {\r\n  at: number;\r\n  from: number;\r\n  time: number;\r\n  node: CheckNode;\r\n}\r\n\r\n// export const dummyId = '--';\r\nexport type Point = {x: number, y: number};\r\nexport type Size = {w: number, h:number};\r\nexport type DragAction = 'moveToBrother' | 'moveInOut';\r\nexport type DropAction = 'insertBefore' | 'insertNext' | 'insertLast';\r\nexport type DragRow = {node: KTreeNode, action: DragAction} | undefined;\r\nexport type DropRow = {node: KTreeNode, action: DropAction} | undefined;\r\n"],"sourceRoot":""}